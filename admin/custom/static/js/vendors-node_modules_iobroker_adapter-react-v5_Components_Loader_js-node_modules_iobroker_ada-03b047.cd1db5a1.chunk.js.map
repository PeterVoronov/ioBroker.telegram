{"version":3,"sources":["../node_modules/@iobroker/adapter-react-v5/Components/Loader.js","../node_modules/@iobroker/adapter-react-v5/Components/Router.js","../node_modules/@iobroker/adapter-react-v5/Components/SaveCloseButtons.js","../node_modules/@iobroker/adapter-react-v5/Components/Utils.js","../node_modules/@iobroker/adapter-react-v5/Components/copy-to-clipboard.js","../node_modules/@iobroker/adapter-react-v5/Dialogs/Confirm.js","../node_modules/@iobroker/adapter-react-v5/Dialogs/Error.js","../node_modules/@iobroker/adapter-react-v5/Prompt.js","../node_modules/@iobroker/adapter-react-v5/Theme.js","../node_modules/@iobroker/adapter-react-v5/i18n.js","../node_modules/@mui/icons-material/Check.js","../node_modules/@mui/icons-material/Close.js","../node_modules/@mui/icons-material/Save.js","../node_modules/@mui/icons-material/utils/createSvgIcon.js","../node_modules/@babel/runtime/helpers/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/assertThisInitialized.js","../node_modules/@babel/runtime/helpers/classCallCheck.js","../node_modules/@babel/runtime/helpers/createClass.js","../node_modules/@babel/runtime/helpers/defineProperty.js","../node_modules/@babel/runtime/helpers/get.js","../node_modules/@babel/runtime/helpers/getPrototypeOf.js","../node_modules/@babel/runtime/helpers/inherits.js","../node_modules/@babel/runtime/helpers/interopRequireDefault.js","../node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/nonIterableRest.js","../node_modules/@babel/runtime/helpers/possibleConstructorReturn.js","../node_modules/@babel/runtime/helpers/setPrototypeOf.js","../node_modules/@babel/runtime/helpers/slicedToArray.js","../node_modules/@babel/runtime/helpers/superPropBase.js","../node_modules/@babel/runtime/helpers/typeof.js","../node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","../node_modules/@mui/icons-material/node_modules/@babel/runtime/helpers/interopRequireDefault.js","../node_modules/@iobroker/socket-client/src/AdminConnection.ts","../node_modules/@iobroker/socket-client/src/Connection.ts","../node_modules/@iobroker/socket-client/dist/esm/ConnectionProps.js","../node_modules/@iobroker/socket-client/src/DeferredPromise.ts","../node_modules/@iobroker/socket-client/src/index.ts","../node_modules/@iobroker/socket-client/src/tools.ts"],"names":["loaderStyles","Loader","props","window","document","getElementById","style","createElement","setAttribute","innerHTML","head","appendChild","size","theme","themeType","backgroundImage","loadingBackgroundImage","undefined","backgroundColor","loadingBackgroundColor","backgroundSize","loadingHideLogo","width","height","left","borderWidth","top","bottom","React","Component","propTypes","PropTypes","number","string","_export","Router","onHashChangedBound","onHashChanged","bind","addEventListener","removeEventListener","hash","location","replace","parts","split","map","item","decodeURIComponent","e","console","error","tab","dialog","id","arg","getLocation","styles","buttonIcon","marginRight","SaveCloseButtons","newReact","isIFrame","self","noTextOnButtons","buttonStyle","borderRadius","saveToolbar","button","paddingLeft","right","position","background","dense","minHeight","border","changed","onSave","classes","I18n","t","Object","assign","marginLeft","flexGrow","onClose","bool","object","isRequired","func","withStyles","NAMESPACE","days","months","QUALITY_BITS","SIGNATURES","JVBERi0","R0lGODdh","R0lGODlh","iVBORw0KGgo","PHN2Zw","Qk1","AAABAA","Utils","name","filter","word","toUpperCase","substring","toLowerCase","join","seconds","Math","floor","hours","minutes","text","objects","settings","options","isDesc","attr","language","common","sysLang","en","desc","de","ru","toString","pos","lastIndexOf","CapitalWords","trim","obj","noTrim","_id","forEnumId","hasOwnProperty","custom","user","subOrder","JSON","parse","stringify","order","subURLs","URLs","list","source","dest","result","Array","from","splice","removed","defaultEnabling","enabled","useCustom","icon","color","s","useCommon","length","startsWith","prefix","pathname","match","defaultValue","indexOf","slice","r","g","b","rgb","parseInt","parseFloat","isNaN","secs","angle","num","format","dateFormat","now","m","a","year","find","y","day","Date","abs","getTime","date","getDay","getDate","getMonth","key","start","index","push","href","target","rel","title","states","instanceId","noCommon","smartName","newSmartName","byON","smartType","getLanguage","nnn","_smartName","role","empty","nl","pl","it","fr","pt","es","stopPropagation","preventDefault","copy","fileName","bytes","units","u","toFixed","invert","invertedColor","invertColor","hex","bw","padStart","alfa","warn","pow","x","z","color1","color2","lab1","rgb2lab","color2rgb","lab2","dltL","dltA","dltB","c1","sqrt","c2","dltC","dltH","sc","sh","dltLKlsl","dltCkcsc","dltHkhsh","i","mix","str","isArray","k","_toVal","tmp","arguments","themeName","vendorPrefix","_localStorage","localStorage","getItem","matchMedia","matches","setItem","themes","getThemeNames","newTheme","setThemeName","query","forEach","part","f","p","pop","dateObj","mm","dd","getFullYear","v","getHours","getMinutes","getSeconds","getMilliseconds","round","d","h","url","open","extractHeader","body","header","lines","attrs","_header","line","doc","filename","json","el","encodeURIComponent","display","click","removeChild","quality","ex","type","value","fetch","then","response","blob","Promise","resolve","reader","FileReader","onload","readAsDataURL","base64","signature","keys","deselectCurrent","selection","getSelection","rangeCount","active","activeElement","ranges","getRangeAt","tagName","blur","removeAllRanges","range","addRange","focus","clipboardToIE11Formatting","defaultMessage","message","copyKey","test","navigator","userAgent","debug","reselectPrevious","mark","success","createRange","textContent","ariaHidden","all","clip","whiteSpace","webkitUserSelect","MozUserSelect","msUserSelect","userSelect","clipboardData","clearData","setData","onCopy","selectNodeContents","successful","execCommand","Error","err","prompt","removeRange","module","exports","suppress","fontSize","suppressRoot","marginTop","DialogConfirm","dialogName","suppressQuestionMinutes","removeItem","state","setTimeout","fullWidth","event","reason","handleCancel","label","root","setState","suppressText","handleOk","ok","cancel","titleBackground","titleColor","DialogError","oneOfType","element","printPrompt","log","step","toInt","substr","toHex","int","getElevation","overlayColor","elevation","overlay","getElevations","elevations","buttonsPalette","palette","grey","main","dark","buttonsTheme","components","MuiButton","variants","variant","getContrastText","primary","borderColor","mode","action","disabledBackground","alpha","hoverOpacity","Theme","paper","secondary","expert","overrides","MuiAppBar","colorDefault","MuiLink","textTransform","transition","orange","MuiPaper","disabled","toolbar","createTheme","adaptV4Theme","lang","words","_words","translations","translation","w","unknownTranslations","includes","_disableWarning","wordEn","args","disable","i18nShow","i18nDisableWarning","disableWarning","_interopRequireDefault","_createSvgIcon","_jsxRuntime","_default","_utils","_arrayLikeToArray","arr","len","arr2","_arrayWithHoles","_assertThisInitialized","_classCallCheck","instance","Constructor","_defineProperties","descriptor","_createClass","protoProps","staticProps","_defineProperty","superPropBase","_get","property","receiver","base","_getPrototypeOf","o","setPrototypeOf","_inherits","subClass","superClass","_iterableToArrayLimit","_i","_arr","_n","_d","_s","_e","_nonIterableRest","_typeof","assertThisInitialized","_possibleConstructorReturn","call","_setPrototypeOf","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","_slicedToArray","getPrototypeOf","_superPropBase","arrayLikeToArray","_unsupportedIterableToArray","minLen","n","parseCertificate","cert","parseIPAddresses","host","IPs4","IPs6","eth","iface","ip","AdminConnection","update","linesNumber","reject","files","adapter","folderName","newId","newName","groups","subGroups","group","oldGroupId","newGroupId","parentGroup","timeoutMs","timeout","data","cmdTimeout","cmd","cmdId","config","typeOfDiag","password","ipOrHostName","plaintext","ciphertext","path","processed","category","notifications","isStrict","ratings","controller","res","namespace","instances","adapters","systemConfig","systemRepositories","PROGRESS","ERRORS","PERMISSION_ERROR","NOT_CONNECTED","ADAPTERS","Connection","port","protocol","parsed","noTimeout","info","major","minor","patch","isOk","isSecure","cb","_err","exitCode","acl","maxAttempts","binary","sub","oldObj","filePattern","cacheKey","forceUpdate","commandTimeout","onTimeout","requireAdmin","requireFeatures","executor","feature","promise","timeoutControl","isAll","pattern","val","ack","disableProgressUpdate","isEnable","isEnabled","maintenance","command","handler","_enum","_res","end","design","objs","adapterName","byte","values","stepIgnore","sessionId","version","serverName","exists","_isSecure","features","startKey","endKey","instanceObjects","adapterObjects","level","createDeferredPromise","rej","getObjectViewResultToArray","normalizeHostId","objectIdToHostname","wait","ms","pattern2RegEx","startsWithWildcard","endsWithWildcard"],"mappings":"ohCAMA,aACA,cAAmC,iD,EAAA,6B,EAAA,sG,EAAA,sQAEnC,IAAMA,EAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAyOfC,EAAM,a,EAAA,2BACR,WAAYC,EAAO,OAGf,I,EAHe,mBACf,cAAMA,CAAK,EAEP,CAACC,OAAOC,SAASC,eAAe,2BAA2B,EAAG,CAC9D,IAAMC,EAAQH,OAAOC,SAASG,cAAc,OAAO,EACnDD,EAAME,aAAa,KAAM,2BAA2B,EACpDF,EAAMG,UAAYT,EAClBG,OAAOC,SAASM,KAAKC,YAAYL,CAAK,CAC1C,CAAC,QACL,CAAC,O,EAAA,kCAED,UAAS,CACL,IAAMM,EAAO,KAAKV,MAAMU,MAAQ,IAC1BC,EAAQ,KAAKX,MAAMY,WAAa,KAAKZ,MAAMW,OAAS,QAC1D,OAAO,+BAAK,UAAW,6BAA+BA,EAClD,MAAO,CACHE,gBAAiBZ,OAAOa,wBAA0Bb,OAAOa,yBAA2B,2BAA6B,OAASb,OAAOa,uBAAyB,IAAMC,OAChKC,gBAAiBf,OAAOgB,wBAA0BhB,OAAOgB,yBAA2B,2BAA6BhB,OAAOgB,uBAAyBF,OACjJG,eAAgB,OACpB,CAAE,EAEDjB,OAAOkB,kBAAoB,OACxB,KAEA,gDACI,+BAAK,UAAU,WAAW,MAAO,CAAEC,MAAOV,EAAMW,OAAQX,CAAK,CAAE,EAC3D,+BAAK,UAAW,4BAA8BC,EAAO,MAAO,CAAEW,KAAM,KAAM,CAAE,GAC5E,+BAAK,UAAW,4BAA8BX,EAAO,MAAO,CAAEW,KAAM,KAAM,CAAE,GAC5E,+BACI,UAAS,sCAAiCX,EAAK,sBAC/C,MAAO,CAAEY,YAAab,EAAO,IAAM,CAAE,GAEzC,+BAAK,UAAW,oCAAsCC,CAAM,GAC5D,+BAAK,UAAW,wCAA0CA,EAAO,MAAO,CAAEa,IAAK,KAAM,CAAE,GACvF,+BAAK,UAAW,wCAA0Cb,EAAO,MAAO,CAAEc,OAAQ,KAAM,CAAE,EAAE,EAEhG,+BAAK,UAAW,uCAAyCd,EACzD,MAAO,CAAES,MAAOV,EAAO,GAAIW,OAAQX,EAAO,EAAG,CAAE,EAC7C,CACH,CAGf,CAAC,OA3CgBgB,UAAMC,SAAS,EA8CpC5B,EAAO6B,UAAY,CACflB,KAAMmB,UAAUC,OAChBlB,UAAWiB,UAAUE,MACzB,EAGA,IAAMC,EAAUjC,EAAO,EACRiC,EAAO,W,8MCtStB,aAA0B,iD,EAAA,6B,EAAA,sG,EAAA,sQAE1B,IAKMC,EAAM,a,EAAA,2BAIR,WAAYjC,EAAO,c,EAAA,mBACf,cAAMA,CAAK,EACX,EAAKkC,mBAAqB,EAAKC,cAAcC,M,EAAI,eAAO,CAC5D,CAAC,O,EAAA,6CAED,UAAoB,CAChBnC,OAAOoC,iBAAiB,aAAc,KAAKH,kBAAkB,CACjE,CAAC,oCAED,UAAuB,CACnBjC,OAAOqC,oBAAoB,aAAc,KAAKJ,kBAAkB,CACpE,CAAC,6BAED,UAAgB,CACZ,CAGJ,6BAIA,UAAqB,CACjB,IAAIK,EAAOtC,OAAOuC,SAASD,KAC3BA,EAAOA,EAAKE,QAAQ,KAAM,EAAE,EAC5B,IAAMC,EAAQH,EAAKI,MAAM,GAAG,EAAEC,IAAI,SAAAC,EAAQ,CACtC,GAAI,CACA,OAAOA,EAAOC,mBAAmBD,CAAI,EAAI,EAC7C,OAASE,EAAP,CACEC,eAAQC,MAAM,yBAA2BJ,CAAI,EACtCA,GAAQ,EACnB,CACJ,CAAC,EAED,MAAO,CACHK,IAAQR,EAAM,IAAM,GACpBS,OAAQT,EAAM,IAAM,GACpBU,GAAQV,EAAM,IAAM,GACpBW,IAAQX,EAAM,IAAM,EACxB,CACJ,CAEA,0BAOA,SAAkBQ,EAAKC,EAAQC,EAAIC,EAAK,CACpC,IAAId,EAAO,GACLC,EAAWP,EAAOqB,YAAY,EAChCD,IAAQtC,QAAa,CAACqC,IACtBA,EAAKZ,EAASY,IAEdA,GAAM,CAACD,IACPA,EAASX,EAASW,SAElBA,GAAU,CAACD,GAGXA,IAAQ,QACRA,EAAMV,EAASU,KAGfA,IACAX,EAAO,IAAMW,EACTC,IACAZ,GAAQ,IAAMY,EAEVC,IACAb,GAAQ,IAAMa,EACVC,IAAQtC,SACRwB,GAAQ,IAAMc,MAK1BpD,OAAOuC,SAASD,OAASA,IACzBtC,OAAOuC,SAASD,KAAOA,EAE/B,CAAC,OApFgBb,UAAMC,SAAS,IAuFrBM,EAAM,W,gMC9FrB,aACA,cACA,cACA,cAEA,cAEA,cAEA,cACA,cAAkD,iD,EAAA,6B,EAAA,sG,EAAA,sQAElD,IAAMsB,EAAS,SAAA5C,EAAK,OAAK,CACrB6C,WAAY,CACRC,YAAa,CACjB,CACJ,CAAC,EAaKC,EAAgB,a,EAAA,2BAIlB,WAAY1D,EAAO,Q,EAAA,mBACf,cAAMA,CAAK,EACX,IAAM2D,EAAW3D,EAAM2D,WAAa5C,OAAY,GAAOf,EAAM2D,SAE7D,GAAI,CACA,EAAKC,SAAW,CAACD,GAAY1D,OAAO4D,OAAS5D,OAAOuB,GACxD,OAASuB,EAAP,CACE,EAAKa,SAAW,CAACD,CACrB,CAAC,QACL,CAAC,O,EAAA,kCAED,UAAS,YACCG,EAAkB,KAAK9D,MAAM8D,gBAC7BC,EAAc,CAChBC,aAAc,KAAKhE,MAAMW,MAAMsD,YAAYC,OAAOF,cAAgB,EAClE3C,OAAc,KAAKrB,MAAMW,MAAMsD,YAAYC,OAAO7C,QAAgB,EACtE,EAEMjB,EAAQ,CACVqB,OAAQ,KAAKmC,SAAW,GAAK,EAC7BtC,KAAM,KAAKtB,MAAMmE,aAAe,EAChCC,MAAO,EACPC,SAAU,WACVC,WAAY,KAAKtE,MAAMW,MAAMsD,YAAYK,UAC7C,EACA,OAAI,KAAKtE,MAAMuE,QACXnE,EAAMoE,UAAY,IAGlB,KAAKxE,MAAMiD,QACXc,EAAYU,OAAS,iBAGlB,wBAAC,UAAO,CAAC,SAAS,WAAW,MAAOrE,CAAM,EAC7C,wBAAC,UAAG,CACA,QAAQ,WACR,aAAW,OACX,SAAU,CAAC,KAAKJ,MAAM0E,SAAW,KAAK1E,MAAMiD,MAC5C,QAAS,kBAAM,EAAKjD,MAAM2E,OAAO,EAAK,CAAC,EACvC,MAAOZ,CAAY,EAEnB,wBAAC,UAAQ,CAAC,UAAYD,EAAkD,GAAhC,KAAK9D,MAAM4E,QAAQpB,UAAgB,GAAG,CAACM,GAAmBe,UAAKC,EAAE,SAAS,CAAC,EAEvH,wBAAC,UAAG,CACA,QAAQ,WACR,aAAW,iBACX,SAAU,CAAC,KAAK9E,MAAM0E,SAAW,KAAK1E,MAAMiD,MAC5C,QAAS,kBAAM,EAAKjD,MAAM2E,OAAO,EAAI,CAAC,EACtC,MAAOI,OAAOC,OAAO,CAAC,EAAGjB,EAAa,CAACkB,WAAY,EAAE,CAAC,CAAE,EACxD,wBAAC,UAAQ,CAAC,UAAYnB,EAAkD,GAAhC,KAAK9D,MAAM4E,QAAQpB,UAAgB,GACzEM,EAAgD,IAA9Be,UAAKC,EAAE,mBAAmB,EAC7ChB,GAAmB,wBAAC,UAAS,KAAE,EAEpC,+BAAK,MAAO,CAACoB,SAAU,CAAC,CAAE,GAC1B,wBAAC,UAAG,CAAC,QAAQ,WAAW,aAAW,QAAQ,QAAS,kBAAM,EAAKlF,MAAMmF,QAAQ,CAAC,EAAE,MAAOpB,CAAY,EAC/F,wBAAC,UAAS,CAAC,UAAYD,EAAkD,GAAhC,KAAK9D,MAAM4E,QAAQpB,UAAgB,GAAG,CAACM,GAAmBe,UAAKC,EAAE,UAAU,CAAC,CACnH,CAEd,CAAC,OA9D0BpD,UAAMC,SAAS,EAiE9C+B,EAAiB9B,UAAY,CACzB2C,MAAO1C,UAAUuD,KACjBjB,YAAatC,UAAUC,OACvBgC,gBAAiBjC,UAAUuD,KAC3BzE,MAAOkB,UAAUwD,OACjBzB,SAAU/B,UAAUuD,KACpBV,QAAS7C,UAAUuD,KAAKE,WACxBrC,MAAOpB,UAAUuD,KACjBT,OAAQ9C,UAAU0D,KAAKD,WACvBH,QAAStD,UAAU0D,KAAKD,WACxB3B,SAAU9B,UAAUuD,IACxB,EAGA,IAAMpD,G,EAAUwD,WAAWjC,CAAM,EAAEG,CAAgB,EAAE,EACtC1B,EAAO,W,gMCxGtB,aACA,cACA,cAEMyD,EAAe,WACfC,EAAe,CAAC,KAAM,KAAM,KAAM,KAAM,KAAM,KAAM,IAAI,EACxDC,EAAe,CAAC,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,MAAO,KAAK,EAClGC,EAAe,CACjB,EAAM,cAEN,EAAM,yBACN,EAAM,+BAEN,GAAM,0CACN,GAAM,kCACN,GAAM,kDACN,IAAM,sCAEN,GAAM,qCACN,GAAM,mCACN,IAAM,mCAEN,GAAM,gCACN,GAAM,8BACN,IAAM,8BAEN,GAAM,8BACN,IAAM,6BACV,EACMC,EAAa,CACfC,QAAS,MACTC,SAAU,MACVC,SAAU,MACVC,YAAa,MACb,OAAQ,MACRC,OAAQ,MACRC,IAAK,MACLC,OAAQ,KACZ,EAEMC,EAAK,yB,EAAA,0B,EAAA,6CAWP,SAAoBC,EAAM,CACtB,OAAQA,GAAQ,IAAI3D,MAAM,OAAO,EAC5B4D,OAAO,SAAA1D,EAAI,QAAIA,CAAI,GACnBD,IAAI,SAAA4D,EAAI,QAAIA,EAAOA,EAAK,GAAGC,YAAY,EAAID,EAAKE,UAAU,CAAC,EAAEC,YAAY,EAAI,EAAE,GAC/EC,KAAK,GAAG,CACjB,CAAC,6BAED,SAAqBC,EAAS,CAC1B,IAAMnB,EAAOoB,KAAKC,MAAMF,EAAW,KAAU,EAC7CA,GAAW,KAAO,GAClB,IAAIG,EAAQF,KAAKC,MAAMF,EAAU,IAAI,EACjCG,EAAQ,KACRA,EAAQ,IAAMA,GAElBH,GAAW,KACX,IAAII,EAAUH,KAAKC,MAAMF,EAAU,EAAE,EACjCI,EAAU,KACVA,EAAU,IAAMA,GAEpBJ,GAAW,GACXA,EAAUC,KAAKC,MAAMF,CAAO,EACxBA,EAAU,KACVA,EAAU,IAAMA,GAEpB,IAAIK,EAAO,GACX,OAAIxB,IACAwB,GAAQ,GAAJ,OAAOxB,EAAI,YAAIb,UAAKC,EAAE,kBAAkB,EAAC,MAEjDoC,GAAQ,GAAJ,OAAOF,EAAK,YAAIC,EAAO,YAAIJ,CAAO,EAE/BK,CACX,CAEA,6BASA,SAAqBC,EAAS/D,EAAIgE,EAAUC,EAASC,EAAQ,CACzD,IAAIzE,EAAOsE,EAAQ/D,GACf8D,EAAO9D,EACLmE,EAAOD,EAAS,OAAS,OAW/B,GATI,OAAOF,GAAa,UAAY,CAACC,IACjCA,EAAU,CAACG,SAAUJ,CAAQ,EAC7BA,EAAW,MAGfC,EAAUA,GAAW,CAAC,EACjBA,EAAQG,WACTH,EAAQG,SAAYL,EAAQ,kBAAoBA,EAAQ,iBAAiBM,QAAUN,EAAQ,iBAAiBM,OAAOD,UAAavH,OAAOyH,SAAW,MAElJN,GAAYA,EAASd,KACrBY,EAAOE,EAASd,M,EACZ,WAAOY,CAAI,IAAK,WAChBA,EAAOA,EAAKG,EAAQG,WAAaN,EAAKS,YAG1C9E,GAAQA,EAAK4E,QAAU5E,EAAK4E,OAAOF,GACnCL,EAAOrE,EAAK4E,OAAOF,GACfA,IAAS,QAAU,CAACL,GAAQrE,EAAK4E,OAAOG,OACxCV,EAAOrE,EAAK4E,OAAOG,O,EAEnB,WAAOV,CAAI,IAAK,WAChBA,EAAOA,EAAKG,EAAQG,WAAaN,EAAKS,IAAMT,EAAKW,IAAMX,EAAKY,IAAM,IAEtEZ,GAAQA,GAAQ,IAAIa,SAAS,EAAEtF,QAAQ,QAAS,GAAG,EAE/CyE,IAASA,EAAKT,YAAY,IAC1BS,EAAOA,EAAK,GAAKA,EAAKR,UAAU,CAAC,EAAEC,YAAY,OAEhD,CACH,IAAIqB,EAAM5E,EAAG6E,YAAY,GAAG,EAC5Bf,EAAO9D,EAAGsD,UAAUsB,EAAM,CAAC,EAAEvF,QAAQ,QAAS,GAAG,EACjDyE,EAAOb,EAAM6B,aAAahB,CAAI,CAClC,CAEA,OAAOA,EAAKiB,KAAK,CACrB,CAEA,oCASA,SAA4BC,EAAKhB,EAAUC,EAASC,EAAQe,EAAQ,CAChE,IAAIxF,EAAOuF,EACPlB,EAAQkB,GAAOA,EAAIE,KAAQ,GACzBf,EAAOD,EAAS,OAAS,OAE/B,OAAI,OAAOF,GAAa,UAAY,CAACC,IACjCA,EAAU,CAACG,SAAUJ,CAAQ,EAC7BA,EAAW,MAGfC,EAAUA,GAAW,CAAC,EAElBD,GAAYA,EAASd,MACrBY,EAAOE,EAASd,M,EACZ,WAAOY,CAAI,IAAK,WAChBA,EAAOA,EAAKG,EAAQG,WAAaN,EAAKS,KAG1C9E,GAAQA,EAAK4E,QAAU5E,EAAK4E,OAAOF,KACnCL,EAAOrE,EAAK4E,OAAOF,GACfA,IAAS,QAAU,CAACL,GAAQrE,EAAK4E,OAAOG,OACxCV,EAAOrE,EAAK4E,OAAOG,O,EAEnB,WAAOV,CAAI,IAAK,WAChBA,EAAOA,EAAKG,EAAQG,WAAaN,EAAKS,IAE1CT,GAAQA,GAAQ,IAAIa,SAAS,EAAEtF,QAAQ,QAAS,GAAG,EAE/CyE,IAASA,EAAKT,YAAY,IAC1BS,EAAOA,EAAK,GAAKA,EAAKR,UAAU,CAAC,EAAEC,YAAY,IAGhD0B,EAASnB,EAAOA,EAAKiB,KAAK,CACrC,CAEA,gCAMA,SAAwBC,EAAKG,EAAWlB,EAAS,CACzCe,GAAOA,EAAII,eAAe,QAAQ,IAClCJ,EAAMA,EAAIX,QAEd,IAAIL,EACJ,GAAIgB,GAAOA,EAAIK,OAAQ,CACnBrB,GAAYgB,EAAIK,QAAU,CAAC,GAAGhD,GAC9B,IAAMiD,EAAOrB,EAAQqB,MAAQ,QAC7B,GAAItB,GAAYA,EAASsB,IACrB,GAAIH,GACA,GAAInB,EAASsB,GAAMC,UAAYvB,EAASsB,GAAMC,SAASJ,GACnD,OAAOK,KAAKC,MAAMD,KAAKE,UAAU1B,EAASsB,GAAMC,SAASJ,EAAU,CAAC,UAGpEnB,EAASsB,GAAMK,MACf,OAAOH,KAAKC,MAAMD,KAAKE,UAAU1B,EAASsB,GAAMK,KAAK,CAAC,EAItE,CACA,OAAO,IACX,CAEA,qCAKA,SAA6BX,EAAKG,EAAWlB,EAAS,CAC9Ce,GAAOA,EAAII,eAAe,QAAQ,IAClCJ,EAAMA,EAAIX,QAEd,IAAIL,EACJ,GAAIgB,GAAOA,EAAIK,OAAQ,CACnBrB,GAAYgB,EAAIK,QAAU,CAAC,GAAGhD,GAC9B,IAAMiD,EAAOrB,EAAQqB,MAAQ,QAC7B,GAAItB,GAAYA,EAASsB,IACrB,GAAIH,GACA,GAAInB,EAASsB,GAAMM,SAAW5B,EAASsB,GAAMM,QAAQT,GACjD,OAAOK,KAAKC,MAAMD,KAAKE,UAAU1B,EAASsB,GAAMM,QAAQT,EAAU,CAAC,UAGnEnB,EAASsB,GAAMO,KACf,OAAOL,KAAKC,MAAMD,KAAKE,UAAU1B,EAASsB,GAAMO,IAAI,CAAC,EAIrE,CACA,OAAO,IACX,CAEA,uBAMA,SAAeC,EAAMC,EAAQC,EAAM,CAC/B,IAAMC,EAASC,MAAMC,KAAKL,CAAI,EAC9B,EAAkBG,EAAOG,OAAOL,EAAQ,CAAC,EAAC,G,EAAA,gBAAnCM,EAAO,KACdJ,SAAOG,OAAOJ,EAAM,EAAGK,CAAO,EACvBJ,CACX,CAAC,2BAOD,SAAmBjB,EAAKf,EAASqC,EAAiB,CAC9C,IAAItC,EACEhE,EAAMgF,GAAOA,EAAIE,KAASjB,GAAWA,EAAQjE,GA0CnD,GAzCIgF,GAAOA,EAAII,eAAe,QAAQ,IAClCJ,EAAMA,EAAIX,QAEVW,GAAOA,EAAIK,QACXrB,EAAWgB,EAAIK,QAAU,CAAC,EAC1BrB,EAAWA,EAAS3B,IAAc2B,EAAS3B,GAAW4B,EAAQqB,MAAQ,SAAWE,KAAKC,MAAMD,KAAKE,UAAU1B,EAAS3B,GAAW4B,EAAQqB,MAAQ,QAAQ,CAAC,EAAI,CAACiB,QAAS,EAAI,GAE1KvC,EAAW,CAACuC,QAASD,IAAoB3I,OAAY,GAAO2I,EAAiBE,UAAW,EAAK,EAG5FxC,EAASoB,eAAe,SAAS,IAClCpB,EAASuC,QAAUD,IAAoB3I,OAAY,GAAO2I,GAQtDrC,IACI,CAACD,EAASd,MAASe,EAAQf,OAAOc,EAASd,KAAQe,EAAQf,MAC3D,CAACc,EAASyC,MAASxC,EAAQwC,OAAOzC,EAASyC,KAAQxC,EAAQwC,MAC3D,CAACzC,EAAS0C,OAASzC,EAAQyC,QAAO1C,EAAS0C,MAAQzC,EAAQyC,QAG/D1B,IACI,CAAChB,EAAS0C,OAAS1B,EAAI0B,QAAO1C,EAAS0C,MAAQ1B,EAAI0B,OACnD,CAAC1C,EAASyC,MAASzB,EAAIyB,OAAOzC,EAASyC,KAAQzB,EAAIyB,MACnD,CAACzC,EAASd,MAAS8B,EAAI9B,OAAOc,EAASd,KAAQ8B,EAAI9B,Q,EAI3D,WAAOc,EAASd,IAAI,IAAK,WACzBc,EAASd,KAAOc,EAASd,KAAKe,EAAQG,WAAaJ,EAASd,KAAKqB,GAEjEP,EAASd,MAAQc,EAASd,MAAQ,IAAIyB,SAAS,EAAEtF,QAAQ,KAAM,GAAG,EAE9D2E,EAASd,OAASc,EAASd,KAAKG,YAAY,IAC5CW,EAASd,KAAOc,EAASd,KAAK,GAAKc,EAASd,KAAKI,UAAU,CAAC,EAAEC,YAAY,IAG9E,CAACS,EAASd,MAAQlD,EAAI,CACtB,IAAI4E,EAAM5E,EAAG6E,YAAY,GAAG,EAC5Bb,EAASd,KAAOlD,EAAGsD,UAAUsB,EAAM,CAAC,EAAEvF,QAAQ,QAAS,GAAG,EAC1D2E,EAASd,MAAQc,EAASd,MAAQ,IAAIyB,SAAS,EAAEtF,QAAQ,KAAM,GAAG,EAClE2E,EAASd,KAAOD,EAAM6B,aAAad,EAASd,IAAI,CACpD,CAEA,OAAOc,CACX,CAEA,2BAKA,SAAmBgB,EAAKhB,EAAUC,EAAS,CACvC,GAAIe,EAAK,CACLA,EAAIX,OAASW,EAAIX,QAAU,CAAC,EAC5BW,EAAIX,OAAOgB,OAASL,EAAIX,OAAOgB,QAAU,CAAC,EAC1CL,EAAIX,OAAOgB,OAAOhD,GAAa2C,EAAIX,OAAOgB,OAAOhD,IAAc,CAAC,EAChE2C,EAAIX,OAAOgB,OAAOhD,GAAW4B,EAAQqB,MAAQ,SAAWtB,EACxD,IAAM2C,EAAI3B,EAAIX,OAAOgB,OAAOhD,GAAW4B,EAAQqB,MAAQ,SACvD,OAAIqB,EAAEC,YACED,EAAED,QAAU/I,SACZqH,EAAIX,OAAOqC,MAAQC,EAAED,MACrB,OAAOC,EAAED,OAETC,EAAEF,OAAS9I,SACXqH,EAAIX,OAAOoC,KAAOE,EAAEF,KACpB,OAAOE,EAAEF,MAETE,EAAEzD,OAASvF,U,EACP,WAAOqH,EAAIX,OAAOnB,IAAI,IAAK,WAC3B8B,EAAIX,OAAOnB,KAAO,CAAC,GACnB8B,EAAIX,OAAOnB,KAAKe,EAAQG,UAAYuC,EAAEzD,KAI1C,OAAOyD,EAAEzD,OAIV,EACX,KACI,OAAO,EAEf,CAEA,uBAMA,SAAec,EAAUhH,EAAO,CAC5B,OAAIgH,GAAYA,EAASyC,KAEjBzC,EAASyC,KAAKI,QAAU,EACjB,gCAAM,MAAO7J,GAAS,CAAC,CAAE,EAAEgH,EAASyC,IAAI,EAE/CzC,EAASyC,KAAKK,WAAW,YAAY,EAC9B,+BAAK,IAAK9C,EAASd,KAAM,IAAKc,EAASyC,KAAM,MAAOzJ,GAAS,CAAC,CAAE,GAEhE,+BAAK,IAAKgH,EAASd,KAAM,KAAMc,EAAS+C,QAAU,IAAM/C,EAASyC,KAAM,MAAOzJ,GAAS,CAAC,CAAE,GAGlG,IACX,CAEA,6BAMA,SAAqBgD,EAAIgF,EAAK,CAO1B,I,EALI,WAAOhF,CAAE,IAAK,WACdgF,EAAMhF,EACNA,EAAKgF,EAAIE,KAGTF,GAAOA,EAAIX,QAAUW,EAAIX,OAAOoC,KAAM,CACtC,IAAIA,EAAOzB,EAAIX,OAAOoC,KAEtB,GAAI,OAAOA,GAAS,UAAYA,EAAKI,QAAU,EAC3C,OAAOJ,EAEX,GAAIA,EAAKK,WAAW,YAAY,EAC5B,OAAOL,EAEP,IAAMnH,EAAQU,EAAGT,MAAM,GAAG,EAC1B,OAAID,EAAM,KAAO,SACbmH,EAAO,WAAanH,EAAM,IAAMmH,EAAKK,WAAW,GAAG,EAAI,GAAK,KAAOL,EAEnEA,EAAO,WAAanH,EAAM,IAAMmH,EAAKK,WAAW,GAAG,EAAI,GAAK,KAAOL,EAGnE5J,OAAOuC,SAAS4H,SAASC,MAAM,6BAA6B,GAErDpK,OAAOuC,SAAS4H,SAASC,MAAM,kBAAkB,EADxDR,EAAO,SAAWA,EAIlB5J,OAAOuC,SAAS4H,SAASC,MAAM,YAAY,IAC3CR,EAAO,MAAQA,GAEZA,CAEf,KACI,QAAO,IAEf,CAEA,8BAKA,SAAsB3C,EAAM,CACxB,GAAI,GAAsC,sBAiCtC,QAAOb,EAAM6B,aAAahB,CAAI,CAEtC,CAEA,2BAOA,SAAmB4C,EAAOQ,EAAc,CACpC,GAAIR,GAAU,MAA+BA,IAAU,GACnD,OAAOQ,IAAiBvJ,OAAY,GAAOuJ,EAE/CR,EAAQA,EAAM/B,SAAS,EACnB+B,EAAMS,QAAQ,GAAG,IAAM,IACvBT,EAAQA,EAAMU,MAAM,CAAC,GAEzB,IAAIC,EACAC,EACAC,EAEEC,EAAMd,EAAMO,MAAM,sEAAsE,EAC9F,GAAIO,GAAOA,EAAIX,SAAW,EACtBQ,EAAII,SAASD,EAAI,GAAI,EAAE,EACvBF,EAAIG,SAASD,EAAI,GAAI,EAAE,EACvBD,EAAIE,SAASD,EAAI,GAAI,EAAE,MACpB,CAMH,GAJId,EAAMG,SAAW,IACjBH,EAAQA,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,IAGrEA,EAAMG,SAAW,EACjBH,EAAQA,EAAMpD,UAAU,EAAG,CAAC,UAE5BoD,EAAMG,SAAW,EACjB,MAAO,GAGXQ,EAAII,SAASf,EAAMU,MAAM,EAAG,CAAC,EAAG,EAAE,EAClCE,EAAIG,SAASf,EAAMU,MAAM,EAAG,CAAC,EAAG,EAAE,EAClCG,EAAIE,SAASf,EAAMU,MAAM,EAAG,CAAC,EAAG,EAAE,CACtC,CAGA,OAAQC,EAAI,KAAQC,EAAI,KAAQC,EAAI,MAAU,GAClD,CAAC,6BAMD,SAAqB9D,EAAS,CAE1B,GADAA,EAAUiE,WAAWjE,CAAO,EACxBkE,MAAMlE,CAAO,EACb,MAAO,QAEX,IAAMG,EAAQF,KAAKC,MAAMF,EAAU,IAAI,EACnCI,EAAUH,KAAKC,MAAOF,EAAU,KAAQ,EAAE,EAC1CmE,EAAOnE,EAAU,GACrB,OAAIG,GACIC,EAAU,KAAIA,EAAU,IAAMA,GAC9B+D,EAAO,KAAIA,EAAO,IAAMA,GACrBhE,EAAQ,IAAMC,EAAU,IAAM+D,IAEjCA,EAAO,KAAIA,EAAO,IAAMA,GACrB/D,EAAU,IAAM+D,EAE/B,CAEA,gCAKA,SAAwBC,EAAO,CAC3B,GAAIA,GAAS,GAAKA,EAAQ,MACtB,MAAO,IACJ,GAAIA,GAAS,OAASA,EAAQ,MACjC,MAAO,MACJ,GAAIA,GAAS,OAASA,EAAQ,MACjC,MAAO,KACJ,GAAIA,GAAS,OAASA,EAAQ,MACjC,MAAO,MACJ,GAAIA,GAAS,OAASA,EAAQ,OACjC,MAAO,IACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,MACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,KACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,MACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,IACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,MACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,KACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,MACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,IACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,MACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,KACJ,GAAIA,GAAS,QAAUA,EAAQ,OAClC,MAAO,MACJ,GAAIA,GAAS,OAChB,MAAO,GAEf,CAEA,uBAIA,SAAeC,EAAK,CAChB,OAAI,OAAOA,GAAQ,SACXA,EAAIjB,OAAS,EACN,IAAMiB,EAENA,EAEJA,EAAM,GACN,IAAMA,EAENA,CAEf,CAEA,6BAIA,SAAqBC,EAAQ,CACrBA,IACA9E,EAAM+E,WAAaD,EAAO1E,YAAY,EAAE9D,MAAM,OAAO,EACrD0D,EAAM+E,WAAW5B,OAAOnD,EAAM+E,WAAWb,QAAQ,MAAM,EAAG,CAAC,EAEnE,CAEA,2BAKA,SAAmBc,EAAK,CACpB,GAAI,OAAOA,GAAQ,SAAU,CAEzB,GADAA,EAAMA,EAAIlD,KAAK,EACX,CAACkD,EAAK,MAAO,GAEjB,GAAIA,EAAIhB,MAAM,WAAW,EAErB,OAAOgB,EAEX,IAAIC,EAAID,EAAIhB,MAAM,uCAAuC,EACzD,GAAIiB,EAAG,CACH,IAAIC,EAAI,CAACV,SAASS,EAAE,GAAI,EAAE,EAAGT,SAASS,EAAE,GAAI,EAAE,EAAGT,SAASS,EAAE,GAAI,EAAE,CAAC,EAC/DE,EAAOD,EAAEE,KAAK,SAAAC,EAAC,QAAIA,EAAI,EAAE,GAC7BH,EAAE/B,OAAO+B,EAAEhB,QAAQiB,CAAI,EAAG,CAAC,EAC3B,IAAIG,EAAMJ,EAAEE,KAAK,SAAAH,EAAC,QAAIA,EAAI,EAAE,GACxBK,GACAJ,EAAE/B,OAAO+B,EAAEhB,QAAQoB,CAAG,EAAG,CAAC,EAC1BN,EAAM,IAAIO,KAAKJ,EAAMD,EAAE,GAAK,EAAGI,CAAG,GAG9BtF,EAAM+E,WAAW,GAAG,KAAO,KAAO/E,EAAM+E,WAAW,GAAG,KAAO,KAC7DC,EAAM,IAAIO,KAAKJ,EAAMD,EAAE,GAAK,EAAGA,EAAE,EAAE,EAC/BzE,KAAK+E,IAAIR,EAAIS,QAAUF,KAAKP,IAAI,CAAC,EAAI,KAAU,GAAK,KACpDA,EAAM,IAAIO,KAAKJ,EAAMD,EAAE,GAAK,EAAGA,EAAE,EAAE,IAIvClF,EAAM+E,WAAW,GAAG,KAAO,KAAO/E,EAAM+E,WAAW,GAAG,KAAO,KAC7DC,EAAM,IAAIO,KAAKJ,EAAMD,EAAE,GAAK,EAAGA,EAAE,EAAE,EAC/BzE,KAAK+E,IAAIR,EAAIS,QAAUF,KAAKP,IAAI,CAAC,EAAI,KAAU,GAAK,KACpDA,EAAM,IAAIO,KAAKJ,EAAMD,EAAE,GAAK,EAAGA,EAAE,EAAE,IAGvCF,EAAM,IAAIO,KAAKP,CAAG,CAG9B,MACIA,EAAM,IAAIO,KAAKP,CAAG,CAE1B,MACIA,EAAM,IAAIO,KAAKP,CAAG,EAGtB,IAAIU,EAAOlH,UAAKC,EAAE,UAAYY,EAAK2F,EAAIW,OAAO,EAAE,EAAEvJ,QAAQ,UAAW,EAAE,EACvEsJ,UAAQ,KAAOV,EAAIY,QAAQ,EAAI,IAAMpH,UAAKC,EAAE,YAAca,EAAO0F,EAAIa,SAAS,EAAE,EAAEzJ,QAAQ,YAAa,EAAE,EAClGsJ,CACX,CAEA,+BAKA,SAAuB7E,EAAM,CACzB,IAAIoE,EAAIpE,EAAKmD,MAAM,mDAAmD,EACtE,GAAIiB,EAAG,CACH,IAAMjC,EAAS,CAAC,EACZ8C,EAAM,EACV,EAAG,CACC,IAAMC,EAAQlF,EAAKR,UAAU,EAAG4E,EAAEe,KAAK,EAIvC,GAHAnF,EAAOA,EAAKR,UAAU4E,EAAEe,MAAQf,EAAE,GAAGrB,MAAM,EAC3CmC,GAAS/C,EAAOiD,KAAK,gCAAM,IAAG,WAAMH,GAAK,CAAG,EAAEC,CAAK,CAAQ,EAEvDd,EAAE,GAAGpB,WAAW,KAAK,EACrBb,EAAOiD,KAAK,6BAAG,IAAG,WAAMH,GAAK,CAAG,EAAEb,EAAE,GAAG5E,UAAU,EAAG4E,EAAE,GAAGrB,OAAS,CAAC,CAAC,CAAK,UAClEqB,EAAE,GAAGpB,WAAW,KAAK,EAC5Bb,EAAOiD,KAAK,6BAAG,IAAG,WAAMH,GAAK,CAAG,EAAEb,EAAE,GAAG5E,UAAU,EAAG4E,EAAE,GAAGrB,OAAS,CAAC,CAAC,CAAK,UAClEqB,EAAE,GAAGpB,WAAW,KAAK,EAC5Bb,EAAOiD,KAAK,8BAAI,IAAG,WAAMH,GAAK,CAAG,EAAG,MACjC,CACH,IAAII,EAAOjB,EAAE,GAAGjB,MAAM,gBAAgB,GAAKiB,EAAE,GAAGjB,MAAM,gBAAgB,EAClEmC,EAASlB,EAAE,GAAGjB,MAAM,kBAAkB,GAAKiB,EAAE,GAAGjB,MAAM,kBAAkB,EACxEoC,EAAMnB,EAAE,GAAGjB,MAAM,eAAe,GAAKiB,EAAE,GAAGjB,MAAM,eAAe,EAC7DqC,EAAQpB,EAAE,GAAGjB,MAAM,WAAW,EAGpChB,EAAOiD,KAAK,6BACR,IAAG,WAAMH,GAAK,EACd,KAAMI,EAAOA,EAAK,GAAK,GACvB,OAAQC,EAASA,EAAO,GAAK,SAC7B,IAAKC,EAAMA,EAAI,GAAK,GACpB,MAAO,CAAE3C,MAAO,SAAU,CAAE,EAE3B4C,EAAQA,EAAM,GAAK,EAAE,CACtB,CACR,CAEApB,EAAIpE,GAAQA,EAAKmD,MAAM,mDAAmD,EACrEiB,GACDpE,GAAQmC,EAAOiD,KAAK,gCAAM,IAAK,IAAOH,GAAO,EAAEjF,CAAI,CAAQ,CAEnE,OAASoE,GAET,OAAOjC,CACX,KACI,QAAOnC,CAEf,CAEA,4BAOA,SAAoByF,EAAQvJ,EAAIwJ,EAAYC,EAAU,CAClD,OAAKzJ,EAuBAyJ,EAGOF,EAAOvJ,IACXuJ,EAAOvJ,GAAIqE,QACXkF,EAAOvJ,GAAIqE,OAAOgB,QAClBkE,EAAOvJ,GAAIqE,OAAOgB,OAAOmE,IACzBD,EAAOvJ,GAAIqE,OAAOgB,OAAOmE,GAAYE,WAAa,KAN/CH,EAAOvJ,GAAIqE,OAAOqF,UAvBpBD,EAWGF,GAAU,CAACA,EAAOlF,OACXkF,EAAOG,UAENH,GACJA,EAAOlF,QACPkF,EAAOlF,OAAOgB,QACdkE,EAAOlF,OAAOgB,OAAOmE,GACrBD,EAAOlF,OAAOgB,OAAOmE,GAAYE,UAAY/L,OAjBhD4L,EAAOlF,OAGJkF,GAAU,CAACA,EAAOlF,OACXkF,EAAOG,UAEPH,EAAOlF,OAAOqF,UALlBH,EAAOG,SA6B9B,CAEA,mCAMA,SAA2B1E,EAAKwE,EAAYC,EAAU,CAClD,OAAKA,EAWGzE,GAAO,CAACA,EAAIX,OACLW,EAAI0E,UAEH1E,GACJA,EAAIX,QACJW,EAAIX,OAAOgB,QACXL,EAAIX,OAAOgB,OAAOmE,GAClBxE,EAAIX,OAAOgB,OAAOmE,GAAYE,UAAY/L,OAjB7CqH,EAAIX,OAGDW,GAAO,CAACA,EAAIX,OACLW,EAAI0E,UAEJ1E,EAAIX,OAAOqF,UALf1E,EAAI0E,SAmBvB,CAEA,+BAMA,SAAuB1E,EAAKwE,EAAYC,EAAU,CAC1CA,GACAzE,EAAIX,OAAOgB,OAASL,EAAIX,OAAOgB,QAAU,CAAC,EAC1CL,EAAIX,OAAOgB,OAAOmE,GAAcxE,EAAIX,OAAOgB,OAAOmE,IAAe,CAAC,EAClExE,EAAIX,OAAOgB,OAAOmE,GAAYE,UAAY,CAAC,GAE3C1E,EAAIX,OAAOqF,UAAY,CAAC,CAEhC,CAEA,+BAMA,SAAuB1E,EAAKwE,EAAYC,EAAU,CAC1CA,EACIzE,EAAIX,QAAUW,EAAIX,OAAOgB,QAAUL,EAAIX,OAAOgB,OAAOmE,KACrDxE,EAAIX,OAAOgB,OAAOmE,GAAc,MAGpCxE,EAAIX,OAAOqF,UAAY,IAE/B,CAEA,+BASA,SAAuB1E,EAAK2E,EAAcC,EAAMC,EAAWL,EAAYC,EAAU,CAC7E,IAAMrF,EAAW3C,UAAKqI,YAAY,EAGlC,GAAI,OAAO9E,EAAIX,OAAOqF,WAAc,SAAU,CAC1C,IAAMK,EAAM/E,EAAIX,OAAOqF,UACvB1E,EAAIX,OAAOqF,UAAY,CAAC,EACxB1E,EAAIX,OAAOqF,UAAUtF,GAAY2F,CACrC,CAGA,GAAI/E,EAAG,QAAWA,EAAG,OAAQ4E,KAAM,CAC/B,OAAO5E,EAAG,OAAQ4E,KAClB,IAAII,EAAahF,EAAIX,OAAOqF,WAExB,CAACM,I,EAAc,WAAOA,CAAU,IAAK,YACrCA,EAAa,CAACzF,GAAIyF,CAAU,EAC5BA,EAAW5F,GAAY4F,EAAWzF,IAEtCS,EAAIX,OAAOqF,UAAYM,CAC3B,CAgCA,GA/BIH,IAAclM,SACV8L,GACAzE,EAAIX,OAAOgB,OAASL,EAAIX,OAAOgB,QAAU,CAAC,EAC1CL,EAAIX,OAAOgB,OAAOmE,GAAcxE,EAAIX,OAAOgB,OAAOmE,IAAe,CAAC,EAClExE,EAAIX,OAAOgB,OAAOmE,GAAYE,UAAY1E,EAAIX,OAAOgB,OAAOmE,GAAYE,WAAa,CAAC,EACjFG,EAGD7E,EAAIX,OAAOgB,OAAOmE,GAAYE,UAAUG,UAAYA,EAFpD,OAAO7E,EAAIX,OAAOgB,OAAOmE,GAAYE,UAAUG,YAKnD7E,EAAIX,OAAOqF,UAAY1E,EAAIX,OAAOqF,WAAa,CAAC,EAC3CG,EAGD7E,EAAIX,OAAOqF,UAAUG,UAAYA,EAFjC,OAAO7E,EAAIX,OAAOqF,UAAUG,YAOpCD,IAASjM,SACL8L,GACAzE,EAAIX,OAAOgB,OAASL,EAAIX,OAAOgB,QAAU,CAAC,EAC1CL,EAAIX,OAAOgB,OAAOmE,GAAcxE,EAAIX,OAAOgB,OAAOmE,IAAe,CAAC,EAClExE,EAAIX,OAAOgB,OAAOmE,GAAYE,UAAY1E,EAAIX,OAAOgB,OAAOmE,GAAYE,WAAa,CAAC,EACtF1E,EAAIX,OAAOgB,OAAOmE,GAAYE,UAAUE,KAAOA,IAE/C5E,EAAIX,OAAOqF,UAAY1E,EAAIX,OAAOqF,WAAa,CAAC,EAChD1E,EAAIX,OAAOqF,UAAUE,KAAOA,IAGhCD,IAAiBhM,OAAW,CAC5B,IAAI+L,EAaJ,GAZID,GACAzE,EAAIX,OAAOgB,OAASL,EAAIX,OAAOgB,QAAU,CAAC,EAC1CL,EAAIX,OAAOgB,OAAOmE,GAAcxE,EAAIX,OAAOgB,OAAOmE,IAAe,CAAC,EAClExE,EAAIX,OAAOgB,OAAOmE,GAAYE,UAAY1E,EAAIX,OAAOgB,OAAOmE,GAAYE,WAAa,CAAC,EACtFA,EAAY1E,EAAIX,OAAOgB,OAAOmE,GAAYE,YAE1C1E,EAAIX,OAAOqF,UAAY1E,EAAIX,OAAOqF,WAAa,CAAC,EAChDA,EAAY1E,EAAIX,OAAOqF,WAE3BA,EAAUtF,GAAYuF,EAGlBD,IAAc,CAACA,EAAUtF,IACxBsF,EAAUtF,KAAcY,EAAIX,OAAOnB,OAC/B,CAAC8B,EAAIX,OAAO4F,MAAQjF,EAAIX,OAAO4F,KAAK9C,QAAQ,QAAQ,GAAK,IAAM,CACpE,OAAOuC,EAAUtF,GACjB,IAAI8F,EAAQ,GAEZ,QAAWnB,KAAOW,EACd,GAAIA,EAAUtE,eAAe2D,CAAG,EAAG,CAC/BmB,EAAQ,GACR,KACJ,CAGAA,IACIT,EACIzE,EAAIX,OAAOgB,OAAOmE,GAAYE,UAAUE,OAASjM,OACjD,OAAOqH,EAAIX,OAAOgB,OAAOmE,IAEzB,OAAOxE,EAAIX,OAAOgB,OAAOmE,GAAYjF,GACrC,OAAOS,EAAIX,OAAOgB,OAAOmE,GAAY/E,GACrC,OAAOO,EAAIX,OAAOgB,OAAOmE,GAAY9E,GACrC,OAAOM,EAAIX,OAAOgB,OAAOmE,GAAYW,GACrC,OAAOnF,EAAIX,OAAOgB,OAAOmE,GAAYY,GACrC,OAAOpF,EAAIX,OAAOgB,OAAOmE,GAAYa,GACrC,OAAOrF,EAAIX,OAAOgB,OAAOmE,GAAYc,GACrC,OAAOtF,EAAIX,OAAOgB,OAAOmE,GAAYe,GACrC,OAAOvF,EAAIX,OAAOgB,OAAOmE,GAAYgB,GACrC,OAAOxF,EAAIX,OAAOgB,OAAOmE,GAAY,UAGrCxE,EAAIX,OAAOqF,UAAUE,OAASjM,QAC9B,OAAOqH,EAAIX,OAAOqF,UAAUnF,GAC5B,OAAOS,EAAIX,OAAOqF,UAAUjF,GAC5B,OAAOO,EAAIX,OAAOqF,UAAUhF,GAC5B,OAAOM,EAAIX,OAAOqF,UAAUS,GAC5B,OAAOnF,EAAIX,OAAOqF,UAAUU,GAC5B,OAAOpF,EAAIX,OAAOqF,UAAUW,GAC5B,OAAOrF,EAAIX,OAAOqF,UAAUY,GAC5B,OAAOtF,EAAIX,OAAOqF,UAAUa,GAC5B,OAAOvF,EAAIX,OAAOqF,UAAUc,GAC5B,OAAOxF,EAAIX,OAAOqF,UAAU,UAE5B1E,EAAIX,OAAOqF,UAAY,KAIvC,CACJ,CACJ,CAEA,gCAMA,SAAwB1E,EAAKwE,EAAYC,EAAU,CAC3CA,GACAzE,EAAIX,OAAOgB,OAASL,EAAIX,OAAOgB,QAAU,CAAC,EAC1CL,EAAIX,OAAOgB,OAAOmE,GAAcxE,EAAIX,OAAOgB,OAAOmE,IAAe,CAAC,EAClExE,EAAIX,OAAOgB,OAAOmE,GAAYE,UAAY,IAE1C1E,EAAIX,OAAOqF,UAAY,EAE/B,CAEA,+BAKA,SAAuB5F,EAAMnE,EAAG,CAC5BA,UAAKA,EAAE8K,gBAAgB,EACvB9K,GAAKA,EAAE+K,eAAe,G,EACfC,WAAK7G,CAAI,CACpB,CAEA,gCAKA,SAAwB8G,EAAU,CAC9B,IAAMhG,GAAOgG,GAAY,IAAI/F,YAAY,GAAG,EAC5C,OAAID,IAAQ,GACDgG,EAAStH,UAAUsB,EAAM,CAAC,EAAErB,YAAY,EAExC,IAEf,CAEA,2BAMA,SAAmBsH,EAAO,CACtB,GAAInH,KAAK+E,IAAIoC,CAAK,EAAI,KAClB,OAAOA,EAAQ,KAGnB,IAAMC,EAAQ,CAAC,KAAK,KAAK,IAAI,EAEzBC,EAAI,GAER,GACIF,GAAS,KACT,EAAEE,QACGrH,KAAK+E,IAAIoC,CAAK,GAAK,MAAQE,EAAID,EAAMjE,OAAS,GAEvD,OAAOgE,EAAMG,QAAQ,CAAC,EAAI,IAAMF,EAAMC,EAC1C,CAEA,gCAOA,SAAwBrE,EAAOlJ,EAAWyN,EAAQ,CAC9C,GAAKvE,EAEE,CACH,IAAMwE,EAAgBjI,EAAMkI,YAAYzE,EAAO,EAAI,EACnD,OAAIwE,IAAkB,YAAc1N,IAAc,QAAWyN,GAAUzN,IAAc,SAC1E,OAEP0N,IAAkB,YAAc1N,IAAc,SAAYyN,GAAUzN,IAAc,QAC3E,OAEP,MAER,KAXI,OAYR,CAGA,2BAMA,SAAmB4N,EAAKC,EAAI,CACxB,GAAyBD,GAAQ,MAAQA,IAAQ,IAAM,OAAOA,GAAQ,SAClE,MAAO,GAEX,GAAIA,EAAItE,WAAW,MAAM,EAAG,CACxB,IAAMoB,EAAIkD,EAAInE,MAAM,8CAA8C,EAC9DiB,IACAkD,EAAM3D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EACjD7D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EAC/C7D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EAE3D,SAAWF,EAAItE,WAAW,KAAK,EAAG,CAC9B,IAAMoB,EAAIkD,EAAInE,MAAM,iCAAiC,EACjDiB,IACAkD,EAAM3D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EACjD7D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EAC/C7D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EAE3D,MACIF,EAAItE,WAAW,GAAG,IAClBsE,EAAMA,EAAIhE,MAAM,CAAC,GAGjBgE,EAAIvE,SAAW,IACfuE,EAAMA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,IAE3D,IAAIG,EAAO,KACX,GAAIH,EAAIvE,SAAW,EACf0E,EAAOH,EAAI9H,UAAU,EAAG,CAAC,EACzB8H,EAAMA,EAAI9H,UAAU,EAAG,CAAC,UAExB8H,EAAIvE,SAAW,EACfjH,eAAQ4L,KAAK,wBAA0BJ,CAAG,EACnCA,EAEX,IAAI/D,EAAII,SAAS2D,EAAIhE,MAAM,EAAG,CAAC,EAAG,EAAE,EAChCE,EAAIG,SAAS2D,EAAIhE,MAAM,EAAG,CAAC,EAAG,EAAE,EAChCG,EAAIE,SAAS2D,EAAIhE,MAAM,EAAG,CAAC,EAAG,EAAE,EAEpC,OAAIiE,EAEQhE,EAAI,KAAQC,EAAI,KAAQC,EAAI,KAAS,IAAG,iBAChCgE,GAAc,EAAE,mBAChBA,GAAc,EAAE,GAGpClE,GAAK,IAAMA,GAAG1C,SAAS,EAAE,EACzB2C,GAAK,IAAMA,GAAG3C,SAAS,EAAE,EACzB4C,GAAK,IAAMA,GAAG5C,SAAS,EAAE,EAElB,IAAP,OAAW0C,EAAEiE,SAAS,EAAG,GAAG,CAAC,SAAGhE,EAAEgE,SAAS,EAAG,GAAG,CAAC,SAAG/D,EAAE+D,SAAS,EAAG,GAAG,CAAC,SAAGC,GAAc,EAAE,EAC9F,CAEA,yBAKA,SAAiBH,EAAK,CAClB,GAAyBA,GAAQ,MAAQA,IAAQ,IAAM,OAAOA,GAAQ,SAClE,MAAO,GAEX,GAAIA,EAAItE,WAAW,MAAM,EAAG,CACxB,IAAMoB,EAAIkD,EAAInE,MAAM,8CAA8C,EAC9DiB,IACAkD,EAAM3D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EACjD7D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EAC/C7D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EAE3D,SAAWF,EAAItE,WAAW,MAAM,EAAG,CAC/B,IAAMoB,EAAIkD,EAAInE,MAAM,iCAAiC,EACjDiB,IACAkD,EAAM3D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EACjD7D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EAC/C7D,SAASS,EAAE,GAAI,EAAE,EAAEvD,SAAS,EAAE,EAAE2G,SAAS,EAAG,GAAG,EAE3D,MACIF,EAAItE,WAAW,GAAG,IAClBsE,EAAMA,EAAIhE,MAAM,CAAC,GAMrB,OAHIgE,EAAIvE,SAAW,IACfuE,EAAMA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,GAAKA,EAAI,IAEvDA,EAAIvE,SAAW,GAAKuE,EAAIvE,SAAW,GACnCjH,QAAQ4L,KAAK,wBAAD,OAAyBJ,CAAG,GACjC,IAGJ,CACH3D,SAAS2D,EAAIhE,MAAM,EAAG,CAAC,EAAG,EAAE,EAC5BK,SAAS2D,EAAIhE,MAAM,EAAG,CAAC,EAAG,EAAE,EAC5BK,SAAS2D,EAAIhE,MAAM,EAAG,CAAC,EAAG,EAAE,CAAC,CAErC,CAGA,uBAKA,SAAeI,EAAI,CACf,IAAIH,EAAIG,EAAI,GAAK,IACbF,EAAIE,EAAI,GAAK,IACbD,EAAIC,EAAI,GAAK,IAEjBH,EAAKA,EAAI,OAAW3D,KAAK+H,KAAKpE,EAAI,MAAS,MAAO,GAAG,EAAIA,EAAI,MAC7DC,EAAKA,EAAI,OAAW5D,KAAK+H,KAAKnE,EAAI,MAAS,MAAO,GAAG,EAAIA,EAAI,MAC7DC,EAAKA,EAAI,OAAW7D,KAAK+H,KAAKlE,EAAI,MAAS,MAAO,GAAG,EAAIA,EAAI,MAE7D,IAAImE,GAAKrE,EAAI,MAASC,EAAI,MAASC,EAAI,OAAU,OAC7Ce,EAAKjB,EAAI,MAASC,EAAI,MAASC,EAAI,MACnCoE,GAAKtE,EAAI,MAASC,EAAI,MAASC,EAAI,OAAU,QAEjDmE,SAAKA,EAAI,QAAYhI,KAAK+H,IAAIC,EAAG,SAAU,EAAK,MAAQA,EAAK,QAC7DpD,EAAKA,EAAI,QAAY5E,KAAK+H,IAAInD,EAAG,SAAU,EAAK,MAAQA,EAAK,QAC7DqD,EAAKA,EAAI,QAAYjI,KAAK+H,IAAIE,EAAG,SAAU,EAAK,MAAQA,EAAK,QAEtD,CAAE,IAAMrD,EAAK,GAAI,KAAOoD,EAAIpD,GAAI,KAAOA,EAAIqD,EAAE,CACxD,CAEA,6BAOA,SAAqBC,EAAQC,EAAQ,CACjC,IAAMC,EAAO7I,EAAM8I,QAAQ9I,EAAM+I,UAAUJ,CAAM,CAAC,EAC5CK,EAAOhJ,EAAM8I,QAAQ9I,EAAM+I,UAAUH,CAAM,CAAC,EAC5CK,EAAOJ,EAAK,GAAKG,EAAK,GACtBE,EAAOL,EAAK,GAAKG,EAAK,GACtBG,EAAON,EAAK,GAAKG,EAAK,GACtBI,EAAK3I,KAAK4I,KAAKR,EAAK,GAAKA,EAAK,GAAKA,EAAK,GAAKA,EAAK,EAAE,EACpDS,EAAK7I,KAAK4I,KAAKL,EAAK,GAAKA,EAAK,GAAKA,EAAK,GAAKA,EAAK,EAAE,EACpDO,EAAOH,EAAKE,EACdE,EAAON,EAAOA,EAAOC,EAAOA,EAAOI,EAAOA,EAC9CC,EAAOA,EAAO,EAAI,EAAI/I,KAAK4I,KAAKG,CAAI,EACpC,IAAMC,EAAK,EAAM,KAAQL,EACnBM,EAAK,EAAM,KAAQN,EACnBO,EAAWV,EACXW,EAAWL,EAAOE,EAClBI,EAAWL,EAAOE,EAClBI,EAAIH,EAAWA,EAAWC,EAAWA,EAAWC,EAAWA,EACjE,OAAOC,EAAI,EAAI,EAAIA,CACvB,CAKA,sBAKA,SAAcC,EAAK,CACf,IAAI1E,EACA2E,EAAM,GAEV,GAAI,OAAOD,GAAQ,UAAY,OAAOA,GAAQ,SAC1CC,GAAOD,W,EACA,WAAOA,CAAG,IAAK,SACtB,GAAI9G,MAAMgH,QAAQF,CAAG,EACjB,QAASG,EAAI,EAAGA,EAAIH,EAAInG,OAAQsG,IACxBH,EAAIG,KACJ7E,EAAIrF,EAAMmK,OAAOJ,EAAIG,EAAE,EACnB7E,IACA2E,IAAQA,GAAO,KACfA,GAAO3E,QAKnB,SAAW6E,KAAKH,EACRA,EAAIG,KACJF,IAAQA,GAAO,KACfA,GAAOE,GAMvB,OAAOF,CACX,CAKA,oBAIA,UAAe,CAKX,QAJIF,EAAI,EACJM,EACA3B,EACAuB,EAAM,GACHF,EAAIO,UAAUzG,SACZwG,EAAMC,UAAUP,QACZrB,EAAIzI,EAAMmK,OAAOC,CAAG,KACrBJ,IAAQA,GAAO,KACfA,GAAOvB,GAInB,OAAOuB,CACX,CAEA,4BAKA,UAAoC,KAAhBM,EAAY,UAAH,6CAAG,GAC5B,OAAI1Q,OAAO2Q,cAAgB3Q,OAAO2Q,eAAiB,mBACxC3Q,OAAO2Q,aAGXD,KAAyB1Q,OAAO4Q,eAAiB5Q,OAAO6Q,cAAcC,QAAQ,eAAe,GAC/F9Q,OAAO4Q,eAAiB5Q,OAAO6Q,cAAcC,QAAQ,eAAe,EAAI9Q,OAAO+Q,WAAW,8BAA8B,EAAEC,QAAU,OAAS,UACtJ,CAEA,4BAKA,UAAoC,KAAhBN,EAAY,UAAH,6CAAG,GAC5B,OAAI1Q,OAAO2Q,cAAgB3Q,OAAO2Q,eAAiB,mBACxC,SAGXD,EAAYA,IAAc1Q,OAAO4Q,eAAiB5Q,OAAO6Q,cAAcC,QAAQ,eAAe,EACvFJ,IAAc,QAAUA,IAAc,OAAS,OAAS,QACnE,CAEA,4BAIA,SAAoBA,EAAW,CACvB1Q,OAAO2Q,cAAgB3Q,OAAO2Q,eAAiB,sBAGlD3Q,OAAO4Q,eAAiB5Q,OAAO6Q,cAAcI,QAAQ,gBAAiBP,CAAS,GAC/E1Q,OAAO4Q,eAAiB5Q,OAAO6Q,cAAcI,QAAQ,YAAaP,IAAc,QAAUA,IAAc,OAAS,OAAS,OAAO,EACtI,CAEA,2BAKA,SAAmBA,EAAW,CAC1B,GAAI1Q,OAAO2Q,cAAgB3Q,OAAO2Q,eAAiB,mBAC/C,OAAO3Q,OAAO2Q,aAElBD,EAAYA,IAAc1Q,OAAO4Q,eAAiB5Q,OAAO6Q,cAAcC,QAAQ,eAAe,EAG9F,IAAMI,EAAS9K,EAAM+K,cAAc,EAC7BpJ,EAAMmJ,EAAO5G,QAAQoG,CAAS,EAChCU,EACJ,OAAIrJ,IAAQ,GACRqJ,EAAWF,GAAQnJ,EAAM,GAAKmJ,EAAOlH,QAErCoH,EAAWF,EAAO,GAEtB9K,EAAMiL,aAAaD,CAAQ,EAEpBA,CACX,CAEA,6BAIA,UAAuB,CACnB,OAAIpR,OAAO2Q,cAAgB3Q,OAAO2Q,eAAiB,mBACxC,CAAC3Q,OAAO2Q,YAAY,EAGxB,CAAC,QAAS,OAAQ,OAAQ,SAAS,CAC9C,CAEA,0BAKA,SAAkBW,EAAO,CACrBA,GAASA,GAAS,IAAIxJ,SAAS,EAAEtF,QAAQ,MAAO,EAAE,EAElD,IAAM4G,EAAS,CAAC,EAChBkI,SAAM5O,MAAM,GAAG,EAAE6O,QAAQ,SAAAC,EAAQ,CAE7B,GADAA,EAAOA,EAAKtJ,KAAK,EACbsJ,EAAM,CACN,IAAM/O,EAAQ+O,EAAK9O,MAAM,GAAG,EACtB4E,EAAOzE,mBAAmBJ,EAAM,EAAE,EAAEyF,KAAK,EAC/C,GAAIzF,EAAMuH,OAAS,EAEf,GADAZ,EAAO9B,GAAQzE,mBAAmBJ,EAAM,EAAE,EACtC2G,EAAO9B,KAAU,OACjB8B,EAAO9B,GAAQ,WACR8B,EAAO9B,KAAU,QACxB8B,EAAO9B,GAAQ,OACZ,CACH,IAAMmK,EAAI5G,WAAWzB,EAAO9B,EAAK,EAC7BmK,EAAE3J,SAAS,IAAMsB,EAAO9B,KACxB8B,EAAO9B,GAAQmK,EAEvB,MAEArI,EAAO9B,GAAQ,EAEvB,CACJ,CAAC,EACM8B,CACX,CAEA,2BAKA,SAAmBjG,EAAI,CACnB,IAAMuO,GAAKvO,GAAM,IAAI2E,SAAS,EAAEpF,MAAM,GAAG,EACzC,OAAIgP,EAAE1H,OAAS,GACX0H,EAAEC,IAAI,EACCD,EAAE/K,KAAK,GAAG,GAEV,IAEf,CAAC,0BAED,SAAkBiL,EAASzG,EAAY,CAGnC,GAAI,CAACyG,EACD,MAAO,GAGX,IAAI3K,EACA4K,EAAKD,EAAQ3F,SAAS,EAAI,EAC1B4F,EAAK,KACLA,EAAK,IAAMA,GAGf,IAAIC,EAAKF,EAAQ5F,QAAQ,EACrB8F,EAAK,KACLA,EAAK,IAAMA,GAGX3G,IAAe,aACflE,EAAO4K,EAAK,IAAMC,EAAK,IAAMF,EAAQG,YAAY,EAEjD9K,EAAO2K,EAAQG,YAAY,EAAI,IAAMF,EAAK,IAAMC,EAIpD,IAAIE,EAAIJ,EAAQK,SAAS,EACzB,OAAID,EAAI,GACJ/K,GAAQ,KAAO+K,EAEf/K,GAAQ,IAAM+K,EAElBA,EAAIJ,EAAQM,WAAW,EACnBF,EAAI,GACJ/K,GAAQ,KAAO+K,EAEf/K,GAAQ,IAAM+K,EAGlBA,EAAIJ,EAAQO,WAAW,EACnBH,EAAI,GACJ/K,GAAQ,KAAO+K,EAEf/K,GAAQ,IAAM+K,EAGlBA,EAAIJ,EAAQQ,gBAAgB,EACxBJ,EAAI,GACJ/K,GAAQ,MAAQ+K,EACTA,EAAI,IACX/K,GAAQ,KAAO+K,EAEf/K,GAAQ,IAAM+K,EAGX/K,CACX,CAAC,0BAED,SAAkBL,EAAS,CACvB,GAAIA,EAAS,CACTA,EAAUC,KAAKwL,MAAMzL,CAAO,EAC5B,IAAM0L,EAAIzL,KAAKC,MAAMF,GAAW,KAAO,GAAG,EACpC2L,EAAI1L,KAAKC,MAAOF,GAAW,KAAO,IAAO,IAAI,EAC7CyE,EAAIxE,KAAKC,MAAOF,EAAU,KAAQ,EAAE,EACpCkD,EAAIlD,EAAU,GACpB,OAAI0L,EACO,GAAP,OAAUA,EAAC,YAAIC,EAAEzK,SAAS,EAAE2G,SAAS,EAAG,GAAG,EAAC,YAAIpD,EAAEvD,SAAS,EAAE2G,SAAS,EAAG,GAAG,EAAC,YAAI3E,EAAEhC,SAAS,EAAE2G,SAAS,EAAG,GAAG,CAAC,EACvG8D,EACA,GAAP,OAAUA,EAAC,YAAIlH,EAAEvD,SAAS,EAAE2G,SAAS,EAAG,GAAG,EAAC,YAAI3E,EAAEhC,SAAS,EAAE2G,SAAS,EAAG,GAAG,CAAC,EAEtE,KAAP,OAAYpD,EAAEvD,SAAS,EAAE2G,SAAS,EAAG,GAAG,EAAC,YAAI3E,EAAEhC,SAAS,EAAE2G,SAAS,EAAG,GAAG,CAAC,CAElF,KACI,OAAO,SAEf,CAAC,2BAED,SAAmBxH,EAAM,CACrB,IAAMoE,EAAIpE,EAAKmD,MAAM,WAAW,EAChC,OAAIiB,IACApE,EAAOA,EAAKzE,QAAQ6I,EAAE,GAAIA,EAAE,GAAG7I,QAAQ,KAAM,QAAQ,CAAC,GAGnDyE,EAAKzE,QAAQ,sBAAuB,EAAE,EAAE0F,KAAK,EAAE1F,QAAQ,MAAO,EAAE,EAAEkE,YAAY,CACzF,CAAC,wBAED,SAAgB8L,EAAKjG,EAAQ,CAEzBiG,EAAMA,EAAIhQ,QAAQ,8EAA+E,WAAW,EAExG+J,IAAW,OACXvM,OAAOuC,SAAWiQ,EAElBxS,OAAOyS,KAAKD,EAAKjG,GAAU,QAAQ,CAE3C,CAAC,0BAED,SAAkBtF,EAAM,CACpB,MAAqBb,EAAMsM,cAAczL,CAAI,EAAxC0L,EAAI,EAAJA,KAAMC,EAAM,EAANA,OACX,GAAKA,EAAOnG,MAYR,OAAOmG,EAAOnG,MAVdkG,EAAOA,EAAKnQ,QAAQ,WAAY,EAAE,EAClCmQ,EAAOA,EAAKzK,KAAK,EAEjB,QADM2K,EAAQF,EAAKnQ,QAAQ,MAAO,EAAE,EAAEE,MAAM;AAAA,CAAI,EACvCwN,EAAI,EAAGA,EAAI2C,EAAM7I,OAAQkG,IAC9B,GAAI2C,EAAM3C,GAAGjG,WAAW,IAAI,EACxB,OAAO4I,EAAM3C,GAAGzJ,UAAU,CAAC,EAAEyB,KAAK,EAG1C,MAAO,EAIf,CAAC,+BAED,SAAuBjB,EAAM,CACzB,IAAM6L,EAAQ,CAAC,EACf,GAAI7L,EAAKR,UAAU,EAAG,CAAC,IAAM,MAAO,CAChC,IAAMsB,EAAMd,EAAKR,UAAU,CAAC,EAAE6D,QAAQ;AAAA,IAAO,EAC7C,GAAIvC,IAAQ,GAAI,CACZ,IAAMgL,EAAU9L,EAAKR,UAAU,EAAGsB,EAAM,CAAC,EACnC8K,EAAQE,EAAQvQ,QAAQ,MAAO,EAAE,EAAEE,MAAM;AAAA,CAAI,EACnDmQ,EAAMtB,QAAQ,SAAAyB,EAAQ,CAClB,GAAI,EAACA,EAAK9K,KAAK,EAGf,KAAMH,EAAMiL,EAAK1I,QAAQ,GAAG,EAC5B,GAAIvC,IAAQ,GAAI,CACZ,IAAMT,EAAO0L,EAAKvM,UAAU,EAAGsB,CAAG,EAAEG,KAAK,EACzC4K,EAAMxL,GAAQ0L,EAAKvM,UAAUsB,EAAM,CAAC,EAAEG,KAAK,EAC3C4K,EAAMxL,GAAQwL,EAAMxL,GAAM9E,QAAQ,eAAgB,EAAE,EAChDsQ,EAAMxL,KAAU,OAChBwL,EAAMxL,GAAQ,GACPwL,EAAMxL,KAAU,QACvBwL,EAAMxL,GAAQ,GACPuD,WAAWiI,EAAMxL,EAAK,EAAEQ,SAAS,IAAMgL,EAAMxL,KACpDwL,EAAMxL,GAAQuD,WAAWiI,EAAMxL,EAAK,EAE5C,MACIwL,EAAME,EAAK9K,KAAK,GAAK,GAE7B,CAAC,EACDjB,EAAOA,EAAKR,UAAUsB,EAAM,CAAC,CACjC,CACJ,CACA,MAAO,CAAC6K,OAAQE,EAAOH,KAAM1L,CAAI,CACrC,CAAC,+BAED,SAAuBA,EAAM,CACzB,IAAMoE,EAAIpE,EAAKmD,MAAM,kBAAkB,EACvC,OAAIiB,GACAA,EAAEkG,QAAQ,SAAA0B,EAAG,QAAIhM,EAAOA,EAAKzE,QAAQyQ,EAAK,EAAE,CAAC,GAE1ChM,CACX,CAEA,4BAKA,SAAoBiM,EAAUC,EAAM,CAChC,IAAIC,EAAKnT,SAASG,cAAc,GAAG,EACnCgT,EAAG/S,aAAa,OAAQ,uCAAyCgT,mBAAmB1K,KAAKE,UAAUsK,EAAM,KAAM,CAAC,CAAC,CAAC,EAClHC,EAAG/S,aAAa,WAAY6S,CAAQ,EAEpCE,EAAGjT,MAAMmT,QAAU,OACnBrT,SAAS0S,KAAKnS,YAAY4S,CAAE,EAE5BA,EAAGG,MAAM,EAETtT,SAAS0S,KAAKa,YAAYJ,CAAE,CAChC,CAEA,4BAKA,SAAoBK,EAAS,CACzB,IAAMjL,EAASiL,EAAU,WACnBxM,EAAOtB,EAAa8N,GACtBrK,EACJ,OAAInC,EACAmC,EAAS,CAACnC,CAAI,EACPwM,EAAU,EACjBrK,EAAS,CAACzD,EAAa,GAAO,MAAQ8N,EAAW,OAAc3L,SAAS,EAAE,CAAC,EACpE2L,EAAU,EACjBrK,EAAS,CAACzD,EAAa,GAAO,MAAQ8N,EAAW,OAAc3L,SAAS,EAAE,CAAC,EAE3EsB,EAAS,CAAC,KAAOqK,EAAQ3L,SAAS,EAAE,CAAC,EAErCU,GACAY,EAAOiD,KAAK,MAAQ7D,GAAU,IAAIV,SAAS,EAAE,EAAEtB,YAAY,CAAC,EAEzD4C,CACX,CAEA,qBAKA,SAAahE,EAAQ,CACjB,OAAOuD,KAAKC,MAAMD,KAAKE,UAAUzD,CAAM,CAAC,CAC5C,CAEA,yBAKA,SAAiB+C,EAAK,OACduE,EAASvE,GAAG,SAAHA,EAAKX,UAAM,iBAAR,OAAH,EAAakF,OAC1B,GAAIA,GACA,GAAI,OAAOA,GAAW,UAAYA,EAAO,KAAO,IAC5C,GAAI,CACAA,EAAS/D,KAAKC,MAAM8D,CAAM,CAC9B,OAASgH,EAAP,CACE3Q,QAAQC,MAAM,wBAAD,OAAyB0J,CAAM,GAC5CA,EAAS,IACb,SAGA,OAAOA,GAAW,SAAU,CAC5B,IAAMjK,EAAQiK,EAAOhK,MAAM,GAAG,EAC9BgK,EAAS,CAAC,EACV,QAASgF,EAAI,EAAGA,EAAIjP,EAAMuH,OAAQ0H,IAAK,CACnC,IAAM5H,EAAIrH,EAAMiP,GAAGhP,MAAM,GAAG,EAC5BgK,EAAO5C,EAAE,IAAMA,EAAE,EACrB,CACJ,SAAWT,MAAMgH,QAAQ3D,CAAM,EAAG,CAC9B,IAAMtD,EAAS,CAAC,EAChB,OAAIjB,EAAIX,OAAOmM,OAAS,SACpBjH,EAAO6E,QAAQ,SAACqC,EAAO1H,EAAK,CAAF,OAAK9C,EAAO8C,GAAO0H,CAAK,GAElDzL,EAAIX,OAAOmM,OAAS,SACpBjH,EAAO6E,QAAQ,SAAAqC,EAAK,QAAIxK,EAAOwK,GAASA,CAAK,GACtCzL,EAAIX,OAAOmM,OAAS,YAC3BvK,EAAO,MAAWsD,EAAO,GACzBtD,EAAO,KAAUsD,EAAO,IAGrBtD,CACX,EAGJ,OAAOsD,CACX,CAEA,sBAKA,SAAc8F,EAAK,CACf,OAAOqB,MAAMrB,CAAG,EACXsB,KAAK,SAAAC,EAAQ,QAAIA,EAASC,KAAK,CAAC,GAChCF,KAAK,SAAAE,EAAQ,CACV,OAAO,IAAIC,QAAQ,SAAAC,EAAW,CAC1B,IAAMC,EAAS,IAAIC,WACnBD,EAAOE,OAAS,UAAW,CACvBH,EAAQ,KAAK9K,MAAM,CACvB,EACA+K,EAAOG,cAAcN,CAAI,CAC7B,CAAC,CACL,CAAC,CACT,CAEA,8BAKA,SAAsBO,EAAQ,CAC1B,IAAMC,EAAY1P,OAAO2P,KAAK7O,CAAU,EAAE4F,KAAK,SAAA1B,EAAC,QAAIyK,EAAOtK,WAAWH,CAAC,CAAC,GACxE,OAAO0K,EAAY5O,EAAW4O,GAAa,IAC/C,CAAC,U,EAAA,WAzjDCpO,EAAK,YACYZ,CAAS,G,EAAA,WAD1BY,EAAK,YAEY,WAAW,G,EAAA,WAF5BA,EAAK,aAGa,CAAC,KAAM,IAAI,CAAC,G,EAAA,WAH9BA,EAAK,kBAIkB,2qFAAgD,QAwjD9DA,EAAK,W,iCCllDpB,SAASsO,GAAmB,CACxB,IAAMC,EAAY1U,SAAS2U,aAAa,EACxC,GAAI,CAACD,EAAUE,WACX,OAAO,UAAY,CAAC,EAKxB,QAHIC,EAAS7U,SAAS8U,cAEhBC,EAAS,CAAC,EACP9E,EAAI,EAAGA,EAAIyE,EAAUE,WAAY3E,IACtC8E,EAAO3I,KAAKsI,EAAUM,WAAW/E,CAAC,CAAC,EAGvC,OAAQ4E,EAAOI,QAAQ1O,YAAY,EAAG,CAClC,IAAK,QACL,IAAK,WACDsO,EAAOK,KAAK,EACZ,MAEJ,QACIL,EAAS,KACT,KAAM,CAGdH,SAAUS,gBAAgB,EACnB,UAAY,CACfT,EAAUhB,OAAS,SACnBgB,EAAUS,gBAAgB,EAErBT,EAAUE,YACXG,EAAOzD,QAAQ,SAAU8D,EAAO,CAC5BV,EAAUW,SAASD,CAAK,CAC5B,CAAC,EAGLP,GAAUA,EAAOS,MAAM,CAC3B,CACJ,CAIA,IAAMC,EAA4B,CAC9B,aAAc,OACd,YAAa,MACb,QAAW,MACf,EAEMC,EAAiB,mCAEvB,SAASvK,EAAOwK,EAAS,CACrB,IAAMC,GAAW,YAAYC,KAAKC,UAAUC,SAAS,EAAI,SAAM,QAAU,KACzE,OAAOJ,EAAQlT,QAAQ,gBAAiBmT,CAAO,CACnD,CAEA,SAAS7H,EAAK7G,EAAMG,EAAS,CACzB,IAAI2O,EACAC,EACAX,EACAV,EACAsB,EACAC,EAAU,GACT9O,IACDA,EAAU,CAAC,GAEf2O,EAAQ3O,EAAQ2O,OAAS,GACzB,GAAI,CACAC,EAAmBtB,EAAgB,EAEnCW,EAAQpV,SAASkW,YAAY,EAC7BxB,EAAY1U,SAAS2U,aAAa,EAElCqB,EAAOhW,SAASG,cAAc,MAAM,EACpC6V,EAAKG,YAAcnP,EAEnBgP,EAAKI,WAAa,OAElBJ,EAAK9V,MAAMmW,IAAM,QAEjBL,EAAK9V,MAAMiE,SAAW,QACtB6R,EAAK9V,MAAMoB,IAAM,EACjB0U,EAAK9V,MAAMoW,KAAO,mBAElBN,EAAK9V,MAAMqW,WAAa,MAExBP,EAAK9V,MAAMsW,iBAAmB,OAC9BR,EAAK9V,MAAMuW,cAAgB,OAC3BT,EAAK9V,MAAMwW,aAAe,OAC1BV,EAAK9V,MAAMyW,WAAa,OACxBX,EAAK7T,iBAAiB,OAAQ,SAAUU,EAAG,CAEvC,GADAA,EAAE8K,gBAAgB,EACdxG,EAAQ8D,OAER,GADApI,EAAE+K,eAAe,EACb,OAAO/K,EAAE+T,eAAkB,YAAa,CACxCd,GAAShT,QAAQ4L,KAAK,+BAA+B,EACrDoH,GAAShT,QAAQ4L,KAAK,0BAA0B,EAChD3O,OAAO6W,cAAcC,UAAU,EAC/B,IAAI5L,EAASsK,EAA0BpO,EAAQ8D,SAAWsK,EAA0B,QACpFxV,OAAO6W,cAAcE,QAAQ7L,EAAQjE,CAAI,CAC7C,MACInE,EAAE+T,cAAcC,UAAU,EAC1BhU,EAAE+T,cAAcE,QAAQ3P,EAAQ8D,OAAQjE,CAAI,EAGhDG,EAAQ4P,SACRlU,EAAE+K,eAAe,EACjBzG,EAAQ4P,OAAOlU,EAAE+T,aAAa,EAEtC,CAAC,EAED5W,SAAS0S,KAAKnS,YAAYyV,CAAI,EAE9BZ,EAAM4B,mBAAmBhB,CAAI,EAC7BtB,EAAUW,SAASD,CAAK,EAExB,IAAM6B,EAAajX,SAASkX,YAAY,MAAM,EAC9C,GAAI,CAACD,EACD,MAAM,IAAIE,MAAM,+BAA+B,EAEnDlB,EAAU,EACd,OAASmB,EAAP,CACEtB,GAAShT,QAAQC,MAAM,qCAAsCqU,CAAG,EAChEtB,GAAShT,QAAQ4L,KAAK,0BAA0B,EAChD,GAAI,CACA3O,OAAO6W,cAAcE,QAAQ3P,EAAQ8D,QAAU,OAAQjE,CAAI,EAC3DG,EAAQ4P,QAAU5P,EAAQ4P,OAAOhX,OAAO6W,aAAa,EACrDX,EAAU,EACd,OAASmB,EAAP,CACEtB,GAAShT,QAAQC,MAAM,uCAAwCqU,CAAG,EAClEtB,GAAShT,QAAQC,MAAM,wBAAwB,EAC/C,IAAI0S,EAAUxK,EAAO,YAAa9D,EAAUA,EAAQsO,QAAUD,CAAc,EAC5EzV,OAAOsX,OAAO5B,EAASzO,CAAI,CAC/B,CACJ,QAAE,CACM0N,IACI,OAAOA,EAAU4C,aAAgB,WACjC5C,EAAU4C,YAAYlC,CAAK,EAE3BV,EAAUS,gBAAgB,GAI9Ba,GACAhW,SAAS0S,KAAKa,YAAYyC,CAAI,EAElCD,EAAiB,CACrB,CAEA,OAAOE,CACX,CAEAsB,EAAOC,QAAU3J,C,gMCrKjB,aACA,cACA,cAEA,cACA,cACA,cACA,cACA,cACA,cACA,cACA,cAEA,cACA,cAEA,cAA2B,iD,EAAA,6B,EAAA,sG,EAAA,sQAE3B,IAAMxK,EAAS,CACXoU,SAAU,CACNC,SAAU,EACd,EACAC,aAAc,CACVC,UAAW,EACf,CACJ,EAeMC,EAAa,a,EAAA,2BACf,WAAY/X,EAAO,OAGf,I,EAHe,mBACf,cAAMA,CAAK,EAEP,CAAC,EAAKA,MAAMgY,YAAc,EAAKhY,MAAMiY,wBACrC,MAAM,IAAIZ,MAAM,qDAAqD,EAEzE,IAAIM,EAAW,GAEf,OAAI,EAAK3X,MAAMiY,0BACXN,EAAW9M,UAAU5K,OAAO4Q,eAAiB5Q,OAAO6Q,cAAcC,QAAQ,EAAK/Q,MAAMgY,UAAU,EAAG,EAAE,GAAK,EAEpGL,EAEM/L,KAAKP,IAAI,EAAIsM,KACnB1X,OAAO4Q,eAAiB5Q,OAAO6Q,cAAcoH,WAAW,EAAKlY,MAAMgY,UAAU,EAC9EL,EAAW,IAHXA,EAAW,IAOnB,EAAKQ,MAAQ,CACTR,UACJ,EAAE,CACN,CAAC,O,EAAA,oCAED,UAAW,CACH,KAAKQ,MAAMR,WACV1X,OAAO4Q,eAAiB5Q,OAAO6Q,cAAcI,QAAQ,KAAKlR,MAAMgY,WAAYpM,KAAKP,IAAI,EAAI,KAAKrL,MAAMiY,wBAA0B,GAAK,EAExI,KAAKjY,MAAMmF,SAAW,KAAKnF,MAAMmF,QAAQ,EAAI,CACjD,CAAC,4BAED,UAAe,CACX,KAAKnF,MAAMmF,SAAW,KAAKnF,MAAMmF,QAAQ,EAAK,CAClD,CAAC,sBAED,UAAS,YACL,OAAI,OAAO,KAAKgT,MAAMR,UAAa,UAC/BS,WAAW,kBAAM,EAAKpY,MAAMmF,SAAW,EAAKnF,MAAMmF,QAAQ,EAAI,CAAC,EAAE,GAAG,EAC7D,MAGJ,wBAAC,UAAM,CACV,KAAM,GACN,SAAS,KACT,UAAW,KAAKnF,MAAMqY,YAActX,OAAY,KAAKf,MAAMqY,UAAY,GACvE,QAAS,SAACC,EAAOC,EAAW,CACpBA,IAAW,iBAAmBA,IAAW,iBACzC,EAAKC,aAAa,CAE1B,EACA,kBAAgB,4BAChB,mBAAiB,iCAAiC,EAElD,wBAAC,UAAW,CAAC,GAAG,2BAA2B,EAAE,KAAKxY,MAAM0M,OAAS7H,UAAKC,EAAE,kBAAkB,CAAC,EAC3F,wBAAC,UAAa,KACV,wBAAC,UAAiB,CAAC,GAAG,iCAAiC,EAClD,KAAK9E,MAAM6J,MAAQ,KACnB,KAAK7J,MAAMkH,KACX,KAAKlH,MAAMiY,wBAA0B,mCAAQ,KAC7C,KAAKjY,MAAMiY,wBACR,wBAAC,UAAgB,CACb,QAAS,CAACQ,MAAO,KAAKzY,MAAM4E,QAAQ+S,SAAUe,KAAM,KAAK1Y,MAAM4E,QAAQiT,YAAY,EACnF,QAAS,wBAAC,UAAQ,CAAC,QAAS,CAAC,CAAC,KAAKM,MAAMR,SAAU,SAAU,kBAAM,EAAKgB,SAAS,CAAChB,SAAU,CAAC,EAAKQ,MAAMR,QAAQ,CAAC,CAAC,CAAC,GACnH,MAAO,KAAK3X,MAAM4Y,cAAgB/T,UAAKC,EAAE,2CAA4C,KAAK9E,MAAMiY,uBAAuB,CAAE,GAE7H,IAAI,CACQ,EAExB,wBAAC,UAAa,KACV,wBAAC,UAAM,CAAC,QAAQ,YAAY,QAAS,kBAAM,EAAKY,SAAS,CAAC,EAAE,MAAM,UAAU,UAAS,GAAC,UAAW,wBAAC,UAAS,KAAI,EAAE,KAAK7Y,MAAM8Y,IAAMjU,UAAKC,EAAE,OAAO,CAAC,EACjJ,wBAAC,UAAM,CAAC,QAAQ,YAAY,QAAS,kBAAM,EAAK0T,aAAa,CAAC,EAAE,MAAM,OAAO,UAAW,wBAAC,UAAS,KAAI,EAAE,KAAKxY,MAAM+Y,QAAUlU,UAAKC,EAAE,WAAW,CAAC,CAAU,CAC9I,CAExB,CAAC,OA1EuBpD,UAAMC,SAAS,EA6E3CoW,EAAcnW,UAAY,CACtBuD,QAAStD,UAAU0D,KAAKD,WACxB+S,UAAWxW,UAAUuD,KACrBsH,MAAO7K,UAAUE,OACjBmF,KAAMrF,UAAUE,OAChB+W,GAAIjX,UAAUE,OACdgX,OAAQlX,UAAUE,OAClB8H,KAAMhI,UAAUwD,OAChB4S,wBAAyBpW,UAAUC,OACnC8W,aAAc/W,UAAUE,OACxBiW,WAAYnW,UAAUE,MAC1B,EAEA,IAAMC,G,EAAUwD,WAAWjC,CAAM,EAAEwU,CAAa,EAAE,EACnC/V,EAAO,W,gMCpItB,aACA,cACA,cAEA,cACA,cACA,cACA,cACA,cACA,cAEA,cAEA,cAA2B,iD,EAAA,6B,EAAA,sG,EAAA,sQAE3B,IAAMuB,EAAS,SAAA5C,EAAK,OAAK,CACrBqY,gBAAiB,CAEjB,EACAC,WAAY,CAEZ,CACJ,CAAC,EAWKC,EAAW,a,EAAA,+C,EAAA,kD,EAAA,oCACb,UAAW,CACP,KAAKlZ,MAAMmF,SAAW,KAAKnF,MAAMmF,QAAQ,CAC7C,CAAC,sBAED,UAAS,YACL,OAAO,wBAAC,UAAM,CACV,KAAM,GACN,SAAS,KACT,UAAW,KAAKnF,MAAMqY,YAActX,OAAY,KAAKf,MAAMqY,UAAY,GACvE,QAAS,kBAAM,EAAKQ,SAAS,CAAC,EAC9B,kBAAgB,qBAChB,mBAAiB,0BAA0B,EAE3C,wBAAC,UAAW,CAAC,UAAW,KAAK7Y,MAAM4E,QAAQoU,gBAC9B,QAAS,CAACN,KAAM,KAAK1Y,MAAM4E,QAAQqU,UAAU,EAC7C,GAAG,oBAAoB,EAAE,KAAKjZ,MAAM0M,OAAS7H,UAAKC,EAAE,UAAU,CAAC,EAC5E,wBAAC,UAAa,KACV,wBAAC,UAAiB,CAAC,GAAG,0BAA0B,EAC3C,KAAK9E,MAAMkH,MAAQrC,UAAKC,EAAE,mBAAmB,CAAC,CAC/B,EAExB,wBAAC,UAAa,KACV,wBAAC,UAAM,CAAC,QAAQ,YAAY,QAAS,kBAAM,EAAK+T,SAAS,CAAC,EAAE,MAAM,UAAU,UAAS,GAAC,UAAW,wBAAC,UAAS,KAAI,EAAEhU,UAAKC,EAAE,OAAO,CAAC,CAAU,CAC9H,CAExB,CAAC,OA1BqBpD,UAAMC,SAAS,EA6BzCuX,EAAYtX,UAAY,CACpBuD,QAAStD,UAAU0D,KAAKD,WACxB+S,UAAWxW,UAAUuD,KACrBsH,MAAO7K,UAAUE,OACjBmF,KAAMrF,UAAUsX,UAAU,CACtBtX,UAAUE,OACVF,UAAUuX,OAAO,CACpB,EACDvP,KAAMhI,UAAUwD,MACpB,EAGA,IAAMrD,G,EAAUwD,WAAWjC,CAAM,EAAE2V,CAAW,EAAE,EACjClX,EAAO,W,qGC9EtB,SAASqX,GAAc,CACnB,IAAM9B,EAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EASfvU,QAAQsW,IAAI/B,CAAM,EAClBvU,QAAQsW,IAAI,kJAAkJ,EAC9JtW,QAAQsW,IAAI,qDAAqD,EACjEtW,QAAQsW,IAAI,YAAY,CAC5B,CAAC,MAEcD,EAAW,W,uGCpB1B,cAEA,WAEME,GAAQ,GAAK,GAAK,GAAK,IAO7B,SAASC,EAAMhL,EAAK,CAChB,IAAM5D,EAAM,CACRH,EAAG,EACHC,EAAG,EACHC,EAAG,CACP,EAEA,GAAI6D,EAAIvE,SAAW,EACfW,EAAIH,EAAII,SAAS2D,EAAIiL,OAAO,EAAG,CAAC,EAAG,EAAE,EACrC7O,EAAIF,EAAIG,SAAS2D,EAAIiL,OAAO,EAAG,CAAC,EAAG,EAAE,EACrC7O,EAAID,EAAIE,SAAS2D,EAAIiL,OAAO,EAAG,CAAC,EAAG,EAAE,UAC9BjL,EAAIvE,SAAW,EAAG,CACzB,IAAMQ,EAAI+D,EAAIiL,OAAO,EAAG,CAAC,EACnB/O,EAAI8D,EAAIiL,OAAO,EAAG,CAAC,EACnB9O,EAAI6D,EAAIiL,OAAO,EAAG,CAAC,EAEzB7O,EAAIH,EAAII,SAASJ,EAAIA,EAAG,EAAE,EAC1BG,EAAIF,EAAIG,SAASH,EAAIA,EAAG,EAAE,EAC1BE,EAAID,EAAIE,SAASF,EAAIA,EAAG,EAAE,CAC9B,CAEA,OAAOC,CACX,CAOA,SAAS8O,EAAMC,EAAK,CAChB,MAAO,IAAP,OAAW7S,KAAKwL,MAAMqH,EAAIlP,CAAC,EAAE1C,SAAS,EAAE,CAAC,SAAGjB,KAAKwL,MAAMqH,EAAIjP,CAAC,EAAE3C,SAAS,EAAE,CAAC,SAAGjB,KAAKwL,MAAMqH,EAAIhP,CAAC,EAAE5C,SAAS,EAAE,CAAC,CAC/G,CAQA,SAAS6R,EAAa9P,EAAO+P,EAAcC,EAAW,CAClD,IAAMlP,EAAM4O,EAAM1P,CAAK,EACjBiQ,EAAUP,EAAMK,CAAY,EAElCjP,SAAIH,GAAKsP,EAAQtP,GAAK,IAAO8O,GAAQO,EAAY,IACjDlP,EAAIF,GAAKqP,EAAQrP,GAAK,IAAO6O,GAAQO,EAAY,IACjDlP,EAAID,GAAKoP,EAAQpP,GAAK,IAAO4O,GAAQO,EAAY,IAE1CJ,EAAM9O,CAAG,CACpB,CAQA,SAASoP,EAAclQ,EAAOiQ,EAAS,CAInC,QAFME,EAAa,CAAC,EAEX9J,EAAI,EAAGA,GAAK,GAAIA,IACrB8J,EAAW,YAAD,OAAa9J,CAAC,GAAM,CAC1BnP,gBAAiB4Y,EAAa9P,EAAOiQ,EAAS5J,CAAC,CACnD,EAGJ,OAAO8J,CACX,CAEA,IAAMC,EAAiB,SAAAvZ,EAAK,OAAK,CAC7BwZ,QAAS,CAELC,KAAM,CACFC,KAAMD,OAAK,KACXE,KAAMF,OAAK,IACf,CACJ,CACJ,CAAC,EAEKG,EAAe,SAAA5Z,EAAK,OAAK,CAC3B6Z,WAAY,CACRC,UAAW,CACPC,SAAU,CACN,CACI1a,MAAO,CAAC2a,QAAS,YAAa7Q,MAAO,MAAM,EAC3C1J,MAAO,CACH0J,MAAOnJ,EAAMwZ,QAAQS,gBAAgBja,EAAMwZ,QAAQC,KAAK,IAAI,CAChE,CACJ,EACA,CACIpa,MAAO,CAAC2a,QAAS,WAAY7Q,MAAO,MAAM,EAC1C1J,MAAO,CACH0J,MAAOnJ,EAAMwZ,QAAQjT,KAAK2T,QAC1BC,YACIna,EAAMwZ,QAAQY,OAAS,QACjB,sBACA,4BACV,iBAAkB,CACdtW,OAAQ,aAAF,OAAe9D,EAAMwZ,QAAQa,OAAOC,kBAAkB,CAChE,EACA,UAAW,CACPH,YACIna,EAAMwZ,QAAQY,OAAS,QACjB,sBACA,4BACV/Z,iB,EAAiBka,SACbva,EAAMwZ,QAAQjT,KAAK2T,QACnBla,EAAMwZ,QAAQa,OAAOG,YAAY,CAEzC,CACJ,CACJ,EACA,CACInb,MAAO,CAAC8J,MAAO,OAAQ6Q,QAAS,MAAM,EACtCva,MAAO,CACH0J,MAAO,QACP,UAAW,CACP9I,iB,EAAiBka,SACbva,EAAMwZ,QAAQjT,KAAK2T,QACnBla,EAAMwZ,QAAQa,OAAOG,YAAY,CAEzC,CACJ,CACJ,CAAC,CAET,CACJ,CACJ,CAAC,EAOKC,EAAQ,SAAAxH,EAAQ,CAClB,IAAIjT,EACJ,OAAIiT,IAAS,OACTjT,EAAQ,CACJ2F,KAAMsN,EACNuG,QAAS,CACLY,KAAM,OACNzW,WAAY,CACR+W,MAAO,UACP,QAAS,SACb,EACAR,QAAS,CACLR,KAAM,SACV,EACAiB,UAAW,CACPjB,KAAM,SACV,EACAkB,OAAQ,UACRrU,KAAM,CACF2T,QAAS,UACTS,UAAW,SACf,CACJ,EACAE,UAAW,CACPC,UAAW,CACPC,aAAc,CACV1a,gBAAiB,SACrB,CACJ,EACA2a,QAAS,CACLjD,KAAM,CACFkD,cAAe,YACfC,WAAY,iBACZ/R,MAAOgS,SAAO,KACd,UAAW,CACPhS,MAAOgS,SAAO,IAClB,CACJ,CACJ,EACAC,SAAU/B,EAAc,UAAW,MAAM,CAC7C,CACJ,EACOpG,IAAS,OAChBjT,EAAQ,CACJ2F,KAAMsN,EACNuG,QAAS,CACLY,KAAM,OACNzW,WAAY,CACR+W,MAAO,UACP,QAAS,SACb,EACAR,QAAS,CACLR,KAAM,SACV,EACAiB,UAAW,CACPjB,KAAM,SACV,EACAkB,OAAQ,UACRrU,KAAM,CACF2T,QAAS,UACTS,UAAW,SACf,CACJ,EACAE,UAAW,CACPC,UAAW,CACPC,aAAc,CACV1a,gBAAiB,SACrB,CACJ,EACA2a,QAAS,CACLjD,KAAM,CACFkD,cAAe,YACfC,WAAY,iBACZ/R,MAAOgS,SAAO,KACd,UAAW,CACPhS,MAAOgS,SAAO,IAClB,CACJ,CACJ,EACAC,SAAU/B,EAAc,UAAW,MAAM,CAC7C,CACJ,EACOpG,IAAS,UAChBjT,EAAQ,CACJ2F,KAAMsN,EACNuG,QAAS,CACLY,KAAM,QACNF,QAAS,CACLR,KAAM,SACV,EACAiB,UAAW,CACPjB,KAAM,SACV,EACAkB,OAAQ,SACZ,EACAC,UAAW,CACPC,UAAW,CACPC,aAAc,CACV1a,gBAAiB,SACrB,CACJ,EACA2a,QAAS,CACLjD,KAAM,CACFkD,cAAe,YACfC,WAAY,iBACZ/R,MAAOgS,SAAO,KACd,UAAW,CACPhS,MAAOgS,SAAO,IAClB,CACJ,CACJ,CACJ,CACJ,EACOlI,IAAS,KAChBjT,EAAQ,CACJ2F,KAAMsN,EACNuG,QAAS,CACLY,KAAM,QACNF,QAAS,CACLR,KAAM,SACV,EACAiB,UAAW,CACPjB,KAAM,SACV,EACAkB,OAAQ,SACZ,EACAC,UAAW,CACPC,UAAW,CACPC,aAAc,CACV1a,gBAAiB,SACrB,CACJ,EACA2a,QAAS,CACLjD,KAAM,CACFkD,cAAe,YACfC,WAAY,iBACZ/R,MAAOgS,SAAO,KACd,UAAW,CACPhS,MAAOgS,SAAO,IAClB,CACJ,CACJ,CACJ,CACJ,EACOlI,IAAS,KAChBjT,EAAQ,CACJ2F,KAAMsN,EACNuG,QAAS,CACLY,KAAM,QACNF,QAAS,CACLR,KAAM,SACV,EACAiB,UAAW,CACPjB,KAAM,SACV,EACAkB,OAAQ,UACRrU,KAAM,CACF2T,QAAS,UACTS,UAAW,UACXU,SAAU,WACd,CACJ,EACAR,UAAW,CACPC,UAAW,CACPC,aAAc,CACV1a,gBAAiB,SACrB,CACJ,EACA2a,QAAS,CACLjD,KAAM,CACFkD,cAAe,YACfC,WAAY,iBACZ/R,MAAOgS,SAAO,KACd,UAAW,CACPhS,MAAOgS,SAAO,IAClB,CACJ,CACJ,CACJ,CACJ,EAEAnb,EAAQ,CACJ2F,KAAMsN,EACNuG,QAAS,CACLY,KAAM,QACNF,QAAS,CACLR,KAAM,SACV,EACAiB,UAAW,CACPjB,KAAM,SACV,EACAkB,OAAQ,SACZ,EACAC,UAAW,CACPG,QAAS,CACLjD,KAAM,CACFkD,cAAe,YACfC,WAAY,iBACZ/R,MAAOgS,SAAO,KACd,UAAW,CACPhS,MAAOgS,SAAO,IAClB,CACJ,CACJ,CACJ,CACJ,EAGJnb,EAAMsb,QAAU,CACZ5a,OAAQ,EACZ,EAGAV,EAAMsD,YAAc,CAChBK,WAAY3D,EAAMwZ,QAAQU,QAAQR,KAClCnW,OAAQ,CACJF,aAAc,EACd3C,OAAQ,EACZ,CACJ,EAEAV,EAAMwZ,QAAQC,KAAO,CACjBC,KAAMD,OAAK,KACXE,KAAMF,OAAK,IACf,EAEAzZ,G,EAAQub,gB,EAAYC,gBAAaxb,CAAK,CAAC,G,EAEhCub,eAAYvb,EAAO,CACtB6Z,WAAY,CACRC,UAAW,CACPC,SAAU,CACN,CACI1a,MAAO,CAAC2a,QAAS,YAAa7Q,MAAO,MAAM,EAC3C1J,MAAO,CACH0J,MAAOnJ,EAAMwZ,QAAQS,gBAAgBja,EAAMwZ,QAAQC,KAAK,IAAI,CAChE,CACJ,EACA,CACIpa,MAAO,CAAC2a,QAAS,WAAY7Q,MAAO,MAAM,EAC1C1J,MAAO,CACH0J,MAAOnJ,EAAMwZ,QAAQjT,KAAK2T,QAC1BC,YACIna,EAAMwZ,QAAQY,OAAS,QACjB,sBACA,4BACV,iBAAkB,CACdtW,OAAQ,aAAF,OAAe9D,EAAMwZ,QAAQa,OAAOC,kBAAkB,CAChE,EACA,UAAW,CACPH,YACIna,EAAMwZ,QAAQY,OAAS,QACjB,sBACA,4BACV/Z,iB,EAAiBka,SACbva,EAAMwZ,QAAQjT,KAAK2T,QACnBla,EAAMwZ,QAAQa,OAAOG,YAAY,CAEzC,CACJ,CACJ,EACA,CACInb,MAAO,CAAC2a,QAAS,OAAQ7Q,MAAO,MAAM,EACtC1J,MAAO,CACH0J,MAAOnJ,EAAMwZ,QAAQjT,KAAK2T,QAC1B,UAAW,CACP7Z,iB,EAAiBka,SACbva,EAAMwZ,QAAQjT,KAAK2T,QACnBla,EAAMwZ,QAAQa,OAAOG,YAAY,CAEzC,CACJ,CACJ,CAAC,CAET,CACJ,CACJ,CAAC,CACL,EAAE,EAEaC,EAAK,W,kLC9ZdvW,EAAI,yB,EAAA,0B,EAAA,4CAyBN,SAAmBuX,EAAM,CACjBA,IACAvX,EAAKuX,KAAOA,EAEpB,CAEC,kCAQA,SAA0BC,EAAOD,EAAM,CAEnC,GAAIC,EAAMlS,OACN,GAAI,OAAOkS,EAAMlS,QAAW,SAAU,CAClC,IAAMA,EAASkS,EAAMlS,OACrB,OAAOkS,EAAMlS,OACbpF,OAAO2P,KAAK2H,CAAK,EAAE7K,QAAQ,SAAA4K,EAAQ,CAC/B,IAAME,EAAS,CAAC,EAChBvX,OAAO2P,KAAK2H,EAAMD,EAAK,EAAE5K,QAAQ,SAAAhL,EAAQ,CACjC,CAACA,IAGAA,EAAK0D,WAAWC,CAAM,EAGvBmS,EAAO9V,GAAQ6V,EAAMD,GAAM5V,GAF3B8V,EAAO,GAAD,OAAInS,CAAM,SAAG3D,CAAI,GAAM6V,EAAMD,GAAM5V,GAIjD,CAAC,EACD6V,EAAMD,GAAQE,CAClB,CAAC,CACL,MACItZ,QAAQ4L,KAAK,sDAAsD,EAI3E,GAAI,CACKwN,GAqBIvX,EAAK0X,aAAaH,IACnBpZ,QAAQ4L,KAAK,0BAAD,OAA2BwN,CAAI,GAE/CvX,EAAK0X,aAAaH,GAAQvX,EAAK0X,aAAaH,IAAS,CAAC,EACtDrX,OAAO2P,KAAK2H,CAAK,EACZ7K,QAAQ,SAAAhL,EAAQ,CACR3B,EAAK0X,aAAaH,GAAM5V,GAElB3B,EAAK0X,aAAaH,GAAM5V,KAAU6V,EAAM7V,IAC/CxD,QAAQ4L,KAAK,yBAAD,OAA0BpI,EAAI,iBAAS4V,EAAI,sCAA8BvX,EAAK0X,aAAaH,GAAM5V,GAAK,oBAAY6V,EAAM7V,EAAK,GAFzI3B,EAAK0X,aAAaH,GAAM5V,GAAQ6V,EAAM7V,EAI9C,CAAC,GA/BD6V,EAAM1U,IAAM0U,EAAMxU,IAAMwU,EAAMvU,GAC9B/C,OAAO2P,KAAK2H,CAAK,EAAE7K,QAAQ,SAAA4K,EAAQ,CAC/BvX,EAAK0X,aAAaH,GAAQvX,EAAK0X,aAAaH,IAAS,CAAC,EACtDrX,OAAOC,OAAOH,EAAK0X,aAAaH,GAAOC,EAAMD,EAAK,CACtD,CAAC,EAEDrX,OAAO2P,KAAK2H,CAAK,EAAE7K,QAAQ,SAAAhL,EAAQ,CAC/BzB,OAAO2P,KAAK2H,EAAM7V,EAAK,EAAEgL,QAAQ,SAAA4K,EAAQ,CAChCvX,EAAK0X,aAAaH,IACnBpZ,QAAQ4L,KAAK,0BAAD,OAA2BwN,CAAI,GAE1CvX,EAAK0X,aAAaH,GAAM5V,GAElB3B,EAAK0X,aAAaH,GAAM5V,KAAU6V,EAAM7V,GAAM4V,IACrDpZ,QAAQ4L,KAAK,yBAAD,OAA0BpI,EAAI,iBAAS4V,EAAI,sCAA8BvX,EAAK0X,aAAaH,GAAM5V,GAAK,oBAAY6V,EAAM7V,GAAM4V,EAAK,GAF/IvX,EAAK0X,aAAaH,GAAM5V,GAAQ6V,EAAM7V,GAAM4V,EAIpD,CAAC,CACL,CAAC,CAgBb,OAASrZ,EAAP,CACEC,QAAQC,MAAM,8BAAD,OAA+BF,CAAC,EACjD,CACL,CAEA,+BAIA,SAAuBwZ,EAAc,CAC7BA,IACA1X,EAAK0X,aAAeA,EAE5B,CAEA,2BAIA,UAAqB,CACjB,OAAO1X,EAAKuX,IAChB,CAEA,iBAKA,SAAS5V,EAAe,CACpB,IAAIgW,EAAc3X,EAAK0X,aAAa1X,EAAKuX,MACzC,GAAII,EAAa,CACb,IAAMC,EAAID,EAAYhW,GACtB,GAAIiW,EACAjW,EAAOiW,UAEF5X,EAAK6X,oBAAoBC,SAASnW,CAAI,IACvC3B,EAAK6X,oBAAoBpQ,KAAK9F,CAAI,EAClC,CAAC3B,EAAK+X,iBAAmB5Z,QAAQsW,IAAI,cAAD,OAAe9S,CAAI,IAGvD3B,EAAKuX,OAAS,MAAQvX,EAAK0X,aAAa5U,GAAI,CAC5C,IAAMkV,EAAShY,EAAK0X,aAAa5U,GAAGnB,GAChCqW,IACArW,EAAOqW,EAEf,CAER,CAAC,2BAnBaC,EAAI,iCAAJA,EAAI,kBAoBlB,cAAkBA,EAAI,eAAE,CAAnB,IAAMzZ,EAAG,KACVmD,EAAOA,EAAK/D,QAAQ,KAAMY,CAAG,CACjC,CACA,OAAOmD,CACX,CAEC,wBAKA,SAAgBD,EAAQ,CAKpB,IAAM8C,EAAS,CAAC,EACZ9C,EAKM,OAAOA,GAAW,UACzB1B,EAAK6X,oBAAoBlL,QAAQ,SAAAhL,EAAQ,CACjCA,EAAK0D,WAAW3D,CAAM,IACtB8C,EAAO7C,GAAQA,EAAK/D,QAAQ8D,EAAQ,EAAE,EAE9C,CAAC,EACDvD,QAAQsW,IAAI1Q,KAAKE,UAAUO,EAAQ,KAAM,CAAC,CAAC,I,EACpC,WAAO9C,CAAM,IAAK,WACzB1B,EAAK6X,oBAAoBlL,QAAQ,SAAAhL,EAAQ,CACjCD,EAAOsP,KAAKrP,CAAI,IAChB6C,EAAO7C,GAAQA,EAEvB,CAAC,EACDxD,QAAQsW,IAAI1Q,KAAKE,UAAUO,EAAQ,KAAM,CAAC,CAAC,IAjB3CxE,EAAK6X,oBAAoBlL,QAAQ,SAAAhL,EAAQ,CACrC6C,EAAO7C,GAAQA,CACnB,CAAC,EACDxD,QAAQsW,IAAI1Q,KAAKE,UAAUO,EAAQ,KAAM,CAAC,CAAC,EAgBnD,CAEC,8BAKD,SAAsB0T,EAAS,CAC3BlY,EAAK+X,gBAAkB,CAAC,CAACG,CAC7B,CAAC,U,EAGL,WApMMlY,EAAI,eAKgB,CAAC,CAAC,G,EAAA,WALtBA,EAAI,sBAWwB,CAAC,CAAC,G,EAAA,WAX9BA,EAAI,OAiBQ5E,OAAOyH,SAAW,IAAI,G,EAAA,WAjBlC7C,EAAI,kBAmBmB,EAAK,EAkLlC5E,OAAO+c,SAAWnY,EAAKmY,SACvB/c,OAAOgd,mBAAqBpY,EAAKqY,eAGjC,MAQerY,EAAI,W,qCCzNnB,IAAIsY,EAAyB,EAAQ,KAA8C,EACnF,OAAO,eAAezF,EAAS,aAAc,CAC3C,MAAO,EACT,CAAE,EACFA,EAAA,QAAkB,OAClB,IAAI0F,EAAiBD,EAAuB,EAAQ,KAAuB,CAAC,EACxEE,EAAc,EAAQ,KAAmB,EACzCC,G,EAAeF,EAAe,U,EAA2BC,EAAY,KAAK,OAAQ,CACpF,EAAG,mDACL,CAAC,EAAG,OAAO,EACX3F,EAAA,QAAkB4F,C,qCCVlB,IAAIH,EAAyB,EAAQ,KAA8C,EACnF,OAAO,eAAezF,EAAS,aAAc,CAC3C,MAAO,EACT,CAAE,EACFA,EAAA,QAAkB,OAClB,IAAI0F,EAAiBD,EAAuB,EAAQ,KAAuB,CAAC,EACxEE,EAAc,EAAQ,KAAmB,EACzCC,G,EAAeF,EAAe,U,EAA2BC,EAAY,KAAK,OAAQ,CACpF,EAAG,uGACL,CAAC,EAAG,OAAO,EACX3F,EAAA,QAAkB4F,C,qCCVlB,IAAIH,EAAyB,EAAQ,KAA8C,EACnF,OAAO,eAAezF,EAAS,aAAc,CAC3C,MAAO,EACT,CAAE,EACFA,EAAA,QAAkB,OAClB,IAAI0F,EAAiBD,EAAuB,EAAQ,KAAuB,CAAC,EACxEE,EAAc,EAAQ,KAAmB,EACzCC,G,EAAeF,EAAe,U,EAA2BC,EAAY,KAAK,OAAQ,CACpF,EAAG,gJACL,CAAC,EAAG,MAAM,EACV3F,EAAA,QAAkB4F,C,qCCVlB,OAAO,eAAe5F,EAAS,aAAc,CAC3C,MAAO,EACT,CAAE,EACF,OAAO,eAAeA,EAAS,UAAW,CACxC,WAAY,GACZ,IAAK,UAAY,CACf,OAAO6F,EAAO,aAChB,CACF,CAAE,EACF,IAAIA,EAAS,EAAQ,IAAqB,C,sHCX1C,SAASC,EAAkBC,EAAKC,EAAK,EAC/BA,GAAO,MAAQA,EAAMD,EAAI,UAAQC,EAAMD,EAAI,QAE/C,QAAStN,EAAI,EAAGwN,EAAO,IAAI,MAAMD,CAAG,EAAGvN,EAAIuN,EAAKvN,IAC9CwN,EAAKxN,GAAKsN,EAAItN,GAGhB,OAAOwN,CACT,CAEAlG,EAAO,QAAU+F,EAAmB/F,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBCVzG,SAASmG,EAAgBH,EAAK,CAC5B,GAAI,MAAM,QAAQA,CAAG,EAAG,OAAOA,CACjC,CAEAhG,EAAO,QAAUmG,EAAiBnG,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBCJvG,SAASoG,EAAuBha,EAAM,CACpC,GAAIA,IAAS,OACX,MAAM,IAAI,eAAe,2DAA2D,EAGtF,OAAOA,CACT,CAEA4T,EAAO,QAAUoG,EAAwBpG,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBCR9G,SAASqG,EAAgBC,EAAUC,EAAa,CAC9C,GAAI,EAAED,aAAoBC,GACxB,MAAM,IAAI,UAAU,mCAAmC,CAE3D,CAEAvG,EAAO,QAAUqG,EAAiBrG,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBCNvG,SAASwG,EAAkBzR,EAAQxM,EAAO,CACxC,QAASmQ,EAAI,EAAGA,EAAInQ,EAAM,OAAQmQ,IAAK,CACrC,IAAI+N,EAAale,EAAMmQ,GACvB+N,EAAW,WAAaA,EAAW,YAAc,GACjDA,EAAW,aAAe,GACtB,UAAWA,IAAYA,EAAW,SAAW,IACjD,OAAO,eAAe1R,EAAQ0R,EAAW,IAAKA,CAAU,CAC1D,CACF,CAEA,SAASC,EAAaH,EAAaI,EAAYC,EAAa,CAC1D,OAAID,GAAYH,EAAkBD,EAAY,UAAWI,CAAU,EAC/DC,GAAaJ,EAAkBD,EAAaK,CAAW,EAC3D,OAAO,eAAeL,EAAa,YAAa,CAC9C,SAAU,EACZ,CAAC,EACMA,CACT,CAEAvG,EAAO,QAAU0G,EAAc1G,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBCnBpG,SAAS6G,EAAgBlW,EAAK+D,EAAK0H,EAAO,CACxC,OAAI1H,KAAO/D,EACT,OAAO,eAAeA,EAAK+D,EAAK,CAC9B,MAAO0H,EACP,WAAY,GACZ,aAAc,GACd,SAAU,EACZ,CAAC,EAEDzL,EAAI+D,GAAO0H,EAGNzL,CACT,CAEAqP,EAAO,QAAU6G,EAAiB7G,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,wBCfvG,IAAI8G,EAAgB,EAAQ,IAAoB,EAEhD,SAASC,GAAO,CACd,OAAI,OAAO,SAAY,aAAe,QAAQ,KAC5C/G,EAAO,QAAU+G,EAAO,QAAQ,IAAI,KAAK,EAAG/G,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,UAEjHA,EAAO,QAAU+G,EAAO,SAAchS,EAAQiS,EAAUC,EAAU,CAChE,IAAIC,EAAOJ,EAAc/R,EAAQiS,CAAQ,EACzC,GAAI,EAACE,EACL,KAAI/W,EAAO,OAAO,yBAAyB+W,EAAMF,CAAQ,EAEzD,OAAI7W,EAAK,IACAA,EAAK,IAAI,KAAK,UAAU,OAAS,EAAI4E,EAASkS,CAAQ,EAGxD9W,EAAK,MACd,EAAG6P,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,SAGnE+G,EAAK,MAAM,KAAM,SAAS,CACnC,CAEA/G,EAAO,QAAU+G,EAAM/G,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBCtB5F,SAASmH,EAAgBC,EAAG,CAC1B,OAAApH,EAAO,QAAUmH,EAAkB,OAAO,eAAiB,OAAO,eAAe,KAAK,EAAI,SAAyBC,EAAG,CACpH,OAAOA,EAAE,WAAa,OAAO,eAAeA,CAAC,CAC/C,EAAGpH,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,QACjEmH,EAAgBC,CAAC,CAC1B,CAEApH,EAAO,QAAUmH,EAAiBnH,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,wBCPvG,IAAIqH,EAAiB,EAAQ,IAAqB,EAElD,SAASC,EAAUC,EAAUC,EAAY,CACvC,GAAI,OAAOA,GAAe,YAAcA,IAAe,KACrD,MAAM,IAAI,UAAU,oDAAoD,EAG1ED,EAAS,UAAY,OAAO,OAAOC,GAAcA,EAAW,UAAW,CACrE,YAAa,CACX,MAAOD,EACP,SAAU,GACV,aAAc,EAChB,CACF,CAAC,EACD,OAAO,eAAeA,EAAU,YAAa,CAC3C,SAAU,EACZ,CAAC,EACGC,GAAYH,EAAeE,EAAUC,CAAU,CACrD,CAEAxH,EAAO,QAAUsH,EAAWtH,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBCpBjG,SAAS0F,EAAuB/U,EAAK,CACnC,OAAOA,GAAOA,EAAI,WAAaA,EAAM,CACnC,QAAWA,CACb,CACF,CAEAqP,EAAO,QAAU0F,EAAwB1F,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBCN9G,SAASyH,EAAsBzB,EAAKtN,EAAG,CACrC,IAAIgP,EAAK1B,GAAO,KAAO,KAAO,OAAO,QAAW,aAAeA,EAAI,OAAO,WAAaA,EAAI,cAE3F,GAAI0B,GAAM,KACV,KAAIC,EAAO,CAAC,EACRC,EAAK,GACLC,EAAK,GAELC,EAAIC,EAER,GAAI,CACF,IAAKL,EAAKA,EAAG,KAAK1B,CAAG,EAAG,EAAE4B,GAAME,EAAKJ,EAAG,KAAK,GAAG,QAC9CC,EAAK,KAAKG,EAAG,KAAK,EAEd,EAAApP,GAAKiP,EAAK,SAAWjP,IAH4BkP,EAAK,GAG1D,CAEJ,OAAS/H,EAAP,CACAgI,EAAK,GACLE,EAAKlI,CACP,QAAE,CACA,GAAI,CACE,CAAC+H,GAAMF,EAAG,QAAa,MAAMA,EAAG,OAAU,CAChD,QAAE,CACA,GAAIG,EAAI,MAAME,CAChB,CACF,CAEA,OAAOJ,EACT,CAEA3H,EAAO,QAAUyH,EAAuBzH,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBC9B7G,SAASgI,GAAmB,CAC1B,MAAM,IAAI,UAAU;AAAA,mFAA2I,CACjK,CAEAhI,EAAO,QAAUgI,EAAkBhI,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,wBCJxG,IAAIiI,EAAU,iBAEVC,EAAwB,EAAQ,KAA4B,EAEhE,SAASC,EAA2B/b,EAAMgc,EAAM,CAC9C,GAAIA,IAASH,EAAQG,CAAI,IAAM,UAAY,OAAOA,GAAS,YACzD,OAAOA,EACF,GAAIA,IAAS,OAClB,MAAM,IAAI,UAAU,0DAA0D,EAGhF,OAAOF,EAAsB9b,CAAI,CACnC,CAEA4T,EAAO,QAAUmI,EAA4BnI,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,mBCdlH,SAASqI,EAAgBjB,EAAGlN,EAAG,CAC7B,OAAA8F,EAAO,QAAUqI,EAAkB,OAAO,eAAiB,OAAO,eAAe,KAAK,EAAI,SAAyBjB,EAAGlN,EAAG,CACvH,OAAAkN,EAAE,UAAYlN,EACPkN,CACT,EAAGpH,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,QACjEqI,EAAgBjB,EAAGlN,CAAC,CAC7B,CAEA8F,EAAO,QAAUqI,EAAiBrI,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,wBCRvG,IAAIsI,EAAiB,EAAQ,KAAqB,EAE9CC,EAAuB,EAAQ,KAA2B,EAE1DC,EAA6B,EAAQ,KAAiC,EAEtEC,EAAkB,EAAQ,KAAsB,EAEpD,SAASC,EAAe1C,EAAKtN,EAAG,CAC9B,OAAO4P,EAAetC,CAAG,GAAKuC,EAAqBvC,EAAKtN,CAAC,GAAK8P,EAA2BxC,EAAKtN,CAAC,GAAK+P,EAAgB,CACtH,CAEAzI,EAAO,QAAU0I,EAAgB1I,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,uBCZtG,IAAI2I,EAAiB,EAAQ,KAAqB,EAElD,SAASC,EAAehb,EAAQoZ,EAAU,CACxC,KAAO,CAAC,OAAO,UAAU,eAAe,KAAKpZ,EAAQoZ,CAAQ,IAC3DpZ,EAAS+a,EAAe/a,CAAM,EAC1BA,IAAW,OAAf,CAGF,OAAOA,CACT,CAEAoS,EAAO,QAAU4I,EAAgB5I,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBCXtG,SAASiI,EAAQtX,EAAK,CAGpB,OAAQqP,EAAO,QAAUiI,EAAwB,OAAO,QAArB,YAA2C,OAAO,OAAO,UAA1B,SAAqC,SAAUtX,EAAK,CACpH,OAAO,OAAOA,CAChB,EAAI,SAAUA,EAAK,CACjB,OAAOA,GAAqB,OAAO,QAArB,YAA+BA,EAAI,cAAgB,QAAUA,IAAQ,OAAO,UAAY,SAAW,OAAOA,CAC1H,EAAGqP,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,QAAUiI,EAAQtX,CAAG,CAC/F,CAEAqP,EAAO,QAAUiI,EAASjI,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,wBCV/F,IAAI6I,EAAmB,EAAQ,KAAuB,EAEtD,SAASC,EAA4B1B,EAAG2B,EAAQ,CAC9C,GAAI,EAAC3B,EACL,IAAI,OAAOA,GAAM,SAAU,OAAOyB,EAAiBzB,EAAG2B,CAAM,EAC5D,IAAIC,EAAI,OAAO,UAAU,SAAS,KAAK5B,CAAC,EAAE,MAAM,EAAG,EAAE,EAErD,GADI4B,IAAM,UAAY5B,EAAE,cAAa4B,EAAI5B,EAAE,YAAY,MACnD4B,IAAM,OAASA,IAAM,MAAO,OAAO,MAAM,KAAK5B,CAAC,EACnD,GAAI4B,IAAM,aAAe,2CAA2C,KAAKA,CAAC,EAAG,OAAOH,EAAiBzB,EAAG2B,CAAM,EAChH,CAEA/I,EAAO,QAAU8I,EAA6B9I,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,oBCXnH,SAAS0F,EAAuB/U,EAAK,CACnC,OAAOA,GAAOA,EAAI,WAAaA,EAAM,CACnC,QAAWA,CACb,CACF,CACAqP,EAAO,QAAU0F,EAAwB1F,EAAO,QAAQ,WAAa,GAAMA,EAAO,QAAQ,QAAaA,EAAO,O,6aCL9G,K,kDAAmD,OAAiB,EAapE,EAIO,OAAY,EAOnB,SAASiJ,EAAiBpa,EAAcqa,EAAY,CACnD,GAAI,CAACA,EAAM,OAEX,IAAI/M,EAEJ,GACC+M,EAAK,OAAS,MACbA,EAAK,QAAQ,GAAG,IAAM,IAAMA,EAAK,QAAQ,IAAI,IAAM,IAEpD,GAAIra,EAAK,YAAW,EAAG,SAAS,SAAS,EACxCsN,EAAO,kBACG+M,EAAK,YAAW,EAAG,SAAS,SAAS,EAC/C/M,EAAO,kBACGtN,EAAK,YAAW,EAAG,SAAS,QAAQ,EAC9CsN,EAAO,iBACG+M,EAAK,YAAW,EAAG,SAAS,QAAQ,EAC9C/M,EAAO,aAGP,aAGDA,EACC+M,EAAK,UAAU,EAAG,EAAmC,IACpD,8BACDA,EAAK,UAAU,EAAG,EAA+B,IAChD,yBACE,UACA,SAEA/M,IAAS,UACF+M,EAAK,MAAM,2BAA2B,EAE7C,OAAQ7b,GAAMA,EAAE,QAAQ,aAAc,EAAE,EAAE,KAAI,CAAE,EAAE,OAAS,IAE7D8O,EAAO,WAIV,MAAO,CAAE,KAAAtN,EAAM,KAAAsN,CAAI,CACpB,CAaA,SAASgN,EAAiBC,EAAyB,C,QAClD,MAAMC,EAAoB,CACzB,CACC,KAAM,qCACN,QAAS,UACT,OAAQ,M,GAGJC,EAAoB,CACzB,CACC,KAAM,gCACN,QAAS,KACT,OAAQ,M,GAGV,GAAI,QAAAF,EAAK,UAAM,0BAAE,YAAQ,qBAAE,mBAC1B,SAAW,CAACG,EAAKC,CAAK,IAAK,OAAO,QACjCJ,EAAK,OAAO,SAAS,iBAAiB,EAEtC,GAAI,EAACI,EAEL,UAAWC,KAAMD,EACZC,EAAG,SAAW,OACjBJ,EAAK,KAAK,CACT,KAAM,IAAII,EAAG,WAAWA,EAAG,aAAaF,IACxC,QAASE,EAAG,QACZ,OAAQ,M,CACR,EAEDH,EAAK,KAAK,CACT,KAAM,IAAIG,EAAG,WAAWA,EAAG,aAAaF,IACxC,QAASE,EAAG,QACZ,OAAQ,M,CACR,EAKL,MAAO,CAAE,KAAAJ,EAAM,KAAAC,CAAI,CACpB,CAEM,MAAOI,UAAwB,YAGpC,CACA,YAAYnhB,EAAsB,CACjC,MAAMA,CAAK,CACZ,CAGU,QAAWqH,EAA0B,CAC9C,OAAO,MAAM,QAAW,GAAE,aAAc,IAASA,EAAS,CAC3D,CAMA,gBAAgB+Z,EAAgB,CAC/B,OAAO,KAAK,QAAQ,CACnB,SAAU,OACV,YAAaA,EAEb,eAAgB,GAChB,SAAiBjN,GAAW,wB,MAC3B,MAAM/L,EAAM,MAAM,KAAK,UAAU,qBAAqB,EAClD,KAAAA,GAAG,YAAHA,EAAK,UAAM,qBAAE,aAChB+L,EACC,OAAO,QAAgB/L,EAAI,OAAO,YAAY,EAC5C,IAAI,CAAC,CAAC9B,EAAMqa,CAAI,IAAMD,EAAiBpa,EAAMqa,CAAI,CAAC,EAClD,OAAQA,GAA8B,CAAC,CAACA,CAAI,CAAC,EAGhDxM,EAAQ,CAAC,CAAC,CAEZ,E,CACA,CACF,CAOA,QAAQ0M,EAAcQ,EAAsB,IAAG,CAC9C,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAWlN,GAAW,CACrB,KAAK,QAAQ,KACZ,aACA0M,EACA,UACAQ,GAAe,IACdvO,GAAc,CACdqB,EAAQrB,CAAK,CACd,CAAC,CAEH,C,CACA,CACF,CAKA,aAAa+N,EAAY,CACxB,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC1M,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,WAAYT,EAAM,CAACvJ,EAAKiK,IAAS,CAC9CjK,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQoN,CAAM,CACf,CAAC,CACF,C,CACA,CACF,CAKA,QAAQV,EAAY,CACnB,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC1M,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,aACAT,EACA,UACA,KACCvJ,GAAO,CACHA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CAEH,C,CACA,CACF,CAOA,WAAWqN,EAAiBxT,EAAgB,CAC3C,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACmG,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,aAAcE,EAASxT,EAAWsJ,GAAO,CACtDA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CACF,C,CACA,CACF,CAOA,aAAaqN,EAAiBC,EAAkB,CAC/C,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACtN,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,eACAE,EACAC,EACCnK,GAAO,CACHA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CAEH,C,CACA,CACF,CAMA,SAASiN,EAAgB,CACxB,OAAO,KAAK,QAAQ,CACnB,SAAU,QACV,YAAaA,EAEb,eAAgB,GAChB,SAAU,CAACjN,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,gBACA,SACA,OACA,CAAE,SAAU,eAAgB,OAAQ,oBAAoB,EACxD,CAAChK,EAAKpE,IAAO,CACRoE,EACHgK,EAAOhK,CAAG,EAEVnD,G,EACC,8BACCjB,CAAG,CACH,CAGJ,CAAC,CAEH,C,CACA,CACF,CAMA,SAASkO,EAAgB,CACxB,OAAO,KAAK,QAAQ,CACnB,SAAU,QACV,YAAaA,EAEb,eAAgB,GAChB,SAAU,CAACjN,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,gBACA,SACA,OACA,CAAE,SAAU,eAAgB,OAAQ,oBAAoB,EACxD,CAAChK,EAAKpE,IAAO,CACRoE,EACHgK,EAAOhK,CAAG,EAEVnD,G,EACC,8BACCjB,CAAG,CACH,CAGJ,CAAC,CAEH,C,CACA,CACF,CAQA,YACC9P,EACAse,EACAC,EAAoC,CAEpC,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAiBxN,GAAW,wB,MAC3B,MAAMyN,EAAS,MAAM,KAAK,UAAU,EAAI,EAElCC,EAAYD,EAAO,OAAQlX,GAChCA,EAAE,IAAI,WAAW,GAAGtH,IAAK,CAAC,EAG3B,UAAW0e,KAASD,EAAW,CAC9B,MAAME,EAAaD,EAAM,IACnBE,EAAaN,EAAQI,EAAM,IAAI,UAAU1e,EAAG,MAAM,EACxD0e,EAAM,IAAME,EAGZ,MAAM,KAAK,UAAUA,EAAYF,CAAK,EACtC,MAAM,KAAK,UAAUC,CAAU,C,CAGhC,MAAME,EAAcL,EAAO,KAAMlX,GAAMA,EAAE,MAAQtH,CAAE,EACnD,GAAI6e,EAAa,CAChB,MAAMF,EAAaE,EAAY,IAC/BA,EAAY,IAAMP,EACdC,IAAY,UACf,EAACM,EAAY,UAAc,mBAA1BA,EAAY,OAAmB,CAAC,GACjCA,EAAY,OAAO,KAAON,GAI3B,MAAM,KAAK,UAAUD,EAAOO,CAAW,EACvC,MAAM,KAAK,UAAUF,CAAU,C,CAGhC5N,EAAO,CACR,E,CACA,CACF,CAQA,YACC0M,EACAO,EACAc,EAAkB,CAElB,OAAArB,G,EAAO,mBAAgBA,CAAI,EACpB,KAAK,QAAQ,CACnB,SAAU,YAAYA,IACtB,YAAaO,EACb,eAAgBc,EAChB,SAAU,CAAC/N,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,aACAtB,EACA,cACA,KACCuB,GAAQ,CACJD,EAAQ,UACZA,EAAQ,aAAY,EAChBC,IAAS,SAAO,iBACnBd,EAAO,4BAA4B,EACxBc,EAGXjO,EAAQiO,CAAI,EAFZd,EAAO,2BAA2B,EAIpC,CAAC,CAEH,C,CACA,CACF,CAQA,iBACCT,EACAO,EACAc,EAAkB,CAElB,OAAArB,G,EAAO,mBAAgBA,CAAI,EACpB,KAAK,QAAQ,CACnB,SAAU,iBAAiBA,IAC3B,YAAaO,EACb,eAAgBc,EAChB,SAAU,CAAC/N,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,aACAtB,EACA,mBACA,KACCuB,GAAQ,CACJD,EAAQ,UACZA,EAAQ,aAAY,EAChBC,IAAS,SAAO,iBACnBd,EAAO,iCAAiC,EAC7Bc,EAGXjO,EAAQiO,CAAI,EAFZd,EAAO,gCAAgC,EAIzC,CAAC,CAEH,C,CACA,CACF,CASA,cACCT,EACA/D,EACAsE,EACAc,EAAkB,CAElB,OAAO,KAAK,QAAQ,CACnB,SAAU,cAAcrB,IACxB,YAAaO,EACb,eAAgBc,EAChB,SAAU,CAAC/N,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,aACAtB,EACA,gBACA/D,EACCsF,GAAQ,CACJD,EAAQ,UACZA,EAAQ,aAAY,EAChBC,IAAS,SAAO,iBACnBd,EAAO,8BAA8B,EAC1Bc,EAGXjO,EAAQiO,CAAI,EAFZd,EAAO,6BAA6B,EAItC,CAAC,CAEH,C,CACA,CACF,CAQA,aACCT,EACAO,EACAiB,EAAmB,CAEnB,OAAAxB,G,EAAO,mBAAgBA,CAAI,EAEpB,KAAK,QAAQ,CACnB,SAAU,aAAaA,IACvB,YAAaO,EACb,eAAgBiB,EAChB,SAAU,CAAClO,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,aACAtB,EACA,eACA,KACCuB,GAAQ,CACJD,EAAQ,UACZA,EAAQ,aAAY,EAChBC,IAAS,SAAO,iBACnBd,EAAO,6BAA6B,EACzBc,EAGXjO,EAAQiO,CAAI,EAFZd,EAAO,4BAA4B,EAIrC,CAAC,CAEH,C,CACA,CACF,CASA,QACCT,EACAyB,EACAC,EACAF,EAAmB,CAEnB,OAAO,KAAK,QAAQ,CACnB,eAAgBA,EAChB,SAAU,CAAClO,EAASmN,EAAQa,IAAW,CACtCtB,G,EAAO,mBAAgBA,CAAI,EAE3B,KAAK,QAAQ,KAAK,UAAWA,EAAM0B,EAAOD,EAAMhL,GAAO,CAClD6K,EAAQ,UACZA,EAAQ,aAAY,EAEhB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,EACR,CAAC,CACF,C,CACA,CACF,CAMA,iBAAiB0M,EAAY,CAE5B,OAAAA,G,EAAO,sBAAmBA,CAAI,EAEvB,KAAK,QAAQ,CACnB,gBAAiB,CAAC,oCAAoC,EACtD,SAAU,CAAC1M,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,aACAtB,EACA,mBACA,KACCuB,GAAQ,CACJD,EAAQ,UACZA,EAAQ,aAAY,EAEhBC,IAAS,SAAO,iBACnBd,EAAO,6BAA6B,EACzBc,EAGXjO,EAAQiO,CAAI,EAFZd,EAAO,4BAA4B,EAIrC,CAAC,CAEH,C,CACA,CACF,CAOA,kBAAkBT,EAAc2B,EAAW,CAE1C,OAAA3B,G,EAAO,sBAAmBA,CAAI,EAEvB,KAAK,QAAQ,CACnB,gBAAiB,CAAC,oCAAoC,EACtD,SAAU,CAAC1M,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,aACAtB,EACA,oBACA2B,EACCJ,GAAQ,CACJD,EAAQ,UACZA,EAAQ,aAAY,EAEhBC,IAAS,SAAO,iBACnBd,EAAO,8BAA8B,EAC1Bc,EAGXjO,EAAQiO,CAAI,EAFZd,EAAO,6BAA6B,EAItC,CAAC,CAEH,C,CACA,CACF,CAMA,kBAAkBT,EAAY,CAE7B,OAAAA,G,EAAO,sBAAmBA,CAAI,EAEvB,KAAK,QAAQ,CACnB,SAAU,CAAC1M,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,aACAtB,EACA,oBACA,KACC5d,GAAS,CACLkf,EAAQ,UACZA,EAAQ,aAAY,EAChBlf,GAAOqe,EAAOre,CAAK,EACvBkR,EAAQ,EAAI,EACb,CAAC,CAEH,C,CACA,CACF,CAOA,YAAY0M,EAAc4B,EAAkB,CAE3C,OAAA5B,G,EAAO,sBAAmBA,CAAI,EAEvB,KAAK,QAAQ,CACnB,SAAU,CAAC1M,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,aACAtB,EACA,cACA4B,EACCpZ,GAAU,CACN8Y,EAAQ,UACZA,EAAQ,aAAY,EACpBhO,EAAQ9K,CAAM,EACf,CAAC,CAEH,C,CACA,CACF,CAOA,eAAeX,EAAcga,EAAgB,CAC5C,OAAO,KAAK,QAAQ,CACnB,SAAU,CAACvO,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,iBAAkBzZ,EAAMga,EAAWpL,GAAO,CACvD6K,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,EACR,CAAC,CACF,C,CACA,CACF,CAOA,eAAe0M,EAAcO,EAAgB,CAC5C,OAAAP,G,EAAO,mBAAgBA,CAAI,EACpB,KAAK,QAAQ,CACnB,SAAU,OAAOA,IACjB,YAAaO,EAEb,eAAgB,GAChB,SAAiBjN,GAAW,wB,MAC3B,MAAM/L,EAAM,MAAM,KAAK,UAAUyY,CAAI,EACrC1M,GAAQ,EAAA/L,GAAG,YAAHA,EAAK,OAAO,WAAO,mBAAI,CAAC,CAAC,CAClC,E,CACA,CACF,CAOA,YAAYua,EAAsBvB,EAAgB,CAEjD,OAAAuB,G,EAAe,sBAAmBA,CAAY,EAEvC,KAAK,QAAQ,CACnB,SAAU,QAAQA,IAClB,YAAavB,EACb,SAAU,CAACjN,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,cAAeQ,EAAc,CAACzB,EAAIL,IAAQ,CAC3D,GAAIsB,EAAQ,QAAS,OACrBA,EAAQ,aAAY,EAEpB,KAAM,CAAE,KAAArB,EAAM,KAAAC,CAAI,EAAKH,EAAiBC,CAAI,EAC5C1M,EAAQ,CAAC,GAAG2M,EAAM,GAAGC,CAAI,CAAC,CAC3B,CAAC,CACF,C,CACA,CACF,CAMA,QAAQ6B,EAAiB,CACxB,OAAO,KAAK,QAAQ,CACnB,SAAU,CAACzO,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,UAAWS,EAAW,CAACtL,EAAKuL,IAAc,CACvDV,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ0O,CAAW,EACpB,CAAC,CACF,C,CACA,CACF,CAMA,QAAQA,EAAkB,CACzB,OAAO,KAAK,QAAQ,CACnB,SAAU,CAAC1O,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,UAAWU,EAAY,CAACvL,EAAKsL,IAAa,CACvDT,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQyO,CAAU,EACnB,CAAC,CACF,C,CACA,CACF,CAQA,UACCpB,EACAsB,EACAzb,EAAmC,CAEnC,OAAO,KAAK,QAAQ,CACnB,SAAU,CAAC8M,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,YACAX,EACAsB,EACAzb,EACA,CAACiQ,EAAKyL,IAAa,CACdZ,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ4O,CAAU,EACnB,CAAC,CAEH,C,CACA,CACF,CAQA,UACCvB,EACArO,EACA9L,EAA+C,CAE/C,OAAO,KAAK,QAAQ,CACnB,SAAU,CAAC8M,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,YACAX,EACArO,EACA9L,EACA,CAACiQ,EAAKyL,IAAa,CACdZ,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ4O,CAAU,EACnB,CAAC,CAEH,C,CACA,CACF,CAOA,iBAAiBlC,EAAcmC,EAAgB,CAC9C,OAAO,KAAK,QAAQ,CACnB,SAAU,CAAC7O,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,aACAtB,EACA,mBACA,CAAE,SAAAmC,CAAQ,EACTC,GAAiB,CACbd,EAAQ,UACZA,EAAQ,aAAY,EACpBhO,EAAQ8O,CAAa,EACtB,CAAC,CAEH,C,CACA,CACF,CAOA,mBAAmBpC,EAAcmC,EAAgB,CAChD,OAAO,KAAK,QAAQ,CACnB,SAAU,CAAC7O,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,aACAtB,EACA,qBACA,CAAE,SAAAmC,CAAQ,EACTC,GAAiB,CACbd,EAAQ,UACZA,EAAQ,aAAY,EACpBhO,EAAQ8O,CAAa,EACtB,CAAC,CAEH,C,CACA,CACF,CAKA,qBAAmB,CAClB,OAAO,KAAK,QAAQ,CACnB,SAAU,CAAC9O,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,sBAAuB,CAAC7K,EAAK4L,IAAY,CACtDf,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ,CAAC,CAAC+O,CAAQ,EACnB,CAAC,CACF,C,CACA,CACF,CAKA,aAAW,CACV,OAAO,KAAK,QAAQ,CACnB,SAAU,CAAC/O,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,cAAe,CAAC7K,EAAKkL,IAAU,CAC5CL,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQqO,CAAM,EACf,CAAC,CACF,C,CACA,CACF,CAKA,WAAWpB,EAAgB,CAC1B,OAAO,KAAK,QAAQ,CACnB,SAAU,CAACjN,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,aAAc,CAAC,CAACf,EAAQ,CAAC9J,EAAK6L,IAAW,CACtDhB,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQgP,CAAO,EAChB,CAAC,CACF,C,CACA,CACF,CAEA,kBAAkBd,EAAmB,CACpC,MAAMe,EAAa,IAAI,gBAEvB,OAAO,KAAK,QAAQ,CACnB,eAAgBf,GAAc,IAC9B,UAAW,IAAK,CACfe,EAAW,MAAK,CACjB,EACA,SAAU,CAAOjP,EAASmN,EAAQa,IAAW,wBAC5C,GAAI,CACH,MAAMkB,EAAM,MAAM,MAAM,YAAa,CACpC,OAAQD,EAAW,M,CACnB,EACD,GAAIjB,EAAQ,QAAS,OACrBA,EAAQ,aAAY,EACpBhO,EAAQkP,EAAI,KAAI,CAAE,C,OACVtgB,E,CACRue,EAAO,sBAAsBve,GAAG,C,CAElC,E,CACA,CACF,CAKA,oBAAkB,CACjB,OAAO,KAAK,QAAQ,CACnB,SAAU,kBACV,SAAU,CAACoR,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,qBAAsB,CAAC7K,EAAKgM,IAAa,CACtDnB,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQmP,CAAU,EACnB,CAAC,CACF,C,CACA,CACF,CAWA,oBACC9B,EACAJ,EAAgB,CAEhB,OAAI,OAAOI,GAAY,YACtBJ,EAASI,EACTA,EAAU,IAEXA,EAAUA,GAAO,KAAPA,EAAW,GAEd,KAAK,QAAQ,CACnB,SAAU,aAAaA,IACvB,YAAaJ,EACb,SAAU,CAACjN,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,sBACAX,EACA,CAAClK,EAAKiM,IAAa,CACdpB,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQoP,CAAU,EACnB,CAAC,CAEH,C,CACA,CACF,CAWA,YACC/B,EACAJ,EAAgB,CAEhB,OAAI,OAAOI,GAAY,YACtBJ,EAASI,EACTA,EAAU,IAEXA,EAAUA,GAAO,KAAPA,EAAW,GAEd,KAAK,QAAQ,CACnB,SAAU,WAAWA,IACrB,YAAaJ,EACb,SAAU,CAACjN,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,cAAeX,EAAS,CAAClK,EAAKkM,IAAY,CACvDrB,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQqP,CAAS,EAClB,CAAC,CACF,C,CACA,CACF,CAGA,mBACCpC,EAAgB,CAEhB,OAAO,KAAK,QAAQ,CACnB,SAAU,kBACV,YAAaA,EACb,SAAU,CAACjN,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,qBAAsB,CAAC7K,EAAKkM,IAAY,CACrDrB,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQqP,CAAS,EAClB,CAAC,CACF,C,CACA,CACF,CAGA,sBAAsBhC,EAAgB,CACrCA,EAAUA,GAAO,KAAPA,EAAW,GACrB,KAAK,WAAW,WAAWA,GAAS,EACpC,KAAK,WAAW,iBAAiB,CAClC,CAGA,oBACCJ,EAAgB,CAEhB,OAAO,KAAK,QAAQ,CACnB,SAAU,mBACV,YAAaA,EACb,SAAU,CAACjN,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,sBAAuB,CAAC7K,EAAKiM,IAAa,CACvDpB,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQoP,CAAU,EACnB,CAAC,CACF,C,CACA,CACF,CAGA,8BAA8B/B,EAAgB,CAC7CA,EAAUA,GAAO,KAAPA,EAAW,GACrB,KAAK,WAAW,aAAaA,GAAS,EACtC,KAAK,WAAW,kBAAkB,CACnC,CAIA,oBACCX,EACAO,EACAiB,EAAmB,CAEnB,OAAAxB,G,EAAO,mBAAgBA,CAAI,EAEpB,KAAK,QAAQ,CACnB,SAAU,oBAAoBA,IAC9B,YAAaO,EACb,eAAgBiB,EAChB,SAAU,CAAClO,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,sBAAuBtB,EAAOuB,GAAQ,CACnDD,EAAQ,UACZA,EAAQ,aAAY,EAEhBC,IAAS,SAAO,iBACnBd,EAAO,oCAAoC,EAChCc,EAGXjO,EAAQiO,CAAI,EAFZd,EAAO,mCAAmC,EAI5C,CAAC,CACF,C,CACA,CACF,CAGA,uBAAuBT,EAAY,CAC7BA,GAIJ,KAAK,WAAW,oBAAoBA,GAAM,EAC1C,KAAK,WAAW,aAAaA,GAAM,IAJnC,KAAK,WAAW,oBAAqB,EAAI,EACzC,KAAK,WAAW,aAAc,EAAI,EAKpC,CAQA,qBACCA,EACAO,EACAc,EAAkB,CAElB,OAAArB,G,EAAO,mBAAgBA,CAAI,EAEpB,KAAK,QAAQ,CACnB,SAAU,qBAAqBA,IAC/B,YAAaO,EACb,eAAgBc,EAChB,SAAU,CAAC/N,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,uBAAwBtB,EAAOuB,GAAQ,CACpDD,EAAQ,UACZA,EAAQ,aAAY,EAEhBC,IAAS,SAAO,iBACnBd,EAAO,qCAAqC,EACjCc,EAGXjO,EAAQiO,CAAI,EAFZd,EAAO,oCAAoC,EAI7C,CAAC,CACF,C,CACA,CACF,CAGA,wBAAwBT,EAAY,CAC9BA,GAIJ,KAAK,WAAW,qBAAqBA,GAAM,EAC3C,KAAK,WAAW,cAAcA,GAAM,IAJpC,KAAK,WAAW,qBAAsB,EAAI,EAC1C,KAAK,WAAW,cAAe,EAAI,EAKrC,CAMA,gBAAgBO,EAAgB,CAC/B,OAAO,KAAK,QAAQ,CACnB,SAAU,eACV,YAAaA,EACb,SAAU,CAACjN,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KAAK,kBAAmB,CAAC7K,EAAKmM,IAAgB,CACtDtB,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQsP,CAAa,EACtB,CAAC,CACF,C,CACA,CACF,CAKA,6BACCrC,EAAgB,CAEhB,OAAO,KAAK,QAAQ,CACnB,SAAU,sBACV,YAAaA,EACb,SAAU,CAACjN,EAASmN,EAAQa,IAAW,CACtC,KAAK,QAAQ,KACZ,+BACA,CAAC7K,EAAKoM,IAAsB,CACvBvB,EAAQ,UACZA,EAAQ,aAAY,EAChB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQuP,CAAmB,EAC5B,CAAC,CAEH,C,CACA,CACF,C,8aCtrCD,K,oHAAsC,OAAsB,EAM5D,EAKO,OAAY,EAGPC,GAAZ,SAAYA,EAAQ,CAEnBA,IAAA,2BAEAA,IAAA,yBAEAA,IAAA,mCAEAA,IAAA,gBACD,GATYA,MAAQ,KAWpB,IAAYC,GAAZ,SAAYA,EAAM,CACjBA,EAAA,mCACAA,EAAA,kCACAA,EAAA,kBACAA,EAAA,kCACAA,EAAA,6BACD,GANYA,MAAM,KASX,MAAMC,EAAmBD,EAAO,iBAE1BE,EAAgBF,EAAO,cA0D9BG,EAAW,CAAC,WAAY,UAAW,KAAK,EAExC,MAAOC,CAAU,CAUtB,YAAYhkB,EAA+B,CAiCnC,iBAAsB,GACtB,eAAqB,GACrB,gBAAsB,GACtB,kBAAwB,GACzB,oBAA0B,GAC1B,YAAkB,GACjB,eAA4C,CAAC,EAEpC,sBAMb,CAAC,EACY,qBAOb,CAAC,EACY,uBAGb,CAAC,EACG,aAA2C,CAAC,EAC5C,YAAyC,CAAC,EAE3C,SAAW,KACX,cAAoB,GAEV,0BAChB,CAAC,EACe,mBAA+C,CAAC,EAahD,qC,EAAiC,yBAAqB,EAGtD,eAA0C,CAAC,EAUpD,iBAAkC,KA7FzC,KAAK,MAAQ,KAAK,kBAAkBA,CAAK,EAEzC,KAAK,iBAAgB,EACnB,KAAK,IAAM,KAAK,YAAW,CAAE,EAC7B,MAAO,GAAK,CACZ,MAAM,+CAA+C,GAAG,CACzD,CAAC,CACH,CAEQ,kBACPA,EAA+B,C,YAE/B,OAAO,OACHA,GADG,CAGN,SAAUA,EAAM,UAAY,OAAO,SAAS,SAC5C,KAAMA,EAAM,MAAQ,OAAO,SAAS,SACpC,KACCA,EAAM,OACL,OAAO,SAAS,OAAS,OAAS,KAAO,OAAO,SAAS,MAC3D,UAAW,KAAK,IAAIA,EAAM,WAAa,IAAO,GAAK,EACnD,WAAY,KAAK,IAAIA,EAAM,YAAc,IAAM,GAAI,EACnD,WAAYA,EAAM,YAAc,GAChC,gBAAgB,EAAAA,EAAM,kBAAc,mBAAI,CAAC,EACzC,kBAAkB,EAAAA,EAAM,oBAAgB,mBAAI,GAC5C,cAAc,EAAAA,EAAM,gBAAY,mBAAI,GACpC,qBAAqB,EAAAA,EAAM,uBAAmB,mBAAI,E,EAEpD,CA4CQ,QAAQiD,EAAU,C,QACxB,OAAK,MAAM,WAAO,mBAAI,QAAQ,OAAOA,CAAK,CAC5C,CAeA,IAAW,cAAY,CACtB,OAAO,KAAK,aACb,CAGA,IAAW,YAAU,CACpB,OAAO,KAAK,WACb,CAMA,OAAO,OAAK,CACX,OAAO,OAAO,YAAc,MAC7B,CAEQ,kBAAgB,CAEvB,OAAI,KAAK,sBAA8B,KAAK,uBAE5C,KAAK,sBAAwB,IAAI,QAAQ,CAAOkR,EAASmN,IAAU,wBAElE,GAAI,OAAO,OAAO,IAAO,YAGxB,GAAI,OAAO,OAAO,sBAAyB,WAC1C,OAAO,qBAAqB,IAAMnN,EAAO,CAAE,MACrC,CAEN,QAAShE,EAAI,EAAGA,GAAK,GAAIA,IAAK,CAC7B,GAAI,OAAO,GAAI,OAAOgE,EAAO,EAC7B,M,EAAM,QAAK,GAAG,C,CAGfmN,EAAO,IAAI,MAAM,qCAAqC,CAAC,C,MAGxDnN,EAAO,CAET,EAAC,EACM,KAAK,sBACb,CAKM,aAAW,gCAChB,GAAI,KAAK,QAAS,OAElB,IAAI0M,EAAO,KAAK,MAAM,KAClBoD,EAAO,KAAK,MAAM,KAClBC,EAAW,KAAK,MAAM,SAAS,QAAQ,IAAK,EAAE,EAC9CpB,EAAO,OAAO,SAAS,SAE3B,GACC,OAAO,SAAS,WAAa,gBAC7B,OAAO,SAAS,WAAa,eAE7BA,EAAO,OACD,CAEN,GAAI,OAAO,UAAW,CACrB,MAAMqB,EAAS,IAAI,IAAI,OAAO,SAAS,EACvCtD,EAAOsD,EAAO,SACdF,EAAOE,EAAO,KACdD,EAAWC,EAAO,SAAS,QAAQ,IAAK,EAAE,C,CAG3C,MAAMnc,EAAM8a,EAAK,YAAY,GAAG,EAKhC,GAJI9a,IAAQ,KACX8a,EAAOA,EAAK,UAAU,EAAG9a,EAAM,CAAC,GAG7Bgc,EAAW,MAAK,EAAI,CAEvB,MAAMthB,EAAQogB,EAAK,MAAM,GAAG,EACxBpgB,EAAM,OAAS,IAClBA,EAAM,IAAG,EACTA,EAAM,IAAG,EAELqhB,EAAS,SAASrhB,EAAMA,EAAM,OAAS,EAAE,GAC5CA,EAAM,IAAG,EAEVogB,EAAOpgB,EAAM,KAAK,GAAG,EAChBogB,EAAK,SAAS,GAAG,IACrBA,GAAQ,K,EAMZ,MAAMrQ,EAAMwR,EACT,GAAGC,OAAcrD,KAAQoD,IAAOnB,IAChC,GAAGoB,OAAcrD,IAAOiC,IAE3B,KAAK,QAAU,OAAO,GAAG,QAAQrQ,EAAK,CACrC,KAAMqQ,EAAK,SAAS,GAAG,EAAI,GAAGA,aAAkB,GAAGA,cACnD,MAAO,UACP,KAAM,KAAK,MAAM,KACjB,QAAS,KAAK,MAAM,UACpB,KAAM,KAAK,MAAM,KACjB,MAAO,KAAK,MAAM,K,CAClB,EAED,KAAK,QAAQ,GAAG,UAAYsB,GAAa,CAEpCA,IAAc,IACjB,KAAK,UAAY,GACjB,WACC,IACC,KAAK,WAAU,EACb,KAAMC,GAAQ,CACd,KAAM,CAACC,EAAOC,EAAOC,CAAK,EACzBH,EAAK,QAAQ,MAAM,GAAG,EAEtB,SAASC,EAAO,EAAE,EAAI,IACtB,SAASC,EAAO,EAAE,EAAI,IACtB,SAASC,EAAO,EAAE,EACX,OACP,KAAK,WAAa,KAElB,KAAK,aAAa,GAAO,EAAK,GAE9B,KAAK,QAAQ,KACZ,eACA,CAACC,EAAMC,IACN,KAAK,aAAaD,EAAMC,CAAQ,CAAC,CAGrC,CAAC,EACA,MAAO3hB,GACP,KAAK,QAAQ,CACZ,QAASA,EAAE,SAAQ,EACnB,UAAW,Y,CACX,CAAC,EAEL,GAAG,GAIJ,KAAK,QAAQ,KAAK,eAAgB,CAAC0hB,EAAMC,IAAY,CACpD,KAAK,aAAaD,EAAMC,CAAQ,CACjC,CAAC,CAEH,CAAC,EAED,KAAK,QAAQ,GAAG,YAAa,IAAK,C,SACjC,UAAK,OAAM,cAAU,2BAAGf,EAAS,KAAK,EACtC,KAAK,UAAY,GAEb,KAAK,eACR,OAAO,SAAS,OAAM,GAEtB,KAAK,WAAW,EAAI,EACpB,KAAK,qBAAqB,QAASgB,GAAOA,EAAG,EAAI,CAAC,EAEpD,CAAC,EAED,KAAK,QAAQ,GAAG,aAAc,IAAK,C,QAClC,KAAK,UAAY,GACjB,KAAK,WAAa,IAClB,UAAK,OAAM,cAAU,2BAAGhB,EAAS,UAAU,EAC3C,KAAK,qBAAqB,QAASgB,GAAOA,EAAG,EAAK,CAAC,CACpD,CAAC,EAED,KAAK,QAAQ,GAAG,iBAAkB,IAAM,KAAK,aAAY,CAAE,EAE3D,KAAK,QAAQ,GAAG,MAAQhP,GAAW,C,SAClC,UAAK,OAAM,SAAK,2BAAGA,CAAO,EAC1B,KAAK,cAAc,QAASgP,GAAOA,EAAGhP,CAAO,CAAC,CAC/C,CAAC,EAED,KAAK,QAAQ,GAAG,QAAU2B,GAAY,CACrC,IAAIsN,EAEAtN,GAAO,KACVsN,EAAO,GACG,OAAOtN,EAAI,UAAa,WAClCsN,EAAOtN,EAAI,SAAQ,GAEnBsN,EAAO,KAAK,UAAUtN,CAAG,EACzB,QAAQ,MAAM,2BAA2BsN,GAAM,GAG5CA,EAAK,SAAS,qBAAqB,EACtC,KAAK,aAAY,EACPA,EAAK,SAAS,iBAAiB,GACzC,QAAQ,MAAM,2BAA2BtN,GAAK,EAC9C,OAAO,SAAS,OAAM,GAEtB,QAAQ,MAAM,iBAAiBA,GAAK,CAEtC,CAAC,EAED,KAAK,QAAQ,GAAG,gBAAkBA,GACjC,QAAQ,MAAM,kBAAkBA,GAAK,CAAC,EAGvC,KAAK,QAAQ,GAAG,kBAAoBA,GACnC,KAAK,QAAQ,CACZ,QAAS,gBACT,UAAWA,EAAI,UACf,KAAMA,EAAI,KACV,GAAIA,EAAI,IAAM,E,CACd,CAAC,EAGH,KAAK,QAAQ,GAAG,eAAgB,CAAClU,EAAIgF,IAAO,CAC3C,WAAW,IAAM,KAAK,aAAahF,EAAIgF,CAAG,EAAG,CAAC,CAC/C,CAAC,EAED,KAAK,QAAQ,GAAG,cAAe,CAAChF,EAAI+U,IAAS,CAC5C,WAAW,IAAM,KAAK,YAAY/U,EAAI+U,CAAK,EAAG,CAAC,CAChD,CAAC,EAED,KAAK,QAAQ,GAAG,aAAc,CAAC/U,EAAI4K,EAAUtN,IAAQ,CACpD,WAAW,IAAM,KAAK,WAAW0C,EAAI4K,EAAUtN,CAAI,EAAG,CAAC,CACxD,CAAC,EAED,KAAK,QAAQ,GAAG,YAAa,CAAC0C,EAAI8D,IAAQ,C,OACzC,OAAK,sBAAkB,8BAAG9D,EAAI8D,CAAI,CACnC,CAAC,EAED,KAAK,QAAQ,GAAG,YAAa,CAAC9D,EAAI8D,IAAQ,C,OACzC,OAAK,sBAAkB,8BAAG9D,EAAI8D,CAAI,CACnC,CAAC,EAED,KAAK,QAAQ,GAAG,UAAW,CAAC9D,EAAIyhB,IAAY,C,OAC3C,OAAK,oBAAgB,8BAAGzhB,EAAIyhB,CAAQ,CACrC,CAAC,CACF,GAKQ,aAAaJ,EAAeC,EAAiB,C,QAChD,KAAK,aACR,aAAa,KAAK,UAAU,EAC5B,KAAK,WAAa,MAGnB,KAAK,UAAY,GACjB,KAAK,SAAWA,EAEZ,KAAK,eACR,OAAO,SAAS,OAAM,GAElB,KAAK,aACR,KAAK,SAAQ,GAEb,UAAK,OAAM,cAAU,2BAAGf,EAAS,KAAK,EAGvC,KAAK,WAAW,EAAI,EACpB,KAAK,qBAAqB,QAASgB,GAAOA,EAAG,EAAI,CAAC,GAGnD,KAAK,+BAA+B,QAAO,CAC5C,CAMA,aAAW,CACV,OAAO,KAAK,SACb,CAKA,wBAAsB,CACrB,OAAO,KAAK,8BACb,CAKc,oBAAkB,gCAC/B,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACxQ,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,qBAAsB,CAAChK,EAAKwN,IAAO,CAChDxN,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ2Q,CAAI,CACb,CAAC,CACF,C,CACA,CACF,GAGc,UAAQ,gCACrB,GAAI,KAAK,OAAQ,OACjB,MAAMC,EAAc,GACpB,QAAS5U,EAAI,EAAGA,GAAK4U,EAAa5U,IAAK,CAEtC,GADA,KAAK,WAAU,EACX,KAAK,OAAQ,OACjB,M,EAAM,QAAK,GAAI,C,CAEjB,GAKc,YAAU,gC,sBACvB,GAAI,MAAK,OAGT,IAAI,CAAC,KAAK,MAAM,aACf,GAAI,CACH,KAAK,IAAM,MAAM,KAAK,mBAAkB,C,OAChCpN,E,CACR,KAAK,QAAQ,iCAAiCA,GAAG,EACjD,M,CAKF,GAAI,CAEF,KAAK,MAAM,YACX,CAACihB,EAAW,MAAK,IAChB,CAAC,OAAO,cACR,OAAO,eAAiB,oBAEzB,KAAK,cAAgB,MAAM,KAAK,uBAAsB,EAEtD,KAAK,cAAgB,MAAM,KAAK,gBAAe,C,OAExCjhB,E,CACR,KAAK,QAAQ,8BAA8BA,GAAG,EAC9C,M,CAID,KAAK,aAAc,OAAK,cAAc,UAAM,0BAAE,SACzC,KAAK,cACT,KAAK,YAAe,OAAO,UAAU,cACpC,OAAO,UAAU,SAGd,qCAAqC,KAAK,KAAK,WAAW,EAC7D,KAAK,YAAc,KAAK,YAAY,OAAO,EAAG,CAAC,EAE9C,0CAA0C,KAAK,KAAK,WAAW,IAEhE,KAAK,YAAc,MAEpB,KAAK,cAAc,OAAO,SAAW,KAAK,cAE3C,UAAK,OAAM,cAAU,2BAAG,KAAK,UAAU,EAGvC,KAAK,OAAS,IACd,UAAK,OAAM,cAAU,2BAAG4gB,EAAS,SAAS,EAC1C,KAAK,aAAe,GAGf,KAAK,MAAM,oBAEL,KAAK,MAAM,WACrB,KAAK,QAAU,CAAC,EAEhB,KAAK,QAAU,CAAE,gBAAiB,KAAK,aAAa,EAJpD,KAAK,QAAU,MAAM,KAAK,WAAU,GAOrC,UAAK,OAAM,cAAU,2BAAGA,EAAS,KAAK,GACtC,UAAK,OAAM,WAAO,2BAAG,KAAK,OAAO,EAClC,GAKQ,cAAY,CACf,OAAO,SAAS,OAAO,SAAS,QAAQ,EAC3C,OAAO,SAAS,KAAO,GAAG,OAAO,SAAS,aAAa,OAAO,SAAS,OAAO,OAAO,SAAS,WAAW,OAAO,SAAS,SAAS,OAAO,SAAS,OAElJ,OAAO,SAAS,KAAO,GAAG,OAAO,SAAS,aAAa,OAAO,SAAS,OAAO,OAAO,SAAS,uBAAuB,OAAO,SAAS,SAAS,OAAO,SAAS,MAEhK,CAsBM,kBACF7G,EAG6C,gCAEhD,IAAI1Z,EACA4hB,EACAL,EAQJ,GAPI7H,EAAK,SAAW,EACnB,CAAC1Z,EAAI4hB,EAAQL,CAAE,EAAI7H,GAEnB,CAAC1Z,EAAIuhB,CAAE,EAAI7H,EACXkI,EAAS,IAGN,OAAOL,GAAO,WACjB,MAAM,IAAI,MAAM,8CAA8C,EAgB/D,GAbK,KAAK,iBAAiBvhB,GAS1B,CAAC,KAAK,iBAAiBA,GAAI,IAAI,SAASuhB,CAAE,GACzC,KAAK,iBAAiBvhB,GAAI,IAAI,KAAKuhB,CAAE,GATtC,KAAK,iBAAiBvhB,GAAM,CAC3B,IAAK,IAAI,Q,EAAO,iBAAcA,CAAE,CAAC,EACjC,IAAK,CAACuhB,CAAE,C,EAEL,KAAK,WAAavhB,IAAO,KAAK,aACjC,KAAK,QAAQ,KAAK,YAAaA,CAAE,GAO/B,KAAK,UAER,GAAI4hB,EAAQ,CACX,IAAIxQ,EACJ,GAAI,CACHA,EAAS,MAAM,KAAK,eAAepR,CAAE,C,OAC7BL,E,CACR,QAAQ,MACP,0BAA0BK,OAAQ,KAAK,UAAUL,CAAC,GAAG,C,CAGnDyR,GAAU,MACZmQ,EAAgCvhB,EAAIoR,CAAM,C,KAEtC,CACN,IAAI7H,EACJ,GAAI,CACHA,EAAS,MAAM,KAAK,iBAAiBvJ,CAAE,C,OAC/BL,E,CACR,QAAQ,MACP,4BAA4BK,OAAQ,KAAK,UAAUL,CAAC,GAAG,EAExD,M,CAED,GAAI4J,EACH,SAAW,CAACvJ,EAAI+U,CAAK,IAAK,OAAO,QAAQxL,CAAM,EAC7CgY,EAAmCvhB,EAAI+U,CAAK,C,CAKlD,GAOA,iBAAiB/U,EAAYuhB,EAAgC,CAC5D,GAAI,KAAK,iBAAiBvhB,GAAK,CAC9B,MAAM6hB,EAAM,KAAK,iBAAiB7hB,GAClC,GAAIuhB,EAAI,CACP,MAAM3c,EAAMid,EAAI,IAAI,QAAQN,CAAE,EAC9B3c,IAAQ,IAAMid,EAAI,IAAI,OAAOjd,EAAK,CAAC,C,MAEnCid,EAAI,IAAM,CAAC,GAGR,CAACA,EAAI,KAAO,CAACA,EAAI,IAAI,UACxB,OAAO,KAAK,iBAAiB7hB,GACzB,KAAK,WAAaA,IAAO,KAAK,aACjC,KAAK,QAAQ,KAAK,cAAeA,CAAE,E,CAIvC,CAOA,gBAAgBA,EAAYuhB,EAAuB,CAClD,OAAK,KAAK,kBAAkBvhB,GAO3B,CAAC,KAAK,kBAAkBA,GAAI,IAAI,SAASuhB,CAAE,GAC1C,KAAK,kBAAkBvhB,GAAI,IAAI,KAAKuhB,CAAE,GAPvC,KAAK,kBAAkBvhB,GAAM,CAC5B,IAAK,IAAI,Q,EAAO,iBAAcA,CAAE,CAAC,EACjC,IAAK,CAACuhB,CAAE,C,EAET,KAAK,WAAa,KAAK,QAAQ,KAAK,mBAAoBvhB,CAAE,GAKpD,QAAQ,QAAO,CACvB,CAWA,kBAAkBA,EAAYuhB,EAAuB,CACpD,GAAI,KAAK,kBAAkBvhB,GAAK,CAC/B,MAAM6hB,EAAM,KAAK,kBAAkB7hB,GACnC,GAAIuhB,EAAI,CACP,MAAM3c,EAAMid,EAAI,IAAI,QAAQN,CAAE,EAC9B3c,IAAQ,IAAMid,EAAI,IAAI,OAAOjd,EAAK,CAAC,C,MAEnCid,EAAI,IAAM,CAAC,EAGR,KAAK,YAAc,CAACA,EAAI,KAAO,CAACA,EAAI,IAAI,UAC3C,OAAO,KAAK,kBAAkB7hB,GAC9B,KAAK,WAAa,KAAK,QAAQ,KAAK,qBAAsBA,CAAE,E,CAG9D,OAAO,QAAQ,QAAO,CACvB,CAOQ,aAAaA,EAAYgF,EAAuC,C,QAIvE,IAAI8c,EACA,KAAK,QAAQ9hB,KAChB8hB,EAAS,CAAE,IAAK9hB,EAAI,KAAM,KAAK,QAAQA,GAAI,IAAI,GAGhD,IAAIsB,EAAU,GACV0D,GAIEA,EAAY,MAAQ,KAAK,QAAQhF,KACpC,KAAK,QAAQA,GAAY,KAAQgF,EAAY,OAK9C,CAAC,KAAK,QAAQhF,IACd,KAAK,UAAU,KAAK,QAAQA,EAAG,IAAM,KAAK,UAAUgF,CAAG,KAEvD,KAAK,QAAQhF,GAAMgF,EACnB1D,EAAU,KAED,KAAK,QAAQtB,KAEvB,OAAO,KAAK,QAAQA,GACpBsB,EAAU,IAIX,SAAW,CAAC4D,EAAK2c,CAAG,IAAK,OAAO,QAAQ,KAAK,iBAAiB,GACzD3c,IAAQlF,GAAM6hB,EAAI,IAAI,KAAK7hB,CAAE,IAChC6hB,EAAI,IAAI,QAASN,GAAM,CACtB,GAAI,CACHA,EAAGvhB,EAAIgF,EAAK8c,CAAM,C,OACVniB,E,CACR,QAAQ,MACP,sCAAsCA,GAAG,C,CAG5C,CAAC,EAKC2B,KAAS,UAAK,OAAM,kBAAc,2BAAGtB,EAAIgF,CAAG,EACjD,CAOQ,YAAYhF,EAAY+U,EAAwC,CACvE,UAAW8M,KAAO,OAAO,OAAO,KAAK,gBAAgB,EACpD,GAAIA,EAAI,IAAI,KAAK7hB,CAAE,EAClB,UAAWuhB,KAAMM,EAAI,IACpB,GAAI,CAEHN,EAAGvhB,EAAK+U,GAAK,KAALA,EAAS,IAAY,C,OACrBpV,E,CACR,QAAQ,MACP,sCAAsCA,GAAG,C,CAM/C,CAQQ,WAAWK,EAAY4K,EAAkBtN,EAAmB,CACnE,UAAWukB,KAAO,OAAO,OAAO,KAAK,eAAe,EACnD,GAAIA,EAAI,MAAM,KAAK7hB,CAAE,GAAK6hB,EAAI,eAAe,KAAKjX,CAAQ,EACzD,UAAW2W,KAAMM,EAAI,IACpB,GAAI,CACHN,EAAGvhB,EAAI4K,EAAUtN,CAAI,C,OACbqC,E,CACR,QAAQ,MAAM,oCAAoCA,GAAG,C,CAK1D,CAQM,eACLK,EACA+hB,EACAR,EAAqB,gCAErB,GAAI,OAAOA,GAAO,WACjB,MAAM,IAAI,MAAM,8CAA8C,EAE/D,MAAMxY,EAAM,GAAG/I,OAAQ+hB,IAElB,KAAK,gBAAgBhZ,GASzB,CAAC,KAAK,gBAAgBA,GAAK,IAAI,SAASwY,CAAE,GACzC,KAAK,gBAAgBxY,GAAK,IAAI,KAAKwY,CAAE,GATtC,KAAK,gBAAgBxY,GAAO,CAC3B,MAAO,IAAI,Q,EAAO,iBAAc/I,CAAE,CAAC,EACnC,eAAgB,IAAI,Q,EAAO,iBAAc+hB,CAAW,CAAC,EACrD,IAAK,CAACR,CAAE,C,EAET,KAAK,WACJ,KAAK,QAAQ,KAAK,iBAAkBvhB,EAAI+hB,CAAW,EAKtD,GAQA,iBACC/hB,EACA+hB,EACAR,EAAsB,CAEtB,MAAMxY,EAAM,GAAG/I,OAAQ+hB,IACvB,GAAI,KAAK,gBAAgBhZ,GAAM,CAC9B,MAAM8Y,EAAM,KAAK,gBAAgB9Y,GACjC,GAAIwY,EAAI,CACP,MAAM3c,EAAMid,EAAI,IAAI,QAAQN,CAAE,EAC9B3c,IAAQ,IAAMid,EAAI,IAAI,OAAOjd,EAAK,CAAC,C,MAEnCid,EAAI,IAAM,CAAC,GAGR,CAACA,EAAI,KAAO,CAACA,EAAI,IAAI,UACxB,OAAO,KAAK,gBAAgB9Y,GAC5B,KAAK,WACJ,KAAK,QAAQ,KAAK,mBAAoB/I,EAAI+hB,CAAW,E,CAGzD,CAGgB,QAAW,EASP,mCATO,CAC1B,SAAAC,EACA,YAAAC,EACA,eAAAC,EACA,UAAAC,EACA,aAAAC,EACA,gBAAAC,EAEA,SAAAC,CAAQ,EACW,CAInB,GAAIF,GAAgBxB,EAAW,MAAK,EACnC,OAAO,QAAQ,OAAOJ,EAAO,SAAS,EAIvC,GAAIwB,GAAY,CAACC,GAAeD,KAAY,KAAK,UAChD,OAAO,KAAK,UAAUA,GAIvB,GAAI,CAAC,KAAK,UACT,OAAO,QAAQ,OAAOxB,EAAO,aAAa,EAI3C,GAAI6B,GAAe,MAAfA,EAAiB,QACpB,UAAWE,KAAWF,EACrB,GAAI,EAAE,MAAM,KAAK,sBAAsBE,CAAO,GAC7C,MAAM/B,EAAO,cAKhB,MAAMgC,EAAU,IAAI,QAAW,CAAOzR,EAASmN,IAAU,wBACxD,MAAMuE,EAAiB,CACtB,QAAS,GACT,aAAc,IAAK,CAEnB,C,EAED,IAAI1D,EACAmD,IAAmB,KACtBnD,EAAU,WAAW,IAAK,CACzB0D,EAAe,QAAU,GAEzBN,GAAS,MAATA,EAAS,EACTjE,EAAOsC,EAAO,OAAO,CACtB,EAAG0B,GAAc,KAAdA,EAAkB,KAAK,MAAM,UAAU,EAC1CO,EAAe,aAAe,IAAK,CAClC,aAAa1D,CAAQ,CACtB,GAID,GAAI,CACH,MAAMuD,EAASvR,EAASmN,EAAQuE,CAAc,C,OACtC9iB,E,CACRue,EAAOve,CAAC,C,CAEV,EAAC,EACD,OAAIqiB,IACH,KAAK,UAAUA,GAAYQ,GAErBA,CACR,GAMA,WAAWzZ,EAAa2Z,EAAe,CAClCA,EACH,OAAO,KAAK,KAAK,SAAS,EACxB,OAAQvV,GAAMA,EAAE,WAAWpE,CAAG,CAAC,EAC/B,QAASoE,GAAK,CACd,OAAO,KAAK,UAAUA,EACvB,CAAC,EAEF,OAAO,KAAK,UAAUpE,EAExB,CAMA,UACC4Z,EAA2B,CAE3B,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC5R,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,YAAayE,EAAS,CAACzO,EAAK+L,IAAO,CACpD,KAAK,OAASA,GAAG,KAAHA,EAAO,CAAC,EAKlB/L,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ,KAAK,MAAM,CACpB,CAAC,CACF,C,CACA,CACF,CAMA,SAAS/Q,EAAU,CAClB,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC+Q,EAASmN,IAAU,CAC7B,GAAIle,GAAMA,IAAO,KAAK,YAAa,CAClC+Q,EAAQ,KAAK,UAAU/Q,IAAO,CAAE,IAAK,KAAM,IAAK,EAAI,CAAE,EACtD,M,CAED,KAAK,QAAQ,KAAK,WAAYA,EAAI,CAACkU,EAAKa,IAAS,CAC5Cb,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQgE,CAAK,CACd,CAAC,CACF,C,CACA,CACF,CAOA,eAAe/U,EAAU,CACxB,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC+Q,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,iBAAkBle,EAAI,CAACkU,EAAKa,IAAS,CAClDb,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQgE,CAAK,CACd,CAAC,CACF,C,CACA,CACF,CAQA,eAAe/U,EAAYoR,EAAc,CACxC,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACL,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,iBAAkBle,EAAIoR,EAAS8C,GAAO,CACnDA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CACF,C,CACA,CACF,CAQA,SACC/Q,EACA4iB,EACAC,EAAa,CAEb,OAAI,OAAOA,GAAQ,YAClBD,EAAM,CAAE,IAAAA,EAAiC,IAAAC,CAAG,GAGtC,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC9R,EAASmN,IAAU,CAE7B,GAAIle,GAAMA,IAAO,KAAK,YAAa,CAClC,IAAI+U,EAsBJ,GApBI,OAAO8N,GAAQ,WAGlB,OAAOD,GAAQ,UACdA,EAAuB,MAAQ,OAHhC7N,EAAQ6N,EAOR7N,EAAQ,CACP,IAAA6N,EACA,IAAK,GACL,GAAI,KAAK,IAAG,EACZ,GAAI,KAAK,IAAG,EACZ,KAAM,sB,EAIR,KAAK,UAAU5iB,GAAM+U,EAGjB,KAAK,iBAAiB/U,GACzB,UAAWuhB,KAAM,KAAK,iBAAiBvhB,GAAI,IAC1C,GAAI,CACHuhB,EAAGvhB,EAAI+U,CAAY,C,OACXpV,E,CACR,QAAQ,MACP,sCAAsCA,GAAG,C,CAK7CoR,EAAO,EACP,M,CAED,KAAK,QAAQ,KAAK,WAAY/Q,EAAI4iB,EAAM1O,GAAO,CAC1CA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CACF,C,CACA,CACF,CAWA,WACCiN,EACA8E,EAA+B,CAE/B,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC/R,EAASmN,IAAU,CAC7B,GAAI,CAACF,GAAU,KAAK,QAAS,CAC5BjN,EAAQ,KAAK,OAAO,EACpB,M,CAGD,KAAK,QAAQ,KACZ6P,EAAW,MAAK,EAAK,aAAe,gBACpC,CAAC1M,EAAK+L,IAAO,C,QACP6C,IACJ,UAAK,OAAM,cAAU,2BAAGvC,EAAS,cAAc,EAC5CrM,GAAKgK,EAAOhK,CAAG,EACnB,KAAK,QAAU+L,GAAG,KAAHA,EAAO,CAAC,EACvBlP,EAAQ,KAAK,OAAO,CACrB,CAAC,CAEH,C,CACA,CACF,CAMQ,WAAWgS,EAAiB,CAC/BA,GAAY,CAAC,KAAK,YACrB,KAAK,WAAa,GACd,KAAK,MAAM,gBACd,KAAK,MAAM,eAAe,QAAS/iB,GAClC,KAAK,QAAQ,KAAK,mBAAoBA,CAAE,CAAC,EAI3C,OAAO,KAAK,KAAK,iBAAiB,EAAE,QAASA,GAC5C,KAAK,QAAQ,KAAK,mBAAoBA,CAAE,CAAC,EAG1C,KAAK,MAAM,kBACV,KAAK,QAAQ,KAAK,aAAc,EAAI,EAErC,OAAO,KAAK,KAAK,gBAAgB,EAAE,QAASA,GAC3C,KAAK,QAAQ,KAAK,YAAaA,CAAE,CAAC,EAGnC,OAAO,KAAK,KAAK,eAAe,EAAE,QAAS+I,GAAO,CACjD,KAAM,CAAC/I,EAAI+hB,CAAW,EAAIhZ,EAAI,MAAM,KAAK,EACzC,KAAK,QAAQ,KAAK,iBAAkB/I,EAAI+hB,CAAW,CACpD,CAAC,GACS,CAACgB,GAAY,KAAK,aAC5B,KAAK,WAAa,GAEd,KAAK,MAAM,gBACd,KAAK,MAAM,eAAe,QAAS/iB,GAClC,KAAK,QAAQ,KAAK,qBAAsBA,CAAE,CAAC,EAG7C,OAAO,KAAK,KAAK,iBAAiB,EAAE,QAASA,GAC5C,KAAK,QAAQ,KAAK,qBAAsBA,CAAE,CAAC,EAG5C,KAAK,MAAM,kBACV,KAAK,QAAQ,KAAK,aAAc,EAAK,EAGtC,OAAO,KAAK,KAAK,gBAAgB,EAAE,QAASA,GAC3C,KAAK,QAAQ,KAAK,cAAeA,CAAE,CAAC,EAGrC,OAAO,KAAK,KAAK,eAAe,EAAE,QAAS+I,GAAO,CACjD,KAAM,CAAC/I,EAAI+hB,CAAW,EAAIhZ,EAAI,MAAM,KAAK,EACzC,KAAK,QAAQ,KAAK,mBAAoB/I,EAAI+hB,CAAW,CACtD,CAAC,EAEH,CAMA,WAAWiB,EAAkB,CAC5B,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACjS,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,aAAc8E,EAAY9O,GAAO,CAC9CA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CACF,C,CACA,CACF,CAOA,UAAU/Q,EAAYijB,EAAuB,GAAK,CACjD,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAClS,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,YAAale,EAAI,CAAE,YAAAijB,CAAW,EAAK/O,GAAO,CACvDA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CACF,C,CACA,CACF,CAOA,WAAW/Q,EAAYijB,EAAoB,CAC1C,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAClS,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,aAAcle,EAAI,CAAE,YAAAijB,CAAW,EAAK/O,GAAO,CACxDA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CACF,C,CACA,CACF,CAOA,UAAU/Q,EAAYgF,EAA4B,CACjD,OAAKA,GAILA,EAAM,KAAK,MAAM,KAAK,UAAUA,CAAG,CAAC,EACpC,OAAOA,EAAI,KACX,OAAOA,EAAI,KACX,OAAOA,EAAI,GAEJ,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC+L,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,YAAale,EAAIgF,EAAMkP,GAAO,CAC3CA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CACF,C,CACA,GAjBO,QAAQ,OAAO,4BAA4B,CAkBpD,CAOA,UAA4B/Q,EAAK,CAChC,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC+Q,EAASmN,IAAU,CAC7B,GAAIle,GAAMA,IAAO,KAAK,YAAa,CAClC+Q,EAAQ,CACP,IAAK,KAAK,YACV,KAAM,QACN,OAAQ,CACP,KAAM,gBACN,KAAM,O,EAEA,EACR,M,CAED,KAAK,QAAQ,KAAK,YAAa/Q,EAAI,CAACkU,EAAKlP,IAAO,CAC3CkP,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ/L,CAAU,CACnB,CAAC,CACF,C,CACA,CACF,CAQA,OAAgB2V,EAAkBuI,EAAiBlE,EAAU,CAC5D,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAWjO,GAAW,CACrB,KAAK,QAAQ,KACZ,SACA4J,EACAuI,EACAlE,EACC/Y,GAAe,CACf8K,EAAQ9K,CAAM,CACf,CAAC,CAEH,C,CACA,CACF,CAOA,aAAajG,EAAYgF,EAA2B,CACnD,OAAKA,GAILA,EAAM,KAAK,MAAM,KAAK,UAAUA,CAAG,CAAC,EACpC,OAAOA,EAAI,KACX,OAAOA,EAAI,KACX,OAAOA,EAAI,GAEJ,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC+L,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,eAAgBle,EAAIgF,EAAMkP,GAAO,CAC9CA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CACF,C,CACA,GAjBO,QAAQ,OAAO,4BAA4B,CAkBpD,CAMA,mBAAmBoS,EAAkC,CAC/C,KAAK,cAAc,SAASA,CAAO,GACvC,KAAK,cAAc,KAAKA,CAAO,CAEjC,CAMA,qBAAqBA,EAAkC,CACtD,MAAMve,EAAM,KAAK,cAAc,QAAQue,CAAO,EAC9Cve,IAAQ,IAAM,KAAK,cAAc,OAAOA,EAAK,CAAC,CAC/C,CAMA,0BAA0Bue,EAAqC,CACzD,KAAK,qBAAqB,SAASA,CAAO,GAC9C,KAAK,qBAAqB,KAAKA,CAAO,CAExC,CAMA,4BAA4BA,EAAqC,CAChE,MAAMve,EAAM,KAAK,qBAAqB,QAAQue,CAAO,EACrDve,IAAQ,IAAM,KAAK,qBAAqB,OAAOA,EAAK,CAAC,CACtD,CAMA,yBACCue,EAA2C,CAE3C,KAAK,mBAAqBA,CAC3B,CAKA,4BAA0B,CACzB,KAAK,mBAAqB,MAC3B,CAMA,yBACCA,EAA2C,CAE3C,KAAK,mBAAqBA,CAC3B,CAKA,4BAA0B,CACzB,KAAK,mBAAqB,MAC3B,CAMA,uBACCA,EAA+C,CAE/C,KAAK,iBAAmBA,CACzB,CAKA,0BAAwB,CACvB,KAAK,iBAAmB,MACzB,CAOA,SACCC,EACApF,EAAgB,CAEhB,OAAO,KAAK,QAAQ,CACnB,SAAU,SAASoF,GAAS,QAC5B,YAAapF,EAEb,eAAgB,GAChB,SAAU,CAACjN,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,gBACA,SACA,OACA,CACC,SAAU,QAAQkF,GAAS,KAC3B,OAAQA,EAAQ,QAAQA,WAAiB,a,EAE1C,CAAClP,EAAK+L,IAAO,CACR/L,GAAKgK,EAAOhK,CAAG,EACnB,MAAMmP,EAA4C,CAAC,EACnD,GAAIpD,EACH,QAASlT,EAAI,EAAGA,EAAIkT,EAAI,KAAK,OAAQlT,IAEnCqW,GACAnD,EAAI,KAAKlT,GAAG,KAAO,QAAQqW,MAI5BC,EAAKpD,EAAI,KAAKlT,GAAG,IAAMkT,EAAI,KAAKlT,GAC9B,OAGJgE,EAAQsS,CAAI,CACb,CAAC,CAEH,C,CACA,CACF,CAUA,cACCra,EACAsa,EACA9S,EAAO,CAEP,OAAO,KAAK,oBAAoB,SAAUA,EAAMxH,EAAOsa,CAAG,CAC3D,CAQA,oBACC9S,EACAxH,EACAsa,EAAY,CAEZ,OAAO,KAAK,oBAAoB,SAAU9S,EAAMxH,EAAOsa,CAAG,CAC3D,CASA,oBACCC,EACA/S,EACAxH,EACAsa,EAAY,CAEZ,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACvS,EAASmN,IAAU,CAC7BlV,EAAQA,GAAS,GACjBsa,EAAMA,GAAO,SAEb,KAAK,QAAQ,KACZ,gBACAC,EACA/S,EACA,CAAE,SAAUxH,EAAO,OAAQsa,CAAG,EAC9B,CAACpP,EAAK+L,IAAO,CACR/L,GAAKgK,EAAOhK,CAAG,EAEnB,MAAMmP,EAGF,CAAC,EACL,GAAIpD,GAAOA,EAAI,KACd,QAASlT,EAAI,EAAGA,EAAIkT,EAAI,KAAK,OAAQlT,IACpCsW,EAAKpD,EAAI,KAAKlT,GAAG,IAAMkT,EAAI,KAAKlT,GAAG,MAGrCgE,EAAQsS,CAAI,CACb,CAAC,CAEH,C,CACA,CACF,CAKA,eAAa,CACZ,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACtS,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,gBACA,SACA,OACA,CAAE,SAAU,GAAI,OAAQ,QAAQ,EAChC,CAAChK,EAAKsP,IAAQ,C,MACTtP,GAAKgK,EAAOhK,CAAG,EACnBnD,GACC,EAAAyS,EAAM,QAAI,0BACP,IAAKxe,GAAQA,EAAI,KAAK,EACvB,OAAQ4d,GAAgC,CAAC,CAACA,CAAG,CAAC,CAElD,CAAC,CAEH,C,CACA,CACF,CAOA,QACCa,EACA/D,EAAY,CAEZ,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC3O,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,UACAuF,EACA/D,EACA,CAACxL,EAAKiK,IAAS,CACVjK,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQoN,CAAM,CACf,CAAC,CAEH,C,CACA,CACF,CASA,SACCsF,EACA7Y,EACAwG,EAAgB,CAEhB,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACL,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ9M,EAAS,aAAe,WACxBqS,EACA7Y,EACA,CAACsJ,EAAK8K,EAAMxO,IAAQ,CACf0D,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ,CAAE,KAAMiO,EAAgB,SAAUxO,CAAK,CAAE,CAClD,CAAC,CAEH,C,CACA,CACF,CAQA,YACC4N,EACAxT,EACAoU,EAAqB,CAErB,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACjO,EAASmN,IAAU,CAC7B,GAAI,OAAOc,GAAS,SACnB,KAAK,QAAQ,KACZ,YACAZ,EACAxT,EACAoU,EACC9K,GAAO,CACHA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,MAEI,CACN,MAAMK,EAAS,KACd,IAAI,WAAW4N,CAAI,EAAE,OACpB,CAACA,EAAM0E,IAAS1E,EAAO,OAAO,aAAa0E,CAAI,EAC/C,EAAE,CACF,EAGF,KAAK,QAAQ,KACZ,cACAtF,EACAxT,EACAwG,EACC8C,GAAO,CACHA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,C,CAGJ,C,CACA,CACF,CAOA,WAAWqN,EAAiBxT,EAAgB,CAC3C,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACmG,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,aAAcE,EAASxT,EAAWsJ,GAAO,CACtDA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CACF,C,CACA,CACF,CAOA,aAAaqN,EAAiBC,EAAkB,CAC/C,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACtN,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,eACAE,EACAC,EACCnK,GAAO,CACHA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,CACR,CAAC,CAEH,C,CACA,CACF,CASA,QACC0M,EACAyB,EACAC,EACAF,EAAmB,CAEnB,OAAO,KAAK,QAAQ,CACnB,eAAgBA,EAChB,SAAU,CAAClO,EAASmN,EAAQa,IAAW,CACtCtB,G,EAAO,mBAAgBA,CAAI,EAE3B,KAAK,QAAQ,KAAK,UAAWA,EAAM0B,EAAOD,EAAMhL,GAAO,CAClD6K,EAAQ,UACZA,EAAQ,aAAY,EAEhB7K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAO,EACR,CAAC,CACF,C,CACA,CACF,CAMA,gBAAgBiN,EAAgB,CAC/B,OAAO,KAAK,QAAQ,CACnB,SAAU,eACV,YAAaA,EAEb,eAAgB,GAChB,SAAiBjN,GAAW,wB,cAC3B,IAAIsP,EAAe,MAAM,KAAK,UAAU,eAAe,GACvD,EAACA,KAAoB,mBAApBA,EAAyB,CAAC,IAC3B,KAACA,GAAqB,UAAM,qBAAN,OAAW,CAAC,IAClC,KAACA,GAAqB,UAAM,qBAAN,OAAW,CAAC,GAElCtP,EAAQsP,CAAa,CACtB,E,CACA,CACF,CAGA,uBAAuBrC,EAAgB,CACtC,OAAO,KAAK,QAAQ,CACnB,SAAU,qBACV,YAAaA,EAEb,eAAgB,GAChB,aAAc,GACd,SAAU,CAACjN,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,yBACA,CAAChK,EAAKmM,IAAgB,C,cACjBnM,GAAKgK,EAAOhK,CAAG,GACnB,EAACmM,KAAoB,mBAApBA,EAAyB,CAAC,IAC3B,KAACA,GAAqB,UAAM,qBAAN,OAAW,CAAC,IAClC,KAACA,GAAqB,UAAM,qBAAN,OAAW,CAAC,GAClCtP,EAAQsP,CAAa,CACtB,CAAC,CAEH,C,CACA,CACF,CAMA,iBACCsC,EAAmC,CAEnC,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC5R,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,mBACAyE,GAAW,IACX,CAACzO,EAAK3K,IAAU,CACX2K,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQxH,GAAM,KAANA,EAAU,CAAC,CAAC,CACrB,CAAC,CAEH,C,CACA,CACF,CAOA,kBACCoZ,EACAnS,EAAO,CAEP,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACO,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,oBACAyE,GAAW,IACXnS,EACA,CAAC0D,EAAKnQ,IAAW,CACZmQ,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQhN,CAAc,CACvB,CAAC,CAEH,C,CACA,CACF,CAMA,gBACCiB,EAAwD,CAExD,OAAO,KAAK,UAAU,gBAAiBA,CAAG,CAC3C,CAKA,cAAY,CACX,OAAO,KAAK,OACb,CAOA,WACChF,EACAiE,EAAmC,CAEnC,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC8M,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,aAAcle,EAAIiE,EAAS,CAACiQ,EAAKyP,IAAU,CACxDzP,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ4S,CAAO,CAChB,CAAC,CACF,C,CACA,CACF,CAOA,aACC3jB,EACAiE,EAAmC,CAMnC,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAAC8M,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,aACAle,EACAiE,EACA,CAACiQ,EAAKyP,EAAQC,EAAYC,IAAa,CAClC3P,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ,CACP,OAAA4S,EACA,UAAAE,EAEA,WAAAD,C,CACA,CACF,CAAC,CAEH,C,CACA,CACF,CAOA,eAAenG,EAAcO,EAAgB,CAC5C,OAAAP,G,EAAO,mBAAgBA,CAAI,EACpB,KAAK,QAAQ,CACnB,SAAU,OAAOA,IACjB,YAAaO,EAEb,eAAgB,GAChB,SAAiBjN,GAAW,wB,MAC3B,MAAM/L,EAAM,MAAM,KAAK,UAAUyY,CAAI,EACrC1M,GAAQ,EAAA/L,GAAG,YAAHA,EAAK,OAAO,WAAO,mBAAI,CAAC,CAAC,CAClC,E,CACA,CACF,CAKA,WACCgZ,EAAgB,CAEhB,OAAO,KAAK,QAAQ,CACnB,SAAU,UACV,YAAaA,EAEb,eAAgB,GAChB,SAAU,CAACjN,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,aAAc,CAAChK,EAAK4P,EAASC,IAAc,CAG3D7P,GACA,CAAC4P,GACD,OAAO5P,GAAQ,UACfA,EAAI,MAAM,eAAe,EAEzBnD,EAAQ,CAAE,QAASmD,EAAK,WAAY,UAAU,CAAE,GAE5CA,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ,CAAE,QAAA+S,EAAmB,WAAAC,CAAuB,CAAE,EAExD,CAAC,CACF,C,CACA,CACF,CAKA,kBAAgB,CACf,OAAO,KAAK,QAAQ,CACnB,SAAU,UAEV,eAAgB,GAChB,SAAU,CAAChT,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,iBAAkB,CAAChK,EAAKhR,IAAQ,CAC7CgR,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ7N,CAAK,CACd,CAAC,CACF,C,CACA,CACF,CAOA,WAAWkb,EAAiBrO,EAAgB,CAC3C,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAU,CAACgB,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,aACAE,EACArO,EACA,CAACmE,EAAK8P,IAAU,CACX9P,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQ,CAAC,CAACiT,CAAM,CACjB,CAAC,CAEH,C,CACA,CACF,CAKA,gBAAc,CACb,OAAO,KAAK,QAAQ,CAEnB,eAAgB,GAChB,SAAWjT,GAAW,CACrB,KAAK,QAAQ,KAAK,cAAe,CAACkT,EAAW3e,IAAQ,CACpDyL,EAAQzL,CAAI,CACb,CAAC,CACF,C,CACA,CACF,CAKA,SAAO,CACN,OAAO,KAAK,QAAQ,CACnB,SAAU,OAEV,eAAgB,GAChB,SAAiByL,GAAW,wB,MAC3B,MAAM/L,EAAM,MAAM,KAAK,UAAU,kBAAkB,EACnD+L,GAAQ,EAAA/L,GAAG,YAAHA,EAAK,UAAM,0BAAE,IAAI,CAC1B,E,CACA,CACF,CAOA,sBAAsBud,EAAiBvE,EAAgB,CACtD,OAAO,KAAK,QAAQ,CACnB,SAAU,qBAAqBuE,IAC/B,YAAavE,EAEb,eAAgB,GAChB,SAAU,CAACjN,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,wBACAqE,EACA,CAACrO,EAAKgQ,IAAY,CACbhQ,GAAKgK,EAAOhK,CAAG,EACnBnD,EAAQmT,CAAQ,CACjB,CAAC,CAEH,C,CACA,CACF,CAWA,oBACC9F,EACAJ,EAAgB,CAEhB,OAAI,OAAOI,GAAY,YACtBJ,EAASI,EACTA,EAAU,IAEXA,EAAUA,GAAW,GAEd,KAAK,QAAQ,CACnB,SAAU,aAAaA,IACvB,YAAaJ,EAEb,eAAgB,GAChB,SAAiBjN,GAAW,wBAC3B,MAAMoT,EAAW/F,EACd,kBAAkBA,KAClB,kBACGgG,EAAS,GAAGD,UAEZhE,EAAY,MAAM,KAAK,oBAC5B,WACAgE,EACAC,CAAM,EAEDC,EAAkB,OAAO,OAAOlE,CAAS,EAE9CpP,EADGqN,EAEFiG,EAAgB,OACd5I,GAAMA,EAAE,OAAO,OAAS2C,CAAO,EAI1BiG,CAHN,CAKJ,E,CACA,CACF,CAOA,YACCjG,EACAJ,EAAgB,CAEhB,OAAI,OAAOI,GAAY,YACtBJ,EAASI,EACTA,EAAU,IAEXA,EAAUA,GAAW,GAEd,KAAK,QAAQ,CACnB,SAAU,WAAWA,IACrB,YAAaJ,EAEb,eAAgB,GAChB,SAAiBjN,GAAW,wBAC3B,MAAMqP,EAAW,MAAM,KAAK,oBAC3B,UACA,kBAAkBhC,GAAW,KAC7B,kBAAkBA,GAAW,UAAU,EAElCkG,EAAiB,OAAO,OAAOlE,CAAQ,EAE5CrP,EADGqN,EAEFkG,EAAe,OAAQ7I,GAAMA,EAAE,OAAO,OAAS2C,CAAO,EAG/CkG,CAHgD,CAK1D,E,CACA,CACF,CAMA,UAAUtG,EAAgB,CACzB,OAAO,KAAK,QAAQ,CACnB,SAAU,SACV,YAAaA,EAEb,eAAgB,GAChB,SAAU,CAACjN,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KACZ,gBACA,SACA,QACA,CACC,SAAU,gBACV,OAAQ,qB,EAET,CAAChK,EAAKpE,IAAO,CACRoE,EACHgK,EAAOhK,CAAG,EAEVnD,G,EACC,8BACCjB,CAAG,CACH,CAGJ,CAAC,CAEH,C,CACA,CACF,CAMA,QAAM,CACL,OAAO,KAAK,QAAQ,CACnB,eAAgB,GAChB,SAAU,CAACiB,EAASmN,IAAU,CAC7B,KAAK,QAAQ,KAAK,SAAWhK,GAAO,CACnCA,EAAMgK,EAAOhK,CAAG,EAAInD,EAAQ,IAAI,CACjC,CAAC,CACF,C,CACA,CACF,CAQA,IAAIjN,EAAcygB,EAAc,CAC/B,OAAOzgB,EACJ,KAAK,QAAQ,CACb,eAAgB,GAChB,SAAWiN,IACV,KAAK,QAAQ,KAAK,MAAOjN,EAAMygB,CAAK,EAC7BxT,EAAQ,IAAI,E,CAEnB,EACD,QAAQ,QAAQ,IAAI,CACxB,CAOA,iBAAiB/Q,EAAU,CAC1B,KAAK,YAAcA,CACpB,C,gXChtED,mB,yaCKA,K,kDAAM,SAAUwkB,GAAqB,CACpC,IAAIvE,EACAwE,EAEJ,MAAMjC,EAAU,IAAI,QAAW,CAACzR,EAASmN,IAAU,CAClD+B,EAAMlP,EACN0T,EAAMvG,CACP,CAAC,EAED,OAAAsE,EAAQ,QAAUvC,EAClBuC,EAAQ,OAASiC,EAEVjC,CACR,C,qaClBA,K,mBAAc,OAAsB,EAApC,WACA,IAAc,OAAiB,EAD/B,WAEA,IAAc,OAAsB,EAFpC,U,yaCAA,K,qIAAM,SAAUkC,EACf5U,EAIY,C,MAEZ,OACC,EAAAA,GAAG,YAAHA,EAAK,KAAK,IAAKrQ,GAASA,EAAK,KAAK,EAAE,OAAQmjB,GAAkB,CAAC,CAACA,CAAG,KAAC,mBACpE,CAAC,CAEH,CAGM,SAAU+B,EAAgBlH,EAAY,CAC3C,OAAKA,EAAK,WAAW,cAAc,IAClCA,EAAO,eAAeA,KAEhBA,CACR,CAEM,SAAUmH,EAAmB5kB,EAAU,CAC5C,OAAIA,EAAG,WAAW,cAAc,IAC/BA,EAAKA,EAAG,OAAO,EAAqB,GAE9BA,CACR,CAKM,SAAU6kB,EAAKC,EAAU,CAC9B,OAAO,IAAI,QAAe/T,GAAW,CACpC,WAAWA,EAAS+T,CAAE,CACvB,CAAC,CACF,CAGM,SAAUC,EAAcpC,EAAe,CAC5CA,GAAWA,GAAW,IAAI,SAAQ,EAElC,MAAMqC,EAAqBrC,EAAQ,KAAO,IACpCsC,EAAmBtC,EAAQA,EAAQ,OAAS,KAAO,IAEzD,OAAAA,EAAUA,EACR,QAAQ,uBAAwB,MAAM,EACtC,QAAQ,MAAO,IAAI,GAGnBqC,EAAqB,GAAK,KAC3BrC,GACCsC,EAAmB,GAAK,IAE3B,C","file":"static/js/vendors-node_modules_iobroker_adapter-react-v5_Components_Loader_js-node_modules_iobroker_ada-03b047.cd1db5a1.chunk.js","sourcesContent":["/**\n * Copyright 2018-2022 bluefox <dogafox@gmail.com>\n *\n * MIT License\n *\n **/\nimport React from 'react';\nimport PropTypes from 'prop-types';\n// import './loader.css'\nconst loaderStyles = `\n/**\n * Copyright 2018-2022 bluefox <dogafox@gmail.com>\n *\n * MIT License\n *\n **/\n\n.logo-background-light, .logo-background-colored {\n    background: white;\n}\n.logo-background-dark, .logo-background-blue {\n    background: black;\n}\n.logo-div {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    -ms-transform: translateX(-50%) translateY(-50%);\n    -webkit-transform: translate(-50%,-50%);\n    transform: translate(-50%,-50%);\n    overflow: hidden;\n    border-radius: 50%;\n    z-index: 2;\n}\n.logo-border {\n    /*border-color: #164477;*/\n    border-top-color: #3399CC;\n    border-left-color: #164477;\n    border-bottom-color: #164477;\n    border-right-color: #164477;\n    border-radius: 50%;\n    border-style: solid;\n    box-sizing: border-box;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n}\n.logo-top {\n    position: absolute;\n    width: 4.5%;\n    height: 16%;\n    top: 0;\n    z-index: 2;\n}\n.logo-i {\n    position: absolute;\n    width: 14.5%;\n    height: 60%;\n    top: 20%;\n    left: 42%;\n    background: #3399CC;\n}\n.logo-i-top {\n    position: absolute;\n    width: 14.5%;\n    height: 4%;\n    left: 42%;\n    background: #3399CC;\n    border-radius: 100%;\n}\n.logo-back {\n    width: 100%;\n    height: 100%;\n    z-index: 0;\n    overflow: hidden;\n}\n@keyframes logo-grow {\n    0% {\n        width: 230px;\n        height: 230px;\n        transform: translate(-50%,-50%) scale(1);\n        opacity: 1\n    }\n    99% {\n        width: 230px;\n        height: 230px;\n        transform: translate(-50%,-50%) scale(10);\n        opacity: 0;\n    }\n    100% {\n        width: 0;\n        height: 0;\n        opacity: 0;\n    }\n}\n@keyframes logo-spin { 100% { -webkit-transform: rotate(360deg); transform: rotate(360deg); } }\n@keyframes logo-color-inside-light {\n    0% {\n        background: #FEFEFE;\n    }\n    100% {\n        background: #3399CC;\n    }\n}\n@keyframes logo-color-inside-dark {\n    0% {\n        background: #030303;\n    }\n    100% {\n        background: #3399CC;\n    }\n}\n@keyframes logo-color-inside-colored {\n    0% {\n        background: #FEFEFE;\n    }\n    100% {\n        background: #3399CC;\n    }\n}\n@keyframes logo-color-inside-blue {\n    0% {\n        background: #030303;\n    }\n    100% {\n        background: #3399CC;\n    }\n}\n\n@keyframes logo-color-outside-light {\n    0% {\n        border-color: #FEFEFE;\n    }\n    100% {\n        border-top-color: #3399CC;\n        border-left-color: #164477;\n        border-bottom-color: #164477;\n        border-right-color: #164477;\n    }\n}\n@keyframes logo-color-outside-dark  {\n    0% {\n        border-color: #040404;\n    }\n    100% {\n        border-top-color: #3399CC;\n        border-left-color: #164477;\n        border-bottom-color: #164477;\n        border-right-color: #164477;\n    }\n}\n@keyframes logo-color-outside-colored {\n    0% {\n        border-color: #FEFEFE;\n    }\n    100% {\n        border-top-color: #3399CC;\n        border-left-color: #164477;\n        border-bottom-color: #164477;\n        border-right-color: #164477;\n    }\n}\n@keyframes logo-color-outside-blue  {\n    0% {\n        border-color: #040404;\n    }\n    100% {\n        border-top-color: #3399CC;\n        border-left-color: #164477;\n        border-bottom-color: #164477;\n        border-right-color: #164477;\n    }\n}\n\n.logo-animate-wait {\n    animation: logo-color-outside 1.5s, logo-spin 1.5s linear infinite;\n}\n\n.logo-animate-grow-light {\n    background: #DDD;\n}\n.logo-animate-grow-dark {\n    background: #1d1d1d;\n}\n.logo-animate-grow-colored {\n    background: #DDD;\n}\n.logo-animate-grow-blue {\n    background: #1d1d1d;\n}\n\n.logo-animate-grow {\n    display: inline-block;\n    text-align: center;\n    z-index: 1;\n    top: 50%;\n    left: 50%;\n    -ms-transform: translateX(-50%) translateY(-50%);\n    -webkit-transform: translate(-50%,-50%);\n    transform: translate(-50%,-50%);\n    width: 245px;\n    height: 245px;\n    border-radius: 50%;\n    position: absolute;\n    animation: logo-grow 1s 1 ease forwards;\n}\n\n.logo-animate-color-inside-light {\n    animation: logo-color-inside-light 2.5s;\n}\n.logo-animate-color-inside-dark {\n    animation: logo-color-inside-dark 2.5s;\n}\n.logo-animate-color-inside-colored {\n    animation: logo-color-inside-colored 2.5s;\n}\n.logo-animate-color-inside-blue {\n    animation: logo-color-inside-blue 2.5s;\n}\n\n.logo-animate-color-outside-light {\n    animation: logo-color-outside-light 1.5s;\n}\n.logo-animate-color-outside-dark {\n    animation: logo-color-outside-dark 1.5s;\n}\n.logo-animate-color-outside-colored {\n    animation: logo-color-outside-colored 1.5s;\n}\n.logo-animate-color-outside-blue {\n    animation: logo-color-outside-blue 1.5s;\n}\n`;\n\n/**\n * @typedef {object} LoaderProps\n * @property {number} [size] The size in pixels of this loader.\n * @property {string} [themeType] The chosen theme type.\n * @property {string} [theme] The chosen theme.\n *\n * @extends {React.Component<LoaderProps>}\n */\nclass Loader extends React.Component {\n    constructor(props) {\n        super(props);\n\n        if (!window.document.getElementById('loader-iobroker-component')) {\n            const style = window.document.createElement('style');\n            style.setAttribute('id', 'loader-iobroker-component');\n            style.innerHTML = loaderStyles;\n            window.document.head.appendChild(style);\n        }\n    }\n\n    render() {\n        const size = this.props.size || 234;\n        const theme = this.props.themeType || this.props.theme || 'light';\n        return <div className={'logo-back logo-background-' + theme}\n            style={{\n                backgroundImage: window.loadingBackgroundImage && window.loadingBackgroundImage !== '@@loginBackgroundImage@@' ? 'url(' + window.loadingBackgroundImage + ')' : undefined,\n                backgroundColor: window.loadingBackgroundColor && window.loadingBackgroundColor !== '@@loginBackgroundColor@@' ? window.loadingBackgroundColor : undefined,\n                backgroundSize: 'cover',\n            }}\n        >\n            {window.loadingHideLogo === 'true' ?\n                null\n                :\n                <>\n                    <div className=\"logo-div\" style={{ width: size, height: size }}>\n                        <div className={'logo-top logo-background-' + theme} style={{ left: '37%' }}/>\n                        <div className={'logo-top logo-background-' + theme} style={{ left: '57%' }}/>\n                        <div\n                            className={`logo-border logo-background-${theme} logo-animate-wait`}\n                            style={{ borderWidth: size * 0.132 }}\n                        />\n                        <div className={'logo-i logo-animate-color-inside-' + theme}/>\n                        <div className={'logo-i-top logo-animate-color-inside-' + theme} style={{ top: '18%' }}/>\n                        <div className={'logo-i-top logo-animate-color-inside-' + theme} style={{ bottom: '18%' }}/>\n                    </div>\n                    <div className={'logo-animate-grow logo-animate-grow-' + theme}\n                    style={{ width: size + 11, height: size + 11 }}\n                    />\n                </>\n            }\n        </div>;\n    }\n}\n\nLoader.propTypes = {\n    size: PropTypes.number,\n    themeType: PropTypes.string\n};\n\n/** @type {typeof Loader} */\nconst _export = Loader;\nexport default _export;","// please do not delete React, as without it other projects could not be compiled: ReferenceError: React is not defined\nimport React from 'react';\n\n/**\n * @template P Type of the properties object.\n * @template S Type of the internal state object.\n * @extends {React.Component<P, S>}\n */\nclass Router extends React.Component {\n    /**\n     * @param {P} props The React properties of this component.\n     */\n    constructor(props) {\n        super(props);\n        this.onHashChangedBound = this.onHashChanged.bind(this);\n    }\n\n    componentDidMount() {\n        window.addEventListener('hashchange', this.onHashChangedBound);\n    }\n\n    componentWillUnmount() {\n        window.removeEventListener('hashchange', this.onHashChangedBound);\n    }\n\n    onHashChanged() {\n        // override this function\n    }\n\n    /**\n     * Gets the location object.\n     * @returns {{ tab: string; dialog: string; id: string; arg: string; }}\n     */\n    static getLocation() {\n        let hash = window.location.hash;\n        hash = hash.replace(/^#/, '');\n        const parts = hash.split('/').map(item => {\n            try {\n                return item ? decodeURIComponent(item) : ''\n            } catch (e) {\n                console.error('Router: Cannot decode ' + item);\n                return item || '';\n            }\n        });\n        // #tabName/dialogName/deviceId\n        return {\n            tab:    parts[0] || '',\n            dialog: parts[1] || '',\n            id:     parts[2] || '',\n            arg:    parts[3] || ''\n        };\n    }\n\n    /**\n     * Navigate to a new location. Any parameters that are not set will be taken from the current location.\n     * @param {string | undefined} [tab]\n     * @param {string | undefined} [dialog]\n     * @param {string | undefined} [id]\n     * @param {string | undefined} [arg]\n     */\n    static doNavigate(tab, dialog, id, arg) {\n        let hash = '';\n        const location = Router.getLocation();\n        if (arg !== undefined && !id) {\n            id = location.id;\n        }\n        if (id && !dialog) {\n            dialog = location.dialog;\n        }\n        if (dialog && !tab) {\n            tab = location.tab;\n        } else\n        if (tab === null) {\n            tab = location.tab;\n        }\n\n        if (tab) {\n            hash = '#' + tab;\n            if (dialog) {\n                hash += '/' + dialog;\n\n                if (id) {\n                    hash += '/' + id;\n                    if (arg !== undefined) {\n                        hash += '/' + arg;\n                    }\n                }\n            }\n        }\n        if (window.location.hash !== hash) {\n            window.location.hash = hash;\n        }\n    }\n}\n\nexport default Router;","// please do not delete React, as without it other projects could not be compiled: ReferenceError: React is not defined\nimport React from 'react';\nimport withStyles from '@mui/styles/withStyles';\nimport Fab from '@mui/material/Fab';\nimport PropTypes from 'prop-types';\n\nimport Toolbar from '@mui/material/Toolbar';\n\nimport I18n from '../i18n';\n\nimport IconSave from '@mui/icons-material/Save';\nimport IconClose from '@mui/icons-material/Close';\n\nconst styles = theme => ({\n    buttonIcon: {\n        marginRight: 8\n    },\n});\n\n/**\n * @typedef {object} SaveCloseButtonsProps\n * @property {boolean} noTextOnButtons Are the buttons without text\n * @property {any} theme Theme object (from this.state.theme)\n * @property {boolean} isIFrame bottom position 0 or 38 for iFrame\n * @property {boolean} newReact is used in new react\n * @property {function} onSave on Save handler\n * @property {function} onClose on Close handler\n *\n * @extends {React.Component<SaveCloseButtonsProps>}\n */\nclass SaveCloseButtons extends React.Component {\n    /**\n     * @param {SaveCloseButtonsProps} props\n     */\n    constructor(props) {\n        super(props);\n        const newReact = props.newReact === undefined ? true : props.newReact;\n\n        try {\n            this.isIFrame = !newReact && window.self !== window.top;\n        } catch (e) {\n            this.isIFrame = !newReact;\n        }\n    }\n\n    render() {\n        const noTextOnButtons = this.props.noTextOnButtons;\n        const buttonStyle = {\n            borderRadius: this.props.theme.saveToolbar.button.borderRadius || 3,\n            height:       this.props.theme.saveToolbar.button.height       || 32,\n        };\n\n        const style = {\n            bottom: this.isIFrame ? 38 : 0,\n            left: this.props.paddingLeft || 0,\n            right: 0,\n            position: 'absolute',\n            background: this.props.theme.saveToolbar.background\n        };\n        if (this.props.dense) {\n            style.minHeight = 48;\n        }\n\n        if (this.props.error) {\n            buttonStyle.border = '1px solid red';\n        }\n\n        return <Toolbar position=\"absolute\" style={style}>\n            <Fab\n                variant=\"extended\"\n                aria-label=\"Save\"\n                disabled={!this.props.changed || this.props.error}\n                onClick={() => this.props.onSave(false)}\n                style={buttonStyle}\n            >\n                <IconSave className={!noTextOnButtons ? this.props.classes.buttonIcon : ''}/>{!noTextOnButtons && I18n.t('ra_Save')}\n            </Fab>\n            <Fab\n                variant=\"extended\"\n                aria-label=\"Save and close\"\n                disabled={!this.props.changed || this.props.error}\n                onClick={() => this.props.onSave(true)}\n                style={Object.assign({}, buttonStyle, {marginLeft: 10})}>\n                <IconSave className={!noTextOnButtons ? this.props.classes.buttonIcon : ''}/>\n                {!noTextOnButtons ? I18n.t('ra_Save and close') : '+'}\n                {noTextOnButtons && <IconClose/>}\n            </Fab>\n            <div style={{flexGrow: 1}}/>\n            <Fab variant=\"extended\" aria-label=\"Close\" onClick={() => this.props.onClose()} style={buttonStyle}>\n                <IconClose className={!noTextOnButtons ? this.props.classes.buttonIcon : ''}/>{!noTextOnButtons && I18n.t('ra_Close')}\n            </Fab>\n        </Toolbar>;\n    }\n}\n\nSaveCloseButtons.propTypes = {\n    dense: PropTypes.bool,\n    paddingLeft: PropTypes.number,\n    noTextOnButtons: PropTypes.bool,\n    theme: PropTypes.object,\n    isIFrame: PropTypes.bool,\n    changed: PropTypes.bool.isRequired,\n    error: PropTypes.bool,\n    onSave: PropTypes.func.isRequired,\n    onClose: PropTypes.func.isRequired,\n    newReact: PropTypes.bool,\n};\n\n/** @type {typeof SaveCloseButtons} */\nconst _export = withStyles(styles)(SaveCloseButtons);\nexport default _export;","/**\n * Copyright 2018-2022 bluefox <dogafox@gmail.com>\n *\n * MIT License\n *\n **/\nimport React from 'react';\nimport copy from './copy-to-clipboard';\nimport I18n from '../i18n';\n\nconst NAMESPACE    = 'material';\nconst days         = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];\nconst months       = ['Jan', 'Feb', 'Mar', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\nconst QUALITY_BITS = {\n    0x00: '0x00 - good',\n\n    0x01: '0x01 - general problem',\n    0x02: '0x02 - no connection problem',\n\n    0x10: '0x10 - substitute value from controller',\n    0x20: '0x20 - substitute initial value',\n    0x40: '0x40 - substitute value from device or instance',\n    0x80: '0x80 - substitute value from sensor',\n\n    0x11: '0x11 - general problem by instance',\n    0x41: '0x41 - general problem by device',\n    0x81: '0x81 - general problem by sensor',\n\n    0x12: '0x12 - instance not connected',\n    0x42: '0x42 - device not connected',\n    0x82: '0x82 - sensor not connected',\n\n    0x44: '0x44 - device reports error',\n    0x84: '0x84 - sensor reports error',\n};\nconst SIGNATURES = {\n    JVBERi0: 'pdf',\n    R0lGODdh: 'gif',\n    R0lGODlh: 'gif',\n    iVBORw0KGgo: 'png',\n    '/9j/': 'jpg',\n    PHN2Zw: 'svg',\n    Qk1: 'bmp',\n    AAABAA: 'ico' // 00 00 01 00 according to https://en.wikipedia.org/wiki/List_of_file_signatures\n};\n\nclass Utils {\n    static namespace = NAMESPACE;\n    static INSTANCES = 'instances';\n    static dateFormat = ['DD', 'MM'];\n    static FORBIDDEN_CHARS = /[^._\\-/ :!#$%&()+=@^{}|~\\p{Ll}\\p{Lu}\\p{Nd}]+/gu;\n\n    /**\n     * Capitalize words.\n     * @param {string | undefined} name\n     * @returns {string}\n     */\n    static CapitalWords(name) {\n        return (name || '').split(/[\\s_]/)\n            .filter(item => item)\n            .map(word => word ? word[0].toUpperCase() + word.substring(1).toLowerCase() : '')\n            .join(' ');\n    }\n\n    static formatSeconds(seconds) {\n        const days = Math.floor(seconds / (3600 * 24));\n        seconds %= 3600 * 24;\n        let hours = Math.floor(seconds / 3600);\n        if (hours < 10) {\n            hours = '0' + hours;\n        }\n        seconds %= 3600;\n        let minutes = Math.floor(seconds / 60);\n        if (minutes < 10) {\n            minutes = '0' + minutes;\n        }\n        seconds %= 60;\n        seconds = Math.floor(seconds);\n        if (seconds < 10) {\n            seconds = '0' + seconds;\n        }\n        let text = '';\n        if (days) {\n            text += `${days} ${I18n.t('ra_daysShortText')} `;\n        }\n        text += `${hours}:${minutes}:${seconds}`;\n\n        return text;\n    }\n\n    /**\n     * Get the name of the object by id from the name or description.\n     * @param {Record<string, ioBroker.Object>} objects\n     * @param {string} id\n     * @param {{ name: any; } | ioBroker.Languages | null} settings\n     * @param {{ language?: ioBroker.Languages; }} options\n     * @param {boolean} [isDesc] Set to true to get the description.\n     * @returns {string}\n     */\n    static getObjectName(objects, id, settings, options, isDesc) {\n        let item = objects[id];\n        let text = id;\n        const attr = isDesc ? 'desc' : 'name';\n\n        if (typeof settings === 'string' && !options) {\n            options = {language: settings};\n            settings = null;\n        }\n\n        options = options || {};\n        if (!options.language) {\n            options.language = (objects['system.config'] && objects['system.config'].common && objects['system.config'].common.language) || window.sysLang || 'en';\n        }\n        if (settings && settings.name) {\n            text = settings.name;\n            if (typeof text === 'object') {\n                text = text[options.language] || text.en;\n            }\n        } else\n        if (item && item.common && item.common[attr]) {\n            text = item.common[attr];\n            if (attr !== 'desc' && !text && item.common.desc) {\n                text = item.common.desc;\n            }\n            if (typeof text === 'object') {\n                text = text[options.language] || text.en || text.de || text.ru || '';\n            }\n            text = (text || '').toString().replace(/[_.]/g, ' ');\n\n            if (text === text.toUpperCase()) {\n                text = text[0] + text.substring(1).toLowerCase();\n            }\n        } else {\n            let pos = id.lastIndexOf('.');\n            text = id.substring(pos + 1).replace(/[_.]/g, ' ');\n            text = Utils.CapitalWords(text);\n        }\n\n        return text.trim();\n    }\n\n    /**\n     * Get the name of the object from the name or description.\n     * @param {ioBroker.PartialObject} obj\n     * @param {{ name: any; } | ioBroker.Languages | null } settings or language\n     * @param {{ language?: ioBroker.Languages; } } options\n     * @param {boolean} [isDesc] Set to true to get the description.\n     * @param {boolean} [noTrim] Allow to use spaces in name (by edit)\n     * @returns {string}\n     */\n    static getObjectNameFromObj(obj, settings, options, isDesc, noTrim) {\n        let item = obj;\n        let text = (obj && obj._id) || '';\n        const attr = isDesc ? 'desc' : 'name';\n\n        if (typeof settings === 'string' && !options) {\n            options = {language: settings};\n            settings = null;\n        }\n\n        options = options || {};\n\n        if (settings && settings.name) {\n            text = settings.name;\n            if (typeof text === 'object') {\n                text = text[options.language] || text.en;\n            }\n        } else\n        if (item && item.common && item.common[attr]) {\n            text = item.common[attr];\n            if (attr !== 'desc' && !text && item.common.desc) {\n                text = item.common.desc;\n            }\n            if (typeof text === 'object') {\n                text = text[options.language] || text.en;\n            }\n            text = (text || '').toString().replace(/[_.]/g, ' ');\n\n            if (text === text.toUpperCase()) {\n                text = text[0] + text.substring(1).toLowerCase();\n            }\n        }\n        return noTrim ? text : text.trim();\n    }\n\n    /**\n     * @param {ioBroker.PartialObject | ioBroker.ObjectCommon} obj\n     * @param {string} forEnumId\n     * @param {{ user: string; }} options\n     * @returns {string | null}\n     */\n    static getSettingsOrder(obj, forEnumId, options) {\n        if (obj && obj.hasOwnProperty('common')) {\n            obj = obj.common;\n        }\n        let settings;\n        if (obj && obj.custom) {\n            settings = (obj.custom || {})[NAMESPACE];\n            const user = options.user || 'admin';\n            if (settings && settings[user]) {\n                if (forEnumId) {\n                    if (settings[user].subOrder && settings[user].subOrder[forEnumId]) {\n                        return JSON.parse(JSON.stringify(settings[user].subOrder[forEnumId]));\n                    }\n                } else {\n                    if (settings[user].order) {\n                        return JSON.parse(JSON.stringify(settings[user].order));\n                    }\n                }\n            }\n        }\n        return null;\n    }\n\n    /**\n     * @param {ioBroker.PartialObject | ioBroker.ObjectCommon} obj\n     * @param {string} forEnumId\n     * @param {{ user: string; }} options\n     */\n    static getSettingsCustomURLs(obj, forEnumId, options) {\n        if (obj && obj.hasOwnProperty('common')) {\n            obj = obj.common;\n        }\n        let settings;\n        if (obj && obj.custom) {\n            settings = (obj.custom || {})[NAMESPACE];\n            const user = options.user || 'admin';\n            if (settings && settings[user]) {\n                if (forEnumId) {\n                    if (settings[user].subURLs && settings[user].subURLs[forEnumId]) {\n                        return JSON.parse(JSON.stringify(settings[user].subURLs[forEnumId]));\n                    }\n                } else {\n                    if (settings[user].URLs) {\n                        return JSON.parse(JSON.stringify(settings[user].URLs));\n                    }\n                }\n            }\n        }\n        return null;\n    }\n\n    /**\n     * Reorder the array items in list between source and dest.\n     * @param {Iterable<any> | ArrayLike<any>} list\n     * @param {number} source\n     * @param {number} dest\n     */\n    static reorder(list, source, dest) {\n        const result = Array.from(list);\n        const [removed] = result.splice(source, 1);\n        result.splice(dest, 0, removed);\n        return result;\n    };\n\n    /**\n     * @param {any} obj\n     * @param {{ id: any; user: any; name: any; icon: any; color: any; language: ioBroker.Languages; }} options\n     * @param {boolean} [defaultEnabling]\n     */\n    static getSettings(obj, options, defaultEnabling) {\n        let settings;\n        const id = (obj && obj._id) || (options && options.id);\n        if (obj && obj.hasOwnProperty('common')) {\n            obj = obj.common;\n        }\n        if (obj && obj.custom) {\n            settings = obj.custom || {};\n            settings = settings[NAMESPACE] && settings[NAMESPACE][options.user || 'admin'] ? JSON.parse(JSON.stringify(settings[NAMESPACE][options.user || 'admin'])) : {enabled: true};\n        } else {\n            settings = {enabled: defaultEnabling === undefined ? true : defaultEnabling, useCustom: false};\n        }\n\n        if (!settings.hasOwnProperty('enabled')) {\n            settings.enabled = defaultEnabling === undefined ? true : defaultEnabling;\n        }\n\n        if (false && settings.useCommon) {\n            if (obj.color) settings.color = obj.color;\n            if (obj.icon)  settings.icon  = obj.icon;\n            if (obj.name)  settings.name  = obj.name;\n        } else {\n            if (options) {\n                if (!settings.name  && options.name)  settings.name  = options.name;\n                if (!settings.icon  && options.icon)  settings.icon  = options.icon;\n                if (!settings.color && options.color) settings.color = options.color;\n            }\n\n            if (obj) {\n                if (!settings.color && obj.color) settings.color = obj.color;\n                if (!settings.icon  && obj.icon)  settings.icon  = obj.icon;\n                if (!settings.name  && obj.name)  settings.name  = obj.name;\n            }\n        }\n\n        if (typeof settings.name === 'object') {\n            settings.name = settings.name[options.language] || settings.name.en;\n\n            settings.name = (settings.name || '').toString().replace(/_/g, ' ');\n\n            if (settings.name === settings.name.toUpperCase()) {\n                settings.name = settings.name[0] + settings.name.substring(1).toLowerCase();\n            }\n        }\n        if (!settings.name && id) {\n            let pos = id.lastIndexOf('.');\n            settings.name = id.substring(pos + 1).replace(/[_.]/g, ' ');\n            settings.name = (settings.name || '').toString().replace(/_/g, ' ');\n            settings.name = Utils.CapitalWords(settings.name);\n        }\n\n        return settings;\n    }\n\n    /**\n     * @param {any} obj\n     * @param {any} settings\n     * @param {{ user: any; language: ioBroker.Languages; }} options\n     */\n    static setSettings(obj, settings, options) {\n        if (obj) {\n            obj.common = obj.common || {};\n            obj.common.custom = obj.common.custom || {};\n            obj.common.custom[NAMESPACE] = obj.common.custom[NAMESPACE] || {};\n            obj.common.custom[NAMESPACE][options.user || 'admin'] = settings;\n            const s = obj.common.custom[NAMESPACE][options.user || 'admin'];\n            if (s.useCommon) {\n                if (s.color !== undefined) {\n                    obj.common.color = s.color;\n                    delete s.color;\n                }\n                if (s.icon !== undefined) {\n                    obj.common.icon = s.icon;\n                    delete s.icon;\n                }\n                if (s.name !== undefined) {\n                    if (typeof obj.common.name !== 'object') {\n                        obj.common.name = {};\n                        obj.common.name[options.language] = s.name;\n                    } else{\n                        obj.common.name[options.language] = s.name;\n                    }\n                    delete s.name;\n                }\n            }\n\n            return true;\n        } else {\n            return false;\n        }\n    }\n\n    /**\n     * Get the icon for the given settings.\n     * @param {{ icon: string | undefined; name: string | undefined; prefix: string | undefined}} settings\n     * @param {any} style\n     * @returns {JSX.Element | null}\n     */\n    static getIcon(settings, style) {\n        if (settings && settings.icon) {\n            // If UTF-8 icon\n            if (settings.icon.length <= 2) {\n                return <span style={style || {}}>{settings.icon}</span>;\n            } else\n            if (settings.icon.startsWith('data:image')) {\n                return <img alt={settings.name} src={settings.icon} style={style || {}}/>;\n            } else { // may be later some changes for second type\n                return <img alt={settings.name} src={(settings.prefix || '') + settings.icon} style={style || {}}/>;\n            }\n        }\n        return null;\n    }\n\n    /**\n     * Get the icon for the given object.\n     * @param {string} id\n     * @param {{ common: { icon: any; }; }} obj\n     * @returns {string | null}\n     */\n    static getObjectIcon(id, obj) {\n        // If id is Object\n        if (typeof id === 'object') {\n            obj = id;\n            id = obj._id;\n        }\n\n        if (obj && obj.common && obj.common.icon) {\n            let icon = obj.common.icon;\n            // If UTF-8 icon\n            if (typeof icon === 'string' && icon.length <= 2) {\n                return icon;\n            } else\n            if (icon.startsWith('data:image')) {\n                return icon;\n            } else {\n                const parts = id.split('.');\n                if (parts[0] === 'system') {\n                    icon = 'adapter/' + parts[2] + (icon.startsWith('/') ? '' : '/') + icon;\n                } else {\n                    icon = 'adapter/' + parts[0] + (icon.startsWith('/') ? '' : '/') + icon;\n                }\n\n                if (window.location.pathname.match(/adapter\\/[^/]+\\/[^/]+\\.html/)) {\n                    icon = '../../' + icon;\n                } else if (window.location.pathname.match(/material\\/[.\\d]+/)) {\n                    icon = '../../' + icon;\n                } else\n                if (window.location.pathname.match(/material\\//)) {\n                    icon = '../' + icon;\n                }\n                return icon;\n            }\n        } else {\n            return null;\n        }\n    }\n\n    /**\n     * Splits CamelCase into words.\n     * @param {string | undefined} text\n     * @returns {string}\n     */\n    static splitCamelCase(text) {\n        if (false && text !== text.toUpperCase()) {\n            const words = text.split(/\\s+/);\n            for (let i = 0; i < words.length; i++) {\n                let word = words[i];\n                if (word.toLowerCase() !== word && word.toUpperCase() !== word) {\n                    let z = 0;\n                    const ww = [];\n                    let start = 0;\n                    while (z < word.length) {\n                        if (word[z].match(/[A-ZÜÄÖА-Я]/)) {\n                            ww.push(word.substring(start, z));\n                            start = z;\n                        }\n                        z++;\n                    }\n                    if (start !== z) {\n                        ww.push(word.substring(start, z));\n                    }\n                    for (let k = 0; k < ww.length; k++) {\n                        words.splice(i + k, 0, ww[k]);\n                    }\n                    i += ww.length;\n                }\n            }\n\n            return words.map(w => {\n                w = w.trim();\n                if (w) {\n                    return w[0].toUpperCase() + w.substring(1).toLowerCase();\n                }\n                return '';\n            }).join(' ');\n        } else {\n            return Utils.CapitalWords(text);\n        }\n    }\n\n    /**\n     * Check if the given color is bright.\n     * https://stackoverflow.com/questions/35969656/how-can-i-generate-the-opposite-color-according-to-current-color\n     * @param {string | null | undefined} color\n     * @param {boolean} [defaultValue]\n     * @returns {boolean}\n     */\n    static isUseBright(color, defaultValue) {\n        if (color === null || color === undefined || color === '') {\n            return defaultValue === undefined ? true : defaultValue;\n        }\n        color = color.toString();\n        if (color.indexOf('#') === 0) {\n            color = color.slice(1);\n        }\n        let r;\n        let g;\n        let b;\n\n        const rgb = color.match(/^rgba?[\\s+]?\\([\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?,[\\s+]?(\\d+)[\\s+]?/i);\n        if (rgb && rgb.length === 4) {\n            r = parseInt(rgb[1], 10);\n            g = parseInt(rgb[2], 10);\n            b = parseInt(rgb[3], 10);\n        } else {\n            // convert 3-digit hex to 6-digits.\n            if (color.length === 3) {\n                color = color[0] + color[0] + color[1] + color[1] + color[2] + color[2];\n            }\n            // remove alfa channel\n            if (color.length === 8) {\n                color = color.substring(0, 6);\n            } else\n            if (color.length !== 6) {\n                return false;\n            }\n\n            r = parseInt(color.slice(0, 2), 16);\n            g = parseInt(color.slice(2, 4), 16);\n            b = parseInt(color.slice(4, 6), 16);\n        }\n\n        // http://stackoverflow.com/a/3943023/112731\n        return (r * 0.299 + g * 0.587 + b * 0.114) <= 186;\n    };\n\n    /**\n     * Get the time string in the format 00:00.\n     * @param {string | number} seconds\n     */\n    static getTimeString(seconds) {\n        seconds = parseFloat(seconds);\n        if (isNaN(seconds)) {\n            return '--:--';\n        }\n        const hours = Math.floor(seconds / 3600);\n        let minutes = Math.floor((seconds % 3600) / 60);\n        let secs = seconds % 60;\n        if (hours) {\n            if (minutes < 10) minutes = '0' + minutes;\n            if (secs < 10) secs = '0' + secs;\n            return hours + ':' + minutes + ':' + secs;\n        } else {\n            if (secs < 10) secs = '0' + secs;\n            return minutes + ':' + secs;\n        }\n    }\n\n    /**\n     * Gets the wind direction with the given angle (degrees).\n     * @param {number} angle in degrees.\n     * @returns {string | undefined}\n     */\n    static getWindDirection(angle) {\n        if (angle >= 0 && angle < 11.25) {\n            return 'N'\n        } else if (angle >= 11.25 && angle < 33.75) {\n            return 'NNE'\n        } else if (angle >= 33.75 && angle < 56.25) {\n            return 'NE'\n        } else if (angle >= 56.25 && angle < 78.75) {\n            return 'ENE'\n        } else if (angle >= 78.75 && angle < 101.25) {\n            return 'E'\n        } else if (angle >= 101.25 && angle < 123.75) {\n            return 'ESE'\n        } else if (angle >= 123.75 && angle < 146.25) {\n            return 'SE'\n        } else if (angle >= 146.25 && angle < 168.75) {\n            return 'SSE'\n        } else if (angle >= 168.75 && angle < 191.25) {\n            return 'S'\n        } else if (angle >= 191.25 && angle < 213.75) {\n            return 'SSW'\n        } else if (angle >= 213.75 && angle < 236.25) {\n            return 'SW'\n        } else if (angle >= 236.25 && angle < 258.75) {\n            return 'WSW'\n        } else if (angle >= 258.75 && angle < 281.25) {\n            return 'W'\n        } else if (angle >= 281.25 && angle < 303.75) {\n            return 'WNW'\n        } else if (angle >= 303.75 && angle < 326.25) {\n            return 'NW'\n        } else if (angle >= 326.25 && angle < 348.75) {\n            return 'NNW'\n        } else if (angle >= 348.75) {\n            return 'N'\n        }\n    }\n\n    /**\n     * Pad the given number with a zero if its not 2 digits long.\n     * @param {string | number} num\n     */\n    static padding(num) {\n        if (typeof num === 'string') {\n            if (num.length < 2) {\n                return '0' + num;\n            } else {\n                return num;\n            }\n        } else if (num < 10) {\n            return '0' + num;\n        } else {\n            return num;\n        }\n    }\n\n    /**\n     * Sets the date format.\n     * @param {string} format\n     */\n    static setDataFormat(format) {\n        if (format) {\n            Utils.dateFormat = format.toUpperCase().split(/[.-/]/);\n            Utils.dateFormat.splice(Utils.dateFormat.indexOf('YYYY'), 1);\n        }\n    }\n\n    /**\n     * Converts the date to a string.\n     * @param {string | number | Date} now\n     * @returns {string}\n     */\n    static date2string(now) {\n        if (typeof now === 'string') {\n            now = now.trim();\n            if (!now) return '';\n            // only letters\n            if (now.match(/^[\\w\\s]+$/)) {\n                // Day of week\n                return now;\n            }\n            let m = now.match(/(\\d{1,4})[-./](\\d{1,2})[-./](\\d{1,4})/);\n            if (m) {\n                let a = [parseInt(m[1], 10), parseInt(m[2], 10), parseInt(m[3], 10)];\n                let year = a.find(y => y > 31);\n                a.splice(a.indexOf(year), 1);\n                let day = a.find(m => m > 12);\n                if (day) {\n                    a.splice(a.indexOf(day), 1);\n                    now = new Date(year, a[0] - 1, day);\n                } else {\n                    // MM DD\n                    if (Utils.dateFormat[0][0] === 'M' && Utils.dateFormat[1][0] === 'D') {\n                        now = new Date(year, a[0] - 1, a[1]);\n                        if (Math.abs(now.getTime - Date.now()) > 3600000 * 24 * 10) {\n                            now = new Date(year, a[1] - 1, a[0]);\n                        }\n                    } else\n                    // DD MM\n                    if (Utils.dateFormat[0][0] === 'D' && Utils.dateFormat[1][0] === 'M') {\n                        now = new Date(year, a[1] - 1, a[0]);\n                        if (Math.abs(now.getTime - Date.now()) > 3600000 * 24 * 10) {\n                            now = new Date(year, a[0] - 1, a[1]);\n                        }\n                    } else {\n                        now = new Date(now);\n                    }\n                }\n            } else {\n                now = new Date(now);\n            }\n        } else {\n            now = new Date(now);\n        }\n\n        let date = I18n.t('ra_dow_' + days[now.getDay()]).replace('ra_dow_', '');\n        date += '. ' + now.getDate() + ' ' + I18n.t('ra_month_' + months[now.getMonth()]).replace('ra_month_', '');\n        return date;\n    }\n\n    /**\n     * Render a text as a link.\n     * @param {string} text\n     * @returns {string | JSX.Element[]}\n     */\n    static renderTextWithA(text) {\n        let m = text.match(/<a [^<]+<\\/a>|<br\\/?>|<b>[^<]+<\\/b>|<i>[^<]+<\\/i>/);\n        if (m) {\n            const result = [];\n            let key = 1;\n            do {\n                const start = text.substring(0, m.index);\n                text = text.substring(m.index + m[0].length);\n                start && result.push(<span key={`a${key++}`}>{start}</span>);\n\n                if (m[0].startsWith('<b>')) {\n                    result.push(<b key={`a${key++}`}>{m[0].substring(3, m[0].length - 4)}</b>);\n                } else if (m[0].startsWith('<i>')) {\n                    result.push(<i key={`a${key++}`}>{m[0].substring(3, m[0].length - 4)}</i>);\n                } else if (m[0].startsWith('<br')) {\n                    result.push(<br key={`a${key++}`} />);\n                } else {\n                    let href = m[0].match(/href=\"([^\"]+)\"/) || m[0].match(/href='([^']+)'/);\n                    let target = m[0].match(/target=\"([^\"]+)\"/) || m[0].match(/target='([^']+)'/);\n                    let rel = m[0].match(/rel=\"([^\"]+)\"/) || m[0].match(/rel='([^']+)'/);\n                    const title = m[0].match(/>([^<]*)</);\n\n                    // eslint-disable-next-line\n                    result.push(<a\n                        key={`a${key++}`}\n                        href={href ? href[1] : ''}\n                        target={target ? target[1] : '_blank'}\n                        rel={rel ? rel[1] : ''}\n                        style={{ color: 'inherit' }}\n                    >\n                        {title ? title[1] : ''}\n                    </a>);\n                }\n\n                m = text && text.match(/<a [^<]+<\\/a>|<br\\/?>|<b>[^<]+<\\/b>|<i>[^<]+<\\/i>/);\n                if (!m) {\n                    text && result.push(<span key={'a' + (key++)}>{text}</span>);\n                }\n            } while (m);\n\n            return result;\n        } else {\n            return text;\n        }\n    }\n\n    /**\n     * Get the smart name of the given state.\n     * @param {Record<string, ioBroker.StateObject> | ioBroker.StateObject} states\n     * @param {string} id\n     * @param {string} instanceId\n     * @param {boolean} [noCommon]\n     */\n    static getSmartName(states, id, instanceId, noCommon) {\n        if (!id) {\n            if (!noCommon) {\n                if (!states.common) {\n                    return states.smartName;\n                } else {\n                    if (states && !states.common) {\n                        return states.smartName;\n                    } else {\n                        return states.common.smartName;\n                    }\n                }\n            } else {\n                if (states && !states.common) {\n                    return states.smartName;\n                } else {\n                    return (states &&\n                        states.common &&\n                        states.common.custom &&\n                        states.common.custom[instanceId]) ?\n                        states.common.custom[instanceId].smartName : undefined;\n                }\n            }\n        } else\n        if (!noCommon) {\n            return states[id].common.smartName;\n        } else {\n            return (states[id] &&\n                states[id].common &&\n                states[id].common.custom &&\n                states[id].common.custom[instanceId]) ?\n                states[id].common.custom[instanceId].smartName || null : null;\n        }\n    }\n\n    /**\n     * Get the smart name from a state.\n     * @param {ioBroker.StateObject} obj\n     * @param {string} instanceId\n     * @param {boolean} [noCommon]\n     */\n    static getSmartNameFromObj(obj, instanceId, noCommon) {\n        if (!noCommon) {\n            if (!obj.common) {\n                return obj.smartName;\n            } else {\n                if (obj && !obj.common) {\n                    return obj.smartName;\n                } else {\n                    return obj.common.smartName;\n                }\n            }\n        } else {\n            if (obj && !obj.common) {\n                return obj.smartName;\n            } else {\n                return (obj &&\n                    obj.common &&\n                    obj.common.custom &&\n                    obj.common.custom[instanceId]) ?\n                    obj.common.custom[instanceId].smartName : undefined;\n            }\n        }\n    }\n\n    /**\n     * Enable smart name for a state.\n     * @param {ioBroker.StateObject} obj\n     * @param {string} instanceId\n     * @param {boolean} [noCommon]\n     */\n    static enableSmartName(obj, instanceId, noCommon) {\n        if (noCommon) {\n            obj.common.custom = obj.common.custom || {};\n            obj.common.custom[instanceId] = obj.common.custom[instanceId] || {};\n            obj.common.custom[instanceId].smartName = {};\n        } else {\n            obj.common.smartName = {};\n        }\n    }\n\n    /**\n     * Completely remove smart name from a state.\n     * @param {ioBroker.StateObject} obj\n     * @param {string | number} instanceId\n     * @param {boolean} [noCommon]\n     */\n    static removeSmartName(obj, instanceId, noCommon) {\n        if (noCommon) {\n            if (obj.common && obj.common.custom && obj.common.custom[instanceId]) {\n                obj.common.custom[instanceId] = null;\n            }\n        } else {\n            obj.common.smartName = null;\n        }\n    }\n\n    /**\n     * Update the smartname of a state.\n     * @param {ioBroker.StateObject} obj\n     * @param {string} newSmartName\n     * @param {string | undefined} byON\n     * @param {string | undefined} smartType\n     * @param {string} instanceId\n     * @param {boolean} [noCommon]\n     */\n    static updateSmartName(obj, newSmartName, byON, smartType, instanceId, noCommon) {\n        const language = I18n.getLanguage();\n\n        // convert Old format\n        if (typeof obj.common.smartName === 'string') {\n            const nnn = obj.common.smartName;\n            obj.common.smartName = {};\n            obj.common.smartName[language] = nnn;\n        }\n\n        // convert old settings\n        if (obj.native && obj.native.byON) {\n            delete obj.native.byON;\n            let _smartName = obj.common.smartName;\n\n            if (!_smartName || typeof _smartName !== 'object') {\n                _smartName = {en: _smartName};\n                _smartName[language] = _smartName.en;\n            }\n            obj.common.smartName = _smartName;\n        }\n        if (smartType !== undefined) {\n            if (noCommon) {\n                obj.common.custom = obj.common.custom || {};\n                obj.common.custom[instanceId] = obj.common.custom[instanceId] || {};\n                obj.common.custom[instanceId].smartName = obj.common.custom[instanceId].smartName || {};\n                if (!smartType) {\n                    delete obj.common.custom[instanceId].smartName.smartType;\n                } else {\n                    obj.common.custom[instanceId].smartName.smartType = smartType;\n                }\n            } else {\n                obj.common.smartName = obj.common.smartName || {};\n                if (!smartType) {\n                    delete obj.common.smartName.smartType;\n                } else {\n                    obj.common.smartName.smartType = smartType;\n                }\n\n            }\n        }\n        if (byON !== undefined) {\n            if (noCommon) {\n                obj.common.custom = obj.common.custom || {};\n                obj.common.custom[instanceId] = obj.common.custom[instanceId] || {};\n                obj.common.custom[instanceId].smartName = obj.common.custom[instanceId].smartName || {};\n                obj.common.custom[instanceId].smartName.byON = byON;\n            } else {\n                obj.common.smartName = obj.common.smartName || {};\n                obj.common.smartName.byON = byON;\n            }\n        }\n        if (newSmartName !== undefined) {\n            let smartName;\n            if (noCommon) {\n                obj.common.custom = obj.common.custom || {};\n                obj.common.custom[instanceId] = obj.common.custom[instanceId] || {};\n                obj.common.custom[instanceId].smartName = obj.common.custom[instanceId].smartName || {};\n                smartName = obj.common.custom[instanceId].smartName;\n            } else {\n                obj.common.smartName = obj.common.smartName || {};\n                smartName = obj.common.smartName;\n            }\n            smartName[language] = newSmartName;\n\n            // If smart name deleted\n            if (smartName && (!smartName[language] ||\n                (smartName[language] === obj.common.name &&\n                    (!obj.common.role || obj.common.role.indexOf('button') >= 0)))) {\n                delete smartName[language];\n                let empty = true;\n                // Check if structure has any definitions\n                for (const key in smartName) {\n                    if (smartName.hasOwnProperty(key)) {\n                        empty = false;\n                        break;\n                    }\n                }\n                // If empty => delete smartName completely\n                if (empty) {\n                    if (noCommon) {\n                        if (obj.common.custom[instanceId].smartName.byON === undefined) {\n                            delete obj.common.custom[instanceId];\n                        } else {\n                            delete obj.common.custom[instanceId].en;\n                            delete obj.common.custom[instanceId].de;\n                            delete obj.common.custom[instanceId].ru;\n                            delete obj.common.custom[instanceId].nl;\n                            delete obj.common.custom[instanceId].pl;\n                            delete obj.common.custom[instanceId].it;\n                            delete obj.common.custom[instanceId].fr;\n                            delete obj.common.custom[instanceId].pt;\n                            delete obj.common.custom[instanceId].es;\n                            delete obj.common.custom[instanceId]['zh-cn'];\n                        }\n                    } else {\n                        if (obj.common.smartName.byON !== undefined) {\n                            delete obj.common.smartName.en;\n                            delete obj.common.smartName.de;\n                            delete obj.common.smartName.ru;\n                            delete obj.common.smartName.nl;\n                            delete obj.common.smartName.pl;\n                            delete obj.common.smartName.it;\n                            delete obj.common.smartName.fr;\n                            delete obj.common.smartName.pt;\n                            delete obj.common.smartName.es;\n                            delete obj.common.smartName['zh-cn'];\n                        } else {\n                            obj.common.smartName = null;\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * Disable the smart name of a state.\n     * @param {ioBroker.StateObject} obj\n     * @param {string} instanceId\n     * @param {boolean} [noCommon]\n     */\n    static disableSmartName(obj, instanceId, noCommon) {\n        if (noCommon) {\n            obj.common.custom = obj.common.custom || {};\n            obj.common.custom[instanceId] = obj.common.custom[instanceId] || {};\n            obj.common.custom[instanceId].smartName = false;\n        } else {\n            obj.common.smartName = false;\n        }\n    }\n\n    /**\n     * Copy text to the clipboard.\n     * @param {string} text\n     * @param {Event} [e]\n     */\n    static copyToClipboard(text, e) {\n        e && e.stopPropagation();\n        e && e.preventDefault()\n        return copy(text);\n    }\n\n    /**\n     * Gets the extension of a file name.\n     * @param {string | null} [fileName] the file name.\n     * @returns {string | null} The extension in lower case.\n     */\n    static getFileExtension(fileName) {\n        const pos = (fileName || '').lastIndexOf('.');\n        if (pos !== -1) {\n            return fileName.substring(pos + 1).toLowerCase();\n        } else {\n            return null;\n        }\n    }\n\n    /**\n     * Format number of bytes as a string with B, KB, MB or GB.\n     * The base for all calculations is 1024.\n     * @param {number} bytes The number of bytes.\n     * @returns {string} The formatted string (e.g. '723.5 KB')\n     */\n    static formatBytes(bytes) {\n        if (Math.abs(bytes) < 1024) {\n            return bytes + ' B';\n        }\n\n        const units = ['KB','MB','GB'];\n        //const units = ['KiB','MiB','GiB','TiB','PiB','EiB','ZiB','YiB'];\n        let u = -1;\n\n        do {\n            bytes /= 1024;\n            ++u;\n        } while (Math.abs(bytes) >= 1024 && u < units.length - 1);\n\n        return bytes.toFixed(1) + ' ' + units[u];\n    }\n\n    /**\n     * Invert the given color according to theme type to get the inverted text color for background\n     * @param {string} color Color in the format '#rrggbb' or '#rgb' (or without hash)\n     * @param {string} themeType theme type\n     * @param {string} invert dark theme has light color in control or light theme has light color in control\n     * @returns {string}\n     */\n    static getInvertedColor(color, themeType, invert) {\n        if (!color) {\n            return undefined;\n        } else {\n            const invertedColor = Utils.invertColor(color, true);\n            if (invertedColor === '#FFFFFF' && (themeType === 'dark' || (invert && themeType === 'light'))) {\n                return '#DDD';\n            } else\n            if (invertedColor === '#000000' && (themeType === 'light' || (invert && themeType === 'dark'))) {\n                return '#222';\n            } else {\n                return undefined;\n            }\n        }\n    }\n\n    // Big thanks to: https://stackoverflow.com/questions/35969656/how-can-i-generate-the-opposite-color-according-to-current-color\n    /**\n     * Invert the given color\n     * @param {string} hex Color in the format '#rrggbb' or '#rgb' (or without hash)\n     * @param {boolean} bw Set to black or white.\n     * @returns {string}\n     */\n    static invertColor(hex, bw) {\n        if (hex === undefined || hex === null || hex === '' || typeof hex !== 'string') {\n            return '';\n        }\n        if (hex.startsWith('rgba')) {\n            const m = hex.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*([.\\d]+)\\)/);\n            if (m) {\n                hex = parseInt(m[1], 10).toString(16).padStart(2, '0') +\n                    parseInt(m[2], 10).toString(16).padStart(2, '0') +\n                    parseInt(m[2], 10).toString(16).padStart(2, '0');\n            }\n        } else if (hex.startsWith('rgb')) {\n            const m = hex.match(/rgb?\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\n            if (m) {\n                hex = parseInt(m[1], 10).toString(16).padStart(2, '0') +\n                    parseInt(m[2], 10).toString(16).padStart(2, '0') +\n                    parseInt(m[2], 10).toString(16).padStart(2, '0');\n            }\n        } else\n        if (hex.startsWith('#')) {\n            hex = hex.slice(1);\n        }\n        // convert 3-digit hex to 6-digits.\n        if (hex.length === 3) {\n            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n        }\n        let alfa = null;\n        if (hex.length === 8) {\n            alfa = hex.substring(6, 8);\n            hex = hex.substring(0, 6);\n        } else\n        if (hex.length !== 6) {\n            console.warn('Cannot invert color: ' + hex);\n            return hex;\n        }\n        let r = parseInt(hex.slice(0, 2), 16);\n        let g = parseInt(hex.slice(2, 4), 16);\n        let b = parseInt(hex.slice(4, 6), 16);\n\n        if (bw) {\n            // http://stackoverflow.com/a/3943023/112731\n            return (r * 0.299 + g * 0.587 + b * 0.114) > 186\n                ? `#000000${alfa ? alfa : ''}`\n                : `#FFFFFF${alfa ? alfa : ''}`;\n        }\n        // invert color components\n        r = (255 - r).toString(16);\n        g = (255 - g).toString(16);\n        b = (255 - b).toString(16);\n        // pad each with zeros and return\n        return `#${r.padStart(2, '0')}${g.padStart(2, '0')}${b.padStart(2, '0')}${alfa ? alfa : ''}`;\n    }\n\n    /**\n     * Convert RGB to array [r, g, b]\n     * @param {string} hex Color in the format '#rrggbb' or '#rgb' (or without hash) or rgb(r,g,b) or rgba(r,g,b,a)\n     * @returns {Array<number>} Array with 3 elements [r, g, b]\n     */\n    static color2rgb(hex) {\n        if (hex === undefined || hex === null || hex === '' || typeof hex !== 'string') {\n            return '';\n        }\n        if (hex.startsWith('rgba')) {\n            const m = hex.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*([.\\d]+)\\)/);\n            if (m) {\n                hex = parseInt(m[1], 10).toString(16).padStart(2, '0') +\n                    parseInt(m[2], 10).toString(16).padStart(2, '0') +\n                    parseInt(m[2], 10).toString(16).padStart(2, '0');\n            }\n        } else if (hex.startsWith('rgba')) {\n            const m = hex.match(/rgb?\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\n            if (m) {\n                hex = parseInt(m[1], 10).toString(16).padStart(2, '0') +\n                    parseInt(m[2], 10).toString(16).padStart(2, '0') +\n                    parseInt(m[2], 10).toString(16).padStart(2, '0');\n            }\n        } else\n        if (hex.startsWith('#')) {\n            hex = hex.slice(1);\n        }\n        // convert 3-digit hex to 6-digits.\n        if (hex.length === 3) {\n            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n        }\n        if (hex.length !== 6 && hex.length !== 8) {\n            console.warn(`Cannot invert color: ${hex}`);\n            return false;\n        }\n\n        return [\n            parseInt(hex.slice(0, 2), 16),\n            parseInt(hex.slice(2, 4), 16),\n            parseInt(hex.slice(4, 6), 16),\n        ];\n    }\n\n    // Big thanks to: https://github.com/antimatter15/rgb-lab\n    /**\n     * Convert RGB to LAB\n     * @param {Array<number>} rgb color in format [r,g,b]\n     * @returns {Array<number>} lab color in format [l,a,b]\n     */\n    static rgb2lab(rgb){\n        let r = rgb[0] / 255;\n        let g = rgb[1] / 255;\n        let b = rgb[2] / 255;\n\n        r = (r > 0.04045) ? Math.pow((r + 0.055) / 1.055, 2.4) : r / 12.92;\n        g = (g > 0.04045) ? Math.pow((g + 0.055) / 1.055, 2.4) : g / 12.92;\n        b = (b > 0.04045) ? Math.pow((b + 0.055) / 1.055, 2.4) : b / 12.92;\n\n        let x = (r * 0.4124 + g * 0.3576 + b * 0.1805) / 0.95047;\n        let y = (r * 0.2126 + g * 0.7152 + b * 0.0722); /*  / 1.00000; */\n        let z = (r * 0.0193 + g * 0.1192 + b * 0.9505) / 1.08883;\n\n        x = (x > 0.008856) ? Math.pow(x, 0.33333333) : (7.787 * x) + 0.137931; // 16 / 116;\n        y = (y > 0.008856) ? Math.pow(y, 0.33333333) : (7.787 * y) + 0.137931; // 16 / 116;\n        z = (z > 0.008856) ? Math.pow(z, 0.33333333) : (7.787 * z) + 0.137931; // 16 / 116;\n\n        return [(116 * y) - 16, 500 * (x - y), 200 * (y - z)];\n    }\n\n    /**\n     * Calculate the distance between two colors in LAB color space in the range 0-100^2\n     * If distance is less than 1000, the colors are similar\n     * @param {string} color1 Color in the format '#rrggbb' or '#rgb' (or without hash) or rgb(r,g,b) or rgba(r,g,b,a)\n     * @param {string} color2 Color in the format '#rrggbb' or '#rgb' (or without hash) or rgb(r,g,b) or rgba(r,g,b,a)\n     * @returns {number} distance in the range 0-100^2\n     */\n    static colorDistance(color1, color2) {\n        const lab1 = Utils.rgb2lab(Utils.color2rgb(color1));\n        const lab2 = Utils.rgb2lab(Utils.color2rgb(color2));\n        const dltL = lab1[0] - lab2[0];\n        const dltA = lab1[1] - lab2[1];\n        const dltB = lab1[2] - lab2[2];\n        const c1 = Math.sqrt(lab1[1] * lab1[1] + lab1[2] * lab1[2]);\n        const c2 = Math.sqrt(lab2[1] * lab2[1] + lab2[2] * lab2[2]);\n        const dltC = c1 - c2;\n        let dltH = dltA * dltA + dltB * dltB - dltC * dltC;\n        dltH = dltH < 0 ? 0 : Math.sqrt(dltH);\n        const sc = 1.0 + 0.045 * c1;\n        const sh = 1.0 + 0.015 * c1;\n        const dltLKlsl = dltL;\n        const dltCkcsc = dltC / sc;\n        const dltHkhsh = dltH / sh;\n        const i = dltLKlsl * dltLKlsl + dltCkcsc * dltCkcsc + dltHkhsh * dltHkhsh;\n        return i < 0 ? 0 : i;\n    }\n\n    // https://github.com/lukeed/clsx/blob/master/src/index.js\n    // License\n    // MIT © Luke Edwards\n    /**\n     * @private\n     * @param {any} mix\n     * @returns {string}\n     */\n    static _toVal(mix) {\n        let y;\n        let str = '';\n\n        if (typeof mix === 'string' || typeof mix === 'number') {\n            str += mix;\n        } else if (typeof mix === 'object') {\n            if (Array.isArray(mix)) {\n                for (let k = 0; k < mix.length; k++) {\n                    if (mix[k]) {\n                        y = Utils._toVal(mix[k]);\n                        if (y) {\n                            str && (str += ' ');\n                            str += y;\n                        }\n                    }\n                }\n            } else {\n                for (const k in mix) {\n                    if (mix[k]) {\n                        str && (str += ' ');\n                        str += k;\n                    }\n                }\n            }\n        }\n\n        return str;\n    }\n\n    // https://github.com/lukeed/clsx/blob/master/src/index.js\n    // License\n    // MIT © Luke Edwards\n    /**\n     * Convert any object to a string with its values.\n     * @returns {string}\n     */\n    static clsx () {\n        let i = 0;\n        let tmp;\n        let x;\n        let str = '';\n        while (i < arguments.length) {\n            if ((tmp = arguments[i++])) {\n                if ((x = Utils._toVal(tmp))) {\n                    str && (str += ' ');\n                    str += x\n                }\n            }\n        }\n        return str;\n    }\n\n    /**\n     * Get the current theme name (either from local storage or the browser settings).\n     * @param {string} [themeName]\n     * @returns {string}\n     */\n    static getThemeName(themeName = '') {\n        if (window.vendorPrefix && window.vendorPrefix !== '@@vendorPrefix@@') {\n            return window.vendorPrefix;\n        }\n\n        return themeName ? themeName : (window._localStorage || window.localStorage).getItem('App.themeName') ?\n            (window._localStorage || window.localStorage).getItem('App.themeName') : window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'colored';\n    }\n\n    /**\n     * Get the type of theme.\n     * @param {string} [themeName]\n     * @returns {'dark' | 'light'}\n     */\n    static getThemeType(themeName = '') {\n        if (window.vendorPrefix && window.vendorPrefix !== '@@vendorPrefix@@') {\n            return 'light';\n        }\n\n        themeName = themeName || (window._localStorage || window.localStorage).getItem('App.themeName');\n        return themeName === 'dark' || themeName === 'blue' ? 'dark' : 'light';\n    }\n\n    /**\n     * Set the theme name and theme type.\n     * @param {string} themeName\n     */\n    static setThemeName(themeName) {\n        if (window.vendorPrefix && window.vendorPrefix !== '@@vendorPrefix@@') {\n            return; // ignore\n        }\n        (window._localStorage || window.localStorage).setItem('App.themeName', themeName);\n        (window._localStorage || window.localStorage).setItem('App.theme', themeName === 'dark' || themeName === 'blue' ? 'dark' : 'light');\n    }\n\n    /**\n     * Toggle the theme name between 'dark' and 'colored'.\n     * @param {string | null} themeName\n     * @returns {string} the new theme name.\n     */\n    static toggleTheme(themeName) {\n        if (window.vendorPrefix && window.vendorPrefix !== '@@vendorPrefix@@') {\n            return window.vendorPrefix;\n        }\n        themeName = themeName || (window._localStorage || window.localStorage).getItem('App.themeName');\n\n        // dark => blue => colored => light => dark\n        const themes = Utils.getThemeNames();\n        const pos = themes.indexOf(themeName);\n        let newTheme;\n        if (pos !== -1) {\n            newTheme = themes[(pos + 1) % themes.length];\n        } else {\n            newTheme = themes[0];\n        }\n        Utils.setThemeName(newTheme);\n\n        return newTheme;\n    }\n\n    /**\n     * Get the list of themes\n     * @returns {array<string>} list of possible themes\n     */\n    static getThemeNames() {\n        if (window.vendorPrefix && window.vendorPrefix !== '@@vendorPrefix@@') {\n            return [window.vendorPrefix];\n        }\n\n        return ['light', 'dark', 'blue', 'colored'];\n    }\n\n    /**\n     * Parse a query string into its parts.\n     * @param {string} query\n     * @returns {Record<string, string | boolean | number>}\n     */\n    static parseQuery(query) {\n        query = (query || '').toString().replace(/^\\?/, '');\n        /** @type {Record<string, string | boolean | number>} */\n        const result = {};\n        query.split('&').forEach(part => {\n            part = part.trim();\n            if (part) {\n                const parts = part.split('=');\n                const attr = decodeURIComponent(parts[0]).trim();\n                if (parts.length > 1) {\n                    result[attr] = decodeURIComponent(parts[1]);\n                    if (result[attr] === 'true') {\n                        result[attr] = true;\n                    } else if (result[attr] === 'false') {\n                        result[attr] = false;\n                    } else {\n                        const f = parseFloat(result[attr]);\n                        if (f.toString() === result[attr]) {\n                            result[attr] = f;\n                        }\n                    }\n                } else {\n                    result[attr] = true;\n                }\n            }\n        });\n        return result;\n    }\n\n    /**\n     * Returns parent ID.\n     * @param {string} id\n     * @returns {string | null} parent ID or null if no parent\n     */\n    static getParentId(id) {\n        const p = (id || '').toString().split('.');\n        if (p.length > 1) {\n            p.pop();\n            return p.join('.');\n        } else {\n            return null;\n        }\n    }\n\n    static formatDate(dateObj, dateFormat) {\n        // format could be DD.MM.YYYY, YYYY.MM.DD or MM/DD/YYYY\n\n        if (!dateObj) {\n            return '';\n        }\n\n        let text;\n        let mm = dateObj.getMonth() + 1;\n        if (mm < 10) {\n            mm = '0' + mm;\n        }\n\n        let dd = dateObj.getDate();\n        if (dd < 10) {\n            dd = '0' + dd;\n        }\n\n        if (dateFormat === 'MM/DD/YYYY') {\n            text = mm + '/' + dd + '/' + dateObj.getFullYear();\n        } else {\n            text = dateObj.getFullYear() + '-' + mm + '-' + dd;\n        }\n\n        // time\n        let v = dateObj.getHours();\n        if (v < 10) {\n            text += ' 0' + v;\n        } else {\n            text += ' ' + v;\n        }\n        v = dateObj.getMinutes();\n        if (v < 10) {\n            text += ':0' + v;\n        } else {\n            text += ':' + v;\n        }\n\n        v = dateObj.getSeconds();\n        if (v < 10) {\n            text += ':0' + v;\n        } else {\n            text += ':' + v;\n        }\n\n        v = dateObj.getMilliseconds();\n        if (v < 10) {\n            text += '.00' + v;\n        } else if (v < 100) {\n            text += '.0' + v;\n        } else {\n            text += '.' + v;\n        }\n\n        return text;\n    }\n\n    static formatTime(seconds) {\n        if (seconds) {\n            seconds = Math.round(seconds);\n            const d = Math.floor(seconds / (3600 * 24));\n            const h = Math.floor((seconds % (3600 * 24)) / 3600);\n            const m = Math.floor((seconds % 3600) / 60);\n            const s = seconds % 60;\n            if (d) {\n                return `${d}.${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\n            } else if (h) {\n                return `${h}:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\n            } else {\n                return `0:${m.toString().padStart(2, '0')}:${s.toString().padStart(2, '0')}`;\n            }\n        } else {\n            return '0:00:00';\n        }\n    }\n\n    static MDtext2link(text) {\n        const m = text.match(/\\d+\\.\\)\\s/);\n        if (m) {\n            text = text.replace(m[0], m[0].replace(/\\s/, '&nbsp;'));\n        }\n\n        return text.replace(/[^a-zA-Zа-яА-Я0-9]/g, '').trim().replace(/\\s/g, '').toLowerCase();\n    }\n\n    static openLink(url, target) {\n        // replace IPv6 Address with [ipv6]:port\n        url = url.replace(/\\/\\/([0-9a-f]*:[0-9a-f]*:[0-9a-f]*:[0-9a-f]*:[0-9a-f]*:[0-9a-f]*)(:\\d+)?\\//i, '//[$1]$2/');\n\n        if (target === 'this') {\n            window.location = url;\n        } else {\n            window.open(url, target || '_blank');\n        }\n    }\n\n    static MDgetTitle(text) {\n        let {body, header} = Utils.extractHeader(text);\n        if (!header.title) {\n            // remove {docsify-bla}\n            body = body.replace(/{[^}]*}/g, '');\n            body = body.trim();\n            const lines = body.replace(/\\r/g, '').split('\\n');\n            for (let i = 0; i < lines.length; i++) {\n                if (lines[i].startsWith('# ')) {\n                    return lines[i].substring(2).trim();\n                }\n            }\n            return '';\n        } else {\n            return header.title;\n        }\n    }\n\n    static MDextractHeader(text) {\n        const attrs = {};\n        if (text.substring(0, 3) === '---') {\n            const pos = text.substring(3).indexOf('\\n---');\n            if (pos !== -1) {\n                const _header = text.substring(3, pos + 3);\n                const lines = _header.replace(/\\r/g, '').split('\\n');\n                lines.forEach(line => {\n                    if (!line.trim()) {\n                        return;\n                    }\n                    const pos = line.indexOf(':');\n                    if (pos !== -1) {\n                        const attr = line.substring(0, pos).trim();\n                        attrs[attr] = line.substring(pos + 1).trim();\n                        attrs[attr] = attrs[attr].replace(/^['\"]|['\"]$/g, '');\n                        if (attrs[attr] === 'true') {\n                            attrs[attr] = true;\n                        } else if (attrs[attr] === 'false') {\n                            attrs[attr] = false;\n                        } else if (parseFloat(attrs[attr]).toString() === attrs[attr]) {\n                            attrs[attr] = parseFloat(attrs[attr]);\n                        }\n                    } else {\n                        attrs[line.trim()] = true;\n                    }\n                });\n                text = text.substring(pos + 7);\n            }\n        }\n        return {header: attrs, body: text};\n    }\n\n    static MDremoveDocsify(text) {\n        const m = text.match(/{docsify-[^}]*}/g);\n        if (m) {\n            m.forEach(doc => text = text.replace(doc, ''));\n        }\n        return text;\n    }\n\n    /**\n     * Generate the json file on the file for download.\n     * @param {string} filename file name\n     * @returns {object} json structure (not stringified)\n     */\n    static generateFile(filename, json) {\n        let el = document.createElement('a');\n        el.setAttribute('href', 'data:application/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(json, null, 2)));\n        el.setAttribute('download', filename);\n\n        el.style.display = 'none';\n        document.body.appendChild(el);\n\n        el.click();\n\n        document.body.removeChild(el);\n    }\n\n    /**\n     * Convert quality code into text\n     * @param {number} quality code\n     * @returns {array<string>} lines that decode qulity\n     */\n    static quality2text(quality) {\n        const custom = quality & 0xFFFF0000;\n        const text = QUALITY_BITS[quality];\n        let result;\n        if (text) {\n            result = [text];\n        } else if (quality & 0x01) {\n            result = [QUALITY_BITS[0x01], '0x' + (quality & (0xFFFF & ~1)).toString(16)];\n        } else if (quality & 0x02) {\n            result = [QUALITY_BITS[0x02], '0x' + (quality & (0xFFFF & ~2)).toString(16)];\n        } else {\n            result = ['0x' + quality.toString(16)];\n        }\n        if (custom) {\n            result.push('0x' + (custom >> 16).toString(16).toUpperCase());\n        }\n        return result;\n    }\n\n    /**\n     * Deep copy object\n     * @param {object} object\n     * @returns {object}\n     */\n    static clone(object) {\n        return JSON.parse(JSON.stringify(object));\n    }\n\n    /**\n     * Get states of object\n     * @param {object} obj\n     * @returns {object} states as an object in form {\"value1\": \"label1\", \"value2\": \"label2\"} or null\n     */\n    static getStates(obj) {\n        let states = obj?.common?.states;\n        if (states) {\n            if (typeof states === 'string' && states[0] === '{') {\n                try {\n                    states = JSON.parse(states);\n                } catch (ex) {\n                    console.error(`Cannot parse states: ${states}`);\n                    states = null;\n                }\n            } else\n            // if old format val1:text1;val2:text2\n            if (typeof states === 'string') {\n                const parts = states.split(';');\n                states = {};\n                for (let p = 0; p < parts.length; p++) {\n                    const s = parts[p].split(':');\n                    states[s[0]] = s[1];\n                }\n            } else if (Array.isArray(states)) {\n                const result = {};\n                if (obj.common.type === 'number') {\n                    states.forEach((value, key) => result[key] = value);\n                } else\n                if (obj.common.type === 'string') {\n                    states.forEach(value => result[value] = value);\n                } else if (obj.common.type === 'boolean') {\n                    result['false'] = states[0];\n                    result['true'] = states[1];\n                }\n\n                return result;\n            }\n        }\n\n        return states;\n    }\n\n    /**\n     * Get svg file as text\n     * @param {string} url URL of SVG file\n     * @returns {object} Promise with \"data:image...\"\n     */\n    static getSvg(url) {\n        return fetch(url)\n            .then(response => response.blob())\n            .then(blob => {\n                return new Promise(resolve => {\n                    const reader = new FileReader();\n                    reader.onload = function() { // do not optimize this function. \"this\" is important.\n                        resolve(this.result);\n                    };\n                    reader.readAsDataURL(blob);\n                });\n            });\n    }\n\n    /**\n     * Detect file xtension by its content\n     * @param {string} base64 Base64 encoded binary file\n     * @returns {string} Detected extension, like 'jpg'\n     */\n    static detectMimeType(base64) {\n        const signature = Object.keys(SIGNATURES).find(s => base64.startsWith(s));\n        return signature ? SIGNATURES[signature] : null;\n    }\n}\n\nexport default Utils;\n","/*\nMIT License\n\nCopyright (c) 2017 sudodoki <smd.deluzion@gmail.com>\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\nSOFTWARE.\n */\n// https://github.com/sudodoki/toggle-selection/blob/gh-pages/index.js\nfunction deselectCurrent () {\n    const selection = document.getSelection();\n    if (!selection.rangeCount) {\n        return function () {};\n    }\n    let active = document.activeElement;\n\n    const ranges = [];\n    for (let i = 0; i < selection.rangeCount; i++) {\n        ranges.push(selection.getRangeAt(i));\n    }\n\n    switch (active.tagName.toUpperCase()) { // .toUpperCase handles XHTML\n        case 'INPUT':\n        case 'TEXTAREA':\n            active.blur();\n            break;\n\n        default:\n            active = null;\n            break;\n    }\n\n    selection.removeAllRanges();\n    return function () {\n        selection.type === 'Caret' &&\n        selection.removeAllRanges();\n\n        if (!selection.rangeCount) {\n            ranges.forEach(function (range) {\n                selection.addRange(range);\n            });\n        }\n\n        active && active.focus();\n    };\n}\n\n// https://github.com/sudodoki/copy-to-clipboard/blob/master/index.js\n\nconst clipboardToIE11Formatting = {\n    'text/plain': 'Text',\n    'text/html': 'Url',\n    'default': 'Text',\n};\n\nconst defaultMessage = 'Copy to clipboard: #{key}, Enter';\n\nfunction format(message) {\n    const copyKey = (/mac os x/i.test(navigator.userAgent) ? '⌘' : 'Ctrl') + '+C';\n    return message.replace(/#{\\s*key\\s*}/g, copyKey);\n}\n\nfunction copy(text, options) {\n    let debug;\n    let reselectPrevious;\n    let range;\n    let selection;\n    let mark;\n    let success = false;\n    if (!options) {\n        options = {};\n    }\n    debug = options.debug || false;\n    try {\n        reselectPrevious = deselectCurrent();\n\n        range = document.createRange();\n        selection = document.getSelection();\n\n        mark = document.createElement('span');\n        mark.textContent = text;\n        // avoid screen readers from reading out loud the text\n        mark.ariaHidden = 'true';\n        // reset user styles for span element\n        mark.style.all = 'unset';\n        // prevents scrolling to the end of the page\n        mark.style.position = 'fixed';\n        mark.style.top = 0;\n        mark.style.clip = 'rect(0, 0, 0, 0)';\n        // used to preserve spaces and line breaks\n        mark.style.whiteSpace = 'pre';\n        // do not inherit user-select (it may be `none`)\n        mark.style.webkitUserSelect = 'text';\n        mark.style.MozUserSelect = 'text';\n        mark.style.msUserSelect = 'text';\n        mark.style.userSelect = 'text';\n        mark.addEventListener('copy', function (e) {\n            e.stopPropagation();\n            if (options.format) {\n                e.preventDefault();\n                if (typeof e.clipboardData === 'undefined') { // IE 11\n                    debug && console.warn('unable to use e.clipboardData');\n                    debug && console.warn('trying IE specific stuff');\n                    window.clipboardData.clearData();\n                    var format = clipboardToIE11Formatting[options.format] || clipboardToIE11Formatting['default']\n                    window.clipboardData.setData(format, text);\n                } else { // all other browsers\n                    e.clipboardData.clearData();\n                    e.clipboardData.setData(options.format, text);\n                }\n            }\n            if (options.onCopy) {\n                e.preventDefault();\n                options.onCopy(e.clipboardData);\n            }\n        });\n\n        document.body.appendChild(mark);\n\n        range.selectNodeContents(mark);\n        selection.addRange(range);\n\n        const successful = document.execCommand('copy');\n        if (!successful) {\n            throw new Error('copy command was unsuccessful');\n        }\n        success = true;\n    } catch (err) {\n        debug && console.error('unable to copy using execCommand: ', err);\n        debug && console.warn('trying IE specific stuff');\n        try {\n            window.clipboardData.setData(options.format || 'text', text);\n            options.onCopy && options.onCopy(window.clipboardData);\n            success = true;\n        } catch (err) {\n            debug && console.error('unable to copy using clipboardData: ', err);\n            debug && console.error('falling back to prompt');\n            let message = format('message' in options ? options.message : defaultMessage);\n            window.prompt(message, text);\n        }\n    } finally {\n        if (selection) {\n            if (typeof selection.removeRange === 'function') {\n                selection.removeRange(range);\n            } else {\n                selection.removeAllRanges();\n            }\n        }\n\n        if (mark) {\n            document.body.removeChild(mark);\n        }\n        reselectPrevious();\n    }\n\n    return success;\n}\n\nmodule.exports = copy;","/**\n * Copyright 2019-2022 bluefox <dogafox@gmail.com>\n *\n * MIT License\n *\n **/\n\n// please do not delete React, as without it other projects could not be compiled: ReferenceError: React is not defined\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport withStyles from '@mui/styles/withStyles';\n\nimport Button from '@mui/material/Button';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport FormControlLabel from '@mui/material/FormControlLabel';\nimport Checkbox from '@mui/material/Checkbox';\n\nimport IconCheck from '@mui/icons-material/Check';\nimport IconClose from '@mui/icons-material/Close';\n\nimport I18n from '../i18n';\n\nconst styles = {\n    suppress: {\n        fontSize: 12,\n    },\n    suppressRoot: {\n        marginTop: 16\n    }\n};\n\n/**\n * @typedef {object} DialogConfirmProps\n * @property {string} [title] The dialog title; default: Are you sure? (translated)\n * @property {string} text The dialog text.\n * @property {string} [ok] The ok button text; default: OK (translated)\n * @property {string} [cancel] The cancel button text; default: Cancel (translated)\n * @property {string} [suppressQuestionMinutes] interval in minutes for which the confirm dialog will be suppressed if activated.\n * @property {string} [suppressText] The suppress checkbox text; default: Suppress question for next %s minutes (translated)\n * @property {string} [dialogName] Name of the dialog. Used only with suppressQuestionMinutes to store the user choice\n * @property {(ok: boolean) => void} [onClose] Close handler.\n *\n * @extends {React.Component<DialogConfirmProps>}\n */\nclass DialogConfirm extends React.Component {\n    constructor(props) {\n        super(props);\n\n        if (!this.props.dialogName && this.props.suppressQuestionMinutes) {\n            throw new Error('dialogName required if suppressQuestionMinutes used');\n        }\n        let suppress = false;\n\n        if (this.props.suppressQuestionMinutes) {\n            suppress = parseInt((window._localStorage || window.localStorage).getItem(this.props.dialogName), 10) || 0;\n\n            if (!suppress) {\n                suppress = false;\n            } else if (Date.now() > suppress) {\n                (window._localStorage || window.localStorage).removeItem(this.props.dialogName);\n                suppress = false;\n            }\n        }\n\n        this.state = {\n            suppress,\n        };\n    }\n\n    handleOk() {\n        if (this.state.suppress) {\n            (window._localStorage || window.localStorage).setItem(this.props.dialogName, Date.now() + this.props.suppressQuestionMinutes * 60000);\n        }\n        this.props.onClose && this.props.onClose(true);\n    };\n\n    handleCancel() {\n        this.props.onClose && this.props.onClose(false);\n    };\n\n    render() {\n        if (typeof this.state.suppress === 'number') {\n            setTimeout(() => this.props.onClose && this.props.onClose(true), 100);\n            return null;\n        }\n\n        return <Dialog\n            open={!0}\n            maxWidth=\"md\"\n            fullWidth={this.props.fullWidth !== undefined ? this.props.fullWidth : true}\n            onClose={(event, reason) => {\n                if (reason !== 'backdropClick' && reason !== 'escapeKeyDown') {\n                    this.handleCancel()\n                }\n            }}\n            aria-labelledby=\"confirmation-dialog-title\"\n            aria-describedby=\"confirmation-dialog-description\"\n        >\n            <DialogTitle id=\"confirmation-dialog-title\">{this.props.title || I18n.t('ra_Are you sure?')}</DialogTitle>\n            <DialogContent>\n                <DialogContentText id=\"confirmation-dialog-description\">\n                    {this.props.icon || null}\n                    {this.props.text}\n                    {this.props.suppressQuestionMinutes ? <br/> : null}\n                    {this.props.suppressQuestionMinutes ?\n                        <FormControlLabel\n                            classes={{label: this.props.classes.suppress, root: this.props.classes.suppressRoot}}\n                            control={<Checkbox checked={!!this.state.suppress} onChange={() => this.setState({suppress: !this.state.suppress})} />}\n                            label={this.props.suppressText || I18n.t('ra_Suppress question for next %s minutes', this.props.suppressQuestionMinutes)}\n                        /> :\n                        null}\n                </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n                <Button variant=\"contained\" onClick={() => this.handleOk()} color=\"primary\" autoFocus startIcon={<IconCheck />}>{this.props.ok || I18n.t('ra_Ok')}</Button>\n                <Button variant=\"contained\" onClick={() => this.handleCancel()} color=\"grey\" startIcon={<IconClose />}>{this.props.cancel || I18n.t('ra_Cancel')}</Button>\n            </DialogActions>\n        </Dialog>;\n    }\n}\n\nDialogConfirm.propTypes = {\n    onClose: PropTypes.func.isRequired,\n    fullWidth: PropTypes.bool,\n    title: PropTypes.string,\n    text: PropTypes.string,\n    ok: PropTypes.string,\n    cancel: PropTypes.string,\n    icon: PropTypes.object,\n    suppressQuestionMinutes: PropTypes.number,\n    suppressText: PropTypes.string,\n    dialogName: PropTypes.string,\n};\n\nconst _export = withStyles(styles)(DialogConfirm);\nexport default _export;","/**\n * Copyright 2018-2022 bluefox <dogafox@gmail.com>\n *\n * MIT License\n *\n **/\n// please do not delete React, as without it other projects could not be compiled: ReferenceError: React is not defined\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport withStyles from '@mui/styles/withStyles';\n\nimport Button from '@mui/material/Button';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport DialogTitle from '@mui/material/DialogTitle';\n\nimport IconCheck from '@mui/icons-material/Check';\n\nimport I18n from '../i18n';\n\nconst styles = theme => ({\n    titleBackground: {\n\n    },\n    titleColor: {\n\n    }\n});\n\n/**\n * @typedef {object} DialogErrorProps\n * @property {string} [title] The dialog title; default: Error (translated)\n * @property {string | JSX.Element} text The dialog text.\n * @property {() => void} [onClose] Close handler.\n * @property {{titleBackground: string; titleColor: string}} classes The styling class names.\n *\n * @extends {React.Component<DialogErrorProps>}\n */\nclass DialogError extends React.Component {\n    handleOk() {\n        this.props.onClose && this.props.onClose();\n    };\n\n    render() {\n        return <Dialog\n            open={!0}\n            maxWidth=\"sm\"\n            fullWidth={this.props.fullWidth !== undefined ? this.props.fullWidth : true}\n            onClose={() => this.handleOk()}\n            aria-labelledby=\"alert-dialog-title\"\n            aria-describedby=\"alert-dialog-description\"\n        >\n            <DialogTitle className={this.props.classes.titleBackground}\n                         classes={{root: this.props.classes.titleColor}}\n                         id=\"alert-dialog-title\">{this.props.title || I18n.t('ra_Error')}</DialogTitle>\n            <DialogContent>\n                <DialogContentText id=\"alert-dialog-description\">\n                    {this.props.text || I18n.t('ra_Unknown error!')}\n                </DialogContentText>\n            </DialogContent>\n            <DialogActions>\n                <Button variant=\"contained\" onClick={() => this.handleOk()} color=\"primary\" autoFocus startIcon={<IconCheck />}>{I18n.t('ra_Ok')}</Button>\n            </DialogActions>\n        </Dialog>;\n    }\n}\n\nDialogError.propTypes = {\n    onClose: PropTypes.func.isRequired,\n    fullWidth: PropTypes.bool,\n    title: PropTypes.string,\n    text: PropTypes.oneOfType([\n        PropTypes.string,\n        PropTypes.element\n    ]),\n    icon: PropTypes.object\n};\n\n/** @type {typeof DialogError} */\nconst _export = withStyles(styles)(DialogError);\nexport default _export;\n","\n/**\n * Print the ioBroker welcome screen to the developer console.\n */\nfunction printPrompt() {\n    const prompt = `\n██╗ ██████╗ ██████╗ ██████╗  ██████╗ ██╗  ██╗███████╗██████╗ \n██║██╔═══██╗██╔══██╗██╔══██╗██╔═══██╗██║ ██╔╝██╔════╝██╔══██╗\n██║██║   ██║██████╔╝██████╔╝██║   ██║█████╔╝ █████╗  ██████╔╝\n██║██║   ██║██╔══██╗██╔══██╗██║   ██║██╔═██╗ ██╔══╝  ██╔══██╗\n██║╚██████╔╝██████╔╝██║  ██║╚██████╔╝██║  ██╗███████╗██║  ██║\n╚═╝ ╚═════╝ ╚═════╝ ╚═╝  ╚═╝ ╚═════╝ ╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝\n`;\n\n    console.log(prompt);\n    console.log('Nice to see you here! :) Join our dev community here https://github.com/ioBroker/ioBroker or here https://github.com/iobroker-community-adapters');\n    console.log('Help us to create open source project with reactJS!');\n    console.log('See you :)');\n}\n\nexport default printPrompt;","import { createTheme, adaptV4Theme, alpha } from '@mui/material/styles';\n\nimport { orange, grey } from '@mui/material/colors';\n\nconst step = (16 - 5) / 23 / 100;\n\n/**\n * Convert hex color in the format '#rrggbb' or '#rgb' to an RGB object.\n * @param {string} hex\n * @returns {{r: number, g: number, b: number}}\n */\nfunction toInt(hex) {\n    const rgb = {\n        r: 0,\n        g: 0,\n        b: 0,\n    };\n\n    if (hex.length === 7) {\n        rgb.r = parseInt(hex.substr(1, 2), 16);\n        rgb.g = parseInt(hex.substr(3, 2), 16);\n        rgb.b = parseInt(hex.substr(5, 2), 16);\n    } else if (hex.length === 4) {\n        const r = hex.substr(1, 1);\n        const g = hex.substr(2, 1);\n        const b = hex.substr(3, 1);\n\n        rgb.r = parseInt(r + r, 16);\n        rgb.g = parseInt(g + g, 16);\n        rgb.b = parseInt(b + b, 16);\n    }\n\n    return rgb;\n}\n\n/**\n * Convert an RGB object to a hex color string in the format '#rrggbb'.\n * @param {{r: number, g: number, b: number}} int\n * @returns {string}\n */\nfunction toHex(int) {\n    return `#${Math.round(int.r).toString(16)}${Math.round(int.g).toString(16)}${Math.round(int.b).toString(16)}`;\n}\n\n/**\n * @param {string} color color in the format '#rrggbb' or '#rgb'\n * @param {string} overlayColor overlay color in the format '#rrggbb' or '#rgb'\n * @param {number} elevation elevation as an integer starting with 1\n * @returns {string} the hex color string in the format '#rrggbb'\n */\nfunction getElevation(color, overlayColor, elevation) {\n    const rgb = toInt(color);\n    const overlay = toInt(overlayColor);\n\n    rgb.r += overlay.r * (0.05 + step * (elevation - 1));\n    rgb.g += overlay.g * (0.05 + step * (elevation - 1));\n    rgb.b += overlay.b * (0.05 + step * (elevation - 1));\n\n    return toHex(rgb);\n}\n\n/**\n * Get all 24 elevations of the given color and overlay.\n * @param {string} color color in the format '#rrggbb' or '#rgb'\n * @param {string} overlay overlay color in the format '#rrggbb' or '#rgb'\n * @returns {import('@mui/material/styles/withStyles').CSSProperties}\n */\nfunction getElevations(color, overlay) {\n    /** @type {import('@mui/material/styles/withStyles').CSSProperties} */\n    const elevations = {};\n\n    for (let i = 1; i <= 24; i++) {\n        elevations[`elevation${i}`] = {\n            backgroundColor: getElevation(color, overlay, i),\n        };\n    }\n\n    return elevations;\n}\n\nconst buttonsPalette = theme => ({\n    palette: {\n        // mode: \"dark\",\n        grey: {\n            main: grey[300],\n            dark: grey[400],\n        },\n    },\n});\n\nconst buttonsTheme = theme => ({\n    components: {\n        MuiButton: {\n            variants: [\n                {\n                    props: {variant: 'contained', color: 'grey'},\n                    style: {\n                        color: theme.palette.getContrastText(theme.palette.grey[300]),\n                    },\n                },\n                {\n                    props: {variant: 'outlined', color: 'grey'},\n                    style: {\n                        color: theme.palette.text.primary,\n                        borderColor:\n                            theme.palette.mode === 'light'\n                                ? 'rgba(0, 0, 0, 0.23)'\n                                : 'rgba(255, 255, 255, 0.23)',\n                        '&.Mui-disabled': {\n                            border: `1px solid ${theme.palette.action.disabledBackground}`,\n                        },\n                        '&:hover': {\n                            borderColor:\n                                theme.palette.mode === 'light'\n                                    ? 'rgba(0, 0, 0, 0.23)'\n                                    : 'rgba(255, 255, 255, 0.23)',\n                            backgroundColor: alpha(\n                                theme.palette.text.primary,\n                                theme.palette.action.hoverOpacity,\n                            ),\n                        },\n                    },\n                },\n                {\n                    props: {color: 'grey', variant: 'text'},\n                    style: {\n                        color: 'black',\n                        '&:hover': {\n                            backgroundColor: alpha(\n                                theme.palette.text.primary,\n                                theme.palette.action.hoverOpacity,\n                            ),\n                        },\n                    },\n                },\n            ],\n        },\n    },\n});\n\n/**\n * The theme creation factory function.\n * @param {string} type\n * @returns {import('./types').Theme}\n */\nconst Theme = type => {\n    let theme;\n    if (type === 'dark') {\n        theme = {\n            name: type,\n            palette: {\n                mode: 'dark',\n                background: {\n                    paper: '#121212',\n                    default: '#121212',\n                },\n                primary: {\n                    main: '#4dabf5',\n                },\n                secondary: {\n                    main: '#436a93',\n                },\n                expert: '#14bb00',\n                text: {\n                    primary: '#ffffff',\n                    secondary: '#ffffff',\n                },\n            },\n            overrides: {\n                MuiAppBar: {\n                    colorDefault: {\n                        backgroundColor: '#272727',\n                    },\n                },\n                MuiLink: {\n                    root: {\n                        textTransform: 'uppercase',\n                        transition: 'color .3s ease',\n                        color: orange[200],\n                        '&:hover': {\n                            color: orange[100],\n                        },\n                    },\n                },\n                MuiPaper: getElevations('#121212', '#fff'),\n            },\n        };\n    } else if (type === 'blue') {\n        theme = {\n            name: type,\n            palette: {\n                mode: 'dark',\n                background: {\n                    paper: '#151d21',\n                    default: '#151d21',\n                },\n                primary: {\n                    main: '#4dabf5',\n                },\n                secondary: {\n                    main: '#436a93',\n                },\n                expert: '#14bb00',\n                text: {\n                    primary: '#ffffff',\n                    secondary: '#ffffff',\n                },\n            },\n            overrides: {\n                MuiAppBar: {\n                    colorDefault: {\n                        backgroundColor: '#2a3135',\n                    },\n                },\n                MuiLink: {\n                    root: {\n                        textTransform: 'uppercase',\n                        transition: 'color .3s ease',\n                        color: orange[200],\n                        '&:hover': {\n                            color: orange[100],\n                        },\n                    },\n                },\n                MuiPaper: getElevations('#151d21', '#fff'),\n            },\n        };\n    } else if (type === 'colored') {\n        theme = {\n            name: type,\n            palette: {\n                mode: 'light',\n                primary: {\n                    main: '#3399CC',\n                },\n                secondary: {\n                    main: '#164477',\n                },\n                expert: '#96fc96',\n            },\n            overrides: {\n                MuiAppBar: {\n                    colorDefault: {\n                        backgroundColor: '#3399CC',\n                    },\n                },\n                MuiLink: {\n                    root: {\n                        textTransform: 'uppercase',\n                        transition: 'color .3s ease',\n                        color: orange[400],\n                        '&:hover': {\n                            color: orange[300],\n                        },\n                    },\n                },\n            },\n        };\n    } else if (type === 'PT') {\n        theme = {\n            name: type,\n            palette: {\n                mode: 'light',\n                primary: {\n                    main: '#0F99DE',\n                },\n                secondary: {\n                    main: '#88A536',\n                },\n                expert: '#BD1B24',\n            },\n            overrides: {\n                MuiAppBar: {\n                    colorDefault: {\n                        backgroundColor: '#0F99DE',\n                    },\n                },\n                MuiLink: {\n                    root: {\n                        textTransform: 'uppercase',\n                        transition: 'color .3s ease',\n                        color: orange[400],\n                        '&:hover': {\n                            color: orange[300],\n                        },\n                    },\n                },\n            },\n        };\n    } else if (type === 'DX') {\n        theme = {\n            name: type,\n            palette: {\n                mode: 'light',\n                primary: {\n                    main: '#F5F5F7',\n                },\n                secondary: {\n                    main: '#a9a9a9',\n                },\n                expert: '#BD1B24',\n                text: {\n                    primary: '#007AFE',\n                    secondary: '#007AFE',\n                    disabled: '#007AFEAA',\n                },\n            },\n            overrides: {\n                MuiAppBar: {\n                    colorDefault: {\n                        backgroundColor: '#a9a9a9',\n                    },\n                },\n                MuiLink: {\n                    root: {\n                        textTransform: 'uppercase',\n                        transition: 'color .3s ease',\n                        color: orange[400],\n                        '&:hover': {\n                            color: orange[300],\n                        },\n                    },\n                },\n            },\n        };\n    } else {\n        theme = {\n            name: type,\n            palette: {\n                mode: 'light',\n                primary: {\n                    main: '#3399CC',\n                },\n                secondary: {\n                    main: '#164477',\n                },\n                expert: '#14bb00',\n            },\n            overrides: {\n                MuiLink: {\n                    root: {\n                        textTransform: 'uppercase',\n                        transition: 'color .3s ease',\n                        color: orange[400],\n                        '&:hover': {\n                            color: orange[300],\n                        },\n                    },\n                },\n            },\n        };\n    }\n\n    theme.toolbar = {\n        height: 48,\n    };\n\n    // add save toolbar\n    theme.saveToolbar = {\n        background: theme.palette.primary.main,\n        button: {\n            borderRadius: 3,\n            height: 32,\n        },\n    };\n\n    theme.palette.grey = {\n        main: grey[300],\n        dark: grey[400],\n    };\n\n    theme = createTheme(adaptV4Theme(theme));\n\n    return createTheme(theme, {\n        components: {\n            MuiButton: {\n                variants: [\n                    {\n                        props: {variant: 'contained', color: 'grey'},\n                        style: {\n                            color: theme.palette.getContrastText(theme.palette.grey[300]),\n                        },\n                    },\n                    {\n                        props: {variant: 'outlined', color: 'grey'},\n                        style: {\n                            color: theme.palette.text.primary,\n                            borderColor:\n                                theme.palette.mode === 'light'\n                                    ? 'rgba(0, 0, 0, 0.23)'\n                                    : 'rgba(255, 255, 255, 0.23)',\n                            '&.Mui-disabled': {\n                                border: `1px solid ${theme.palette.action.disabledBackground}`,\n                            },\n                            '&:hover': {\n                                borderColor:\n                                    theme.palette.mode === 'light'\n                                        ? 'rgba(0, 0, 0, 0.23)'\n                                        : 'rgba(255, 255, 255, 0.23)',\n                                backgroundColor: alpha(\n                                    theme.palette.text.primary,\n                                    theme.palette.action.hoverOpacity,\n                                ),\n                            },\n                        },\n                    },\n                    {\n                        props: {variant: 'text', color: 'grey'},\n                        style: {\n                            color: theme.palette.text.primary,\n                            '&:hover': {\n                                backgroundColor: alpha(\n                                    theme.palette.text.primary,\n                                    theme.palette.action.hoverOpacity,\n                                ),\n                            },\n                        },\n                    },\n                ],\n            },\n        },\n    });\n};\n\nexport default Theme;\n","/***\n * Copyright 2018-2022 bluefox <dogafox@gmail.com>\n *\n * MIT License\n *\n ***/\n\n /**\n  * Translation string management.\n  */\nclass I18n {\n    /**\n     * List of all languages with their translations.\n     * @type {{ [lang in ioBroker.Languages]?: Record<string, string>; }}\n     */\n    static translations = {};\n\n     /**\n      * List of unknown translations during development.\n      * @type {string[]}\n      */\n     static unknownTranslations = [];\n\n    /**\n     * The currently displayed language.\n     * @type {ioBroker.Languages}\n     */\n    static lang = window.sysLang || 'en';\n\n    static _disableWarning = false;\n\n    /**\n     * Set the language to display.\n     * @param {ioBroker.Languages} lang\n     */\n    static setLanguage(lang) {\n        if (lang) {\n            I18n.lang = lang;\n        }\n    }\n\n     /**\n      * Add translations\n      * User can provide two types of structures:\n      * - {\"word1\": \"translated word1\", \"word2\": \"translated word2\"}, but in this case the lang must be provided\n      * - {\"word1\": {\"en\": \"translated en word1\", \"de\": \"translated de word1\"}, \"word2\": {\"en\": \"translated en word2\", \"de\": \"translated de word2\"}}, but no lang must be provided\n      * @param {object} words additional words for specific language\n      * @param {ioBroker.Languages} lang\n      */\n     static extendTranslations(words, lang) {\n         // extend automatically all languages with prefix\n         if (words.prefix) {\n             if (typeof words.prefix === 'string') {\n                 const prefix = words.prefix;\n                 delete words.prefix;\n                 Object.keys(words).forEach(lang => {\n                     const _words = {};\n                     Object.keys(words[lang]).forEach(word => {\n                         if (!word) {\n                             return;\n                         }\n                         if (!word.startsWith(prefix)) {\n                             _words[`${prefix}${word}`] = words[lang][word];\n                         } else {\n                             _words[word] = words[lang][word];\n                         }\n                     });\n                     words[lang] = _words;\n                 });\n             } else {\n                 console.warn('Found prefix in translations, but it is not a string');\n             }\n         }\n\n         try {\n             if (!lang) {\n                 if (words.en && words.de && words.ru) {\n                     Object.keys(words).forEach(lang => {\n                         I18n.translations[lang] = I18n.translations[lang] || {};\n                         Object.assign(I18n.translations[lang], words[lang]);\n                     });\n                 } else {\n                     Object.keys(words).forEach(word => {\n                         Object.keys(words[word]).forEach(lang => {\n                             if (!I18n.translations[lang]) {\n                                 console.warn(`Used unknown language: ${lang}`);\n                             }\n                             if (!I18n.translations[lang][word]) {\n                                 I18n.translations[lang][word] = words[word][lang];\n                             } else if (I18n.translations[lang][word] !== words[word][lang]) {\n                                 console.warn(`Translation for word \"${word}\" in \"${lang}\" was ignored: existing = \"${I18n.translations[lang][word]}\", new = ${words[word][lang]}`);\n                             }\n                         });\n                     });\n                 }\n             } else {\n                 if (!I18n.translations[lang]) {\n                     console.warn(`Used unknown language: ${lang}`);\n                 }\n                 I18n.translations[lang] = I18n.translations[lang] || {};\n                 Object.keys(words)\n                     .forEach(word => {\n                         if (!I18n.translations[lang][word]) {\n                             I18n.translations[lang][word] = words[word];\n                         } else if (I18n.translations[lang][word] !== words[word]) {\n                             console.warn(`Translation for word \"${word}\" in \"${lang}\" was ignored: existing = \"${I18n.translations[lang][word]}\", new = ${words[word]}`);\n                         }\n                     });\n             }\n         } catch (e) {\n             console.error(`Cannot apply translations: ${e}`);\n         }\n    }\n\n    /**\n     * Sets all translations (in all languages).\n     * @param {{ [lang in ioBroker.Languages]?: Record<string, string>; }} translations\n     */\n    static setTranslations(translations) {\n        if (translations) {\n            I18n.translations = translations;\n        }\n    }\n\n    /**\n     * Get the currently chosen language.\n     * @returns {ioBroker.Languages} The current language.\n     */\n    static getLanguage() {\n        return I18n.lang;\n    }\n\n    /**\n     * Translate the given string to the selected language.\n     * @param {string} word The (key) word to look up the string.\n     * @param {string[]} args Optional arguments which will replace the first (second, third, ...) occurrences of %s\n     */\n    static t(word, ...args) {\n        let translation = I18n.translations[I18n.lang];\n        if (translation) {\n            const w = translation[word];\n            if (w) {\n                word = w;\n            } else {\n                if (!I18n.unknownTranslations.includes(word)) {\n                    I18n.unknownTranslations.push(word);\n                    !I18n._disableWarning && console.log(`Translate: ${word}`);\n                }\n                // fallback to english\n                if (I18n.lang !== 'en' && I18n.translations.en) {\n                    const wordEn = I18n.translations.en[word];\n                    if (wordEn) {\n                        word = wordEn;\n                    }\n                }\n            }\n        }\n        for (const arg of args) {\n            word = word.replace('%s', arg);\n        }\n        return word;\n    }\n\n     /**\n      * Show non-translated words\n      * Required during development\n      * @param {string | RegExp} filter filter words\n      */\n     static i18nShow(filter) {\n         /**\n          * List words with their translations.\n          * @type {Record<string, string>}\n          */\n         const result = {};\n        if (!filter) {\n            I18n.unknownTranslations.forEach(word => {\n                result[word] = word;\n            });\n            console.log(JSON.stringify(result, null, 2));\n        } else if (typeof filter === 'string') {\n            I18n.unknownTranslations.forEach(word => {\n                if (word.startsWith(filter)) {\n                    result[word] = word.replace(filter, '');\n                }\n            });\n            console.log(JSON.stringify(result, null, 2));\n        } else if (typeof filter === 'object') {\n            I18n.unknownTranslations.forEach(word => {\n                if (filter.test(word)) {\n                    result[word] = word;\n                }\n            });\n            console.log(JSON.stringify(result, null, 2));\n        }\n    }\n\n     /**\n      * Disable warning about non-translated words\n      * Required during development\n      * @param {boolean} disable Do the warning should be disabled\n      */\n    static disableWarning(disable) {\n        I18n._disableWarning = !!disable;\n    }\n}\n\n// install global handlers\nwindow.i18nShow = I18n.i18nShow;\nwindow.i18nDisableWarning = I18n.disableWarning;\n\n\n/*I18n.translations = {\n    'en': require('./i18n/en'),\n    'ru': require('./i18n/ru'),\n    'de': require('./i18n/de'),\n};\nI18n.fallbacks = true;\nI18n.t = function () {};*/\n\nexport default I18n;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\"\n}), 'Check');\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"\n}), 'Close');\nexports.default = _default;","\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _createSvgIcon = _interopRequireDefault(require(\"./utils/createSvgIcon\"));\nvar _jsxRuntime = require(\"react/jsx-runtime\");\nvar _default = (0, _createSvgIcon.default)( /*#__PURE__*/(0, _jsxRuntime.jsx)(\"path\", {\n  d: \"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z\"\n}), 'Save');\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"default\", {\n  enumerable: true,\n  get: function () {\n    return _utils.createSvgIcon;\n  }\n});\nvar _utils = require(\"@mui/material/utils\");","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nmodule.exports = _assertThisInitialized, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nmodule.exports = _createClass, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var superPropBase = require(\"./superPropBase.js\");\n\nfunction _get() {\n  if (typeof Reflect !== \"undefined\" && Reflect.get) {\n    module.exports = _get = Reflect.get.bind(), module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  } else {\n    module.exports = _get = function _get(target, property, receiver) {\n      var base = superPropBase(target, property);\n      if (!base) return;\n      var desc = Object.getOwnPropertyDescriptor(base, property);\n\n      if (desc.get) {\n        return desc.get.call(arguments.length < 3 ? target : receiver);\n      }\n\n      return desc.value;\n    }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  }\n\n  return _get.apply(this, arguments);\n}\n\nmodule.exports = _get, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _getPrototypeOf(o) {\n  module.exports = _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  return _getPrototypeOf(o);\n}\n\nmodule.exports = _getPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var setPrototypeOf = require(\"./setPrototypeOf.js\");\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) setPrototypeOf(subClass, superClass);\n}\n\nmodule.exports = _inherits, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nmodule.exports = _interopRequireDefault, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _iterableToArrayLimit(arr, i) {\n  var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"];\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var _typeof = require(\"./typeof.js\")[\"default\"];\n\nvar assertThisInitialized = require(\"./assertThisInitialized.js\");\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return assertThisInitialized(self);\n}\n\nmodule.exports = _possibleConstructorReturn, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _setPrototypeOf(o, p) {\n  module.exports = _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;\n  return _setPrototypeOf(o, p);\n}\n\nmodule.exports = _setPrototypeOf, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayWithHoles = require(\"./arrayWithHoles.js\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit.js\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray.js\");\n\nvar nonIterableRest = require(\"./nonIterableRest.js\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var getPrototypeOf = require(\"./getPrototypeOf.js\");\n\nfunction _superPropBase(object, property) {\n  while (!Object.prototype.hasOwnProperty.call(object, property)) {\n    object = getPrototypeOf(object);\n    if (object === null) break;\n  }\n\n  return object;\n}\n\nmodule.exports = _superPropBase, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return (module.exports = _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, module.exports.__esModule = true, module.exports[\"default\"] = module.exports), _typeof(obj);\n}\n\nmodule.exports = _typeof, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","var arrayLikeToArray = require(\"./arrayLikeToArray.js\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\nmodule.exports = _interopRequireDefault, module.exports.__esModule = true, module.exports[\"default\"] = module.exports;","import { Connection, ERRORS, RequestOptions } from \"./Connection.js\";\nimport type { ConnectionProps } from \"./ConnectionProps.js\";\nimport type {\n\tAdminEmitEvents,\n\tAdminListenEvents,\n\tCompactAdapterInfo,\n\tCompactHost,\n\tCompactInstalledInfo,\n\tCompactInstanceInfo,\n\tCompactRepository,\n\tCompactSystemRepository,\n\tLogFile,\n} from \"./SocketEvents.js\";\nimport {\n\tgetObjectViewResultToArray,\n\tnormalizeHostId,\n\tobjectIdToHostname,\n} from \"./tools.js\";\n\ninterface Certificate {\n\tname: string;\n\ttype: \"public\" | \"private\" | \"chained\";\n}\n\nfunction parseCertificate(name: string, cert: string): Certificate | void {\n\tif (!cert) return;\n\n\tlet type: Certificate[\"type\"];\n\t// If it is filename, it could be everything\n\tif (\n\t\tcert.length < 700 &&\n\t\t(cert.indexOf(\"/\") !== -1 || cert.indexOf(\"\\\\\") !== -1)\n\t) {\n\t\tif (name.toLowerCase().includes(\"private\")) {\n\t\t\ttype = \"private\";\n\t\t} else if (cert.toLowerCase().includes(\"private\")) {\n\t\t\ttype = \"private\";\n\t\t} else if (name.toLowerCase().includes(\"public\")) {\n\t\t\ttype = \"public\";\n\t\t} else if (cert.toLowerCase().includes(\"public\")) {\n\t\t\ttype = \"public\";\n\t\t} else {\n\t\t\t// TODO: is this correct?\n\t\t\treturn;\n\t\t}\n\t} else {\n\t\ttype =\n\t\t\tcert.substring(0, \"-----BEGIN RSA PRIVATE KEY\".length) ===\n\t\t\t\t\"-----BEGIN RSA PRIVATE KEY\" ||\n\t\t\tcert.substring(0, \"-----BEGIN PRIVATE KEY\".length) ===\n\t\t\t\t\"-----BEGIN PRIVATE KEY\"\n\t\t\t\t? \"private\"\n\t\t\t\t: \"public\";\n\n\t\tif (type === \"public\") {\n\t\t\tconst m = cert.split(\"-----END CERTIFICATE-----\");\n\t\t\tif (\n\t\t\t\tm.filter((t) => t.replace(/\\r\\n|\\r|\\n/, \"\").trim()).length > 1\n\t\t\t) {\n\t\t\t\ttype = \"chained\";\n\t\t\t}\n\t\t}\n\t}\n\treturn { name, type };\n}\n\nexport interface IPAddress {\n\tname: string;\n\taddress: string;\n\tfamily: \"ipv4\" | \"ipv6\";\n}\n\ninterface IPAddresses {\n\tIPs4: IPAddress[];\n\tIPs6: IPAddress[];\n}\n\nfunction parseIPAddresses(host: ioBroker.HostObject): IPAddresses {\n\tconst IPs4: IPAddress[] = [\n\t\t{\n\t\t\tname: \"[IPv4] 0.0.0.0 - Listen on all IPs\",\n\t\t\taddress: \"0.0.0.0\",\n\t\t\tfamily: \"ipv4\",\n\t\t},\n\t];\n\tconst IPs6: IPAddress[] = [\n\t\t{\n\t\t\tname: \"[IPv6] :: - Listen on all IPs\",\n\t\t\taddress: \"::\",\n\t\t\tfamily: \"ipv6\",\n\t\t},\n\t];\n\tif (host.native?.hardware?.networkInterfaces) {\n\t\tfor (const [eth, iface] of Object.entries(\n\t\t\thost.native.hardware.networkInterfaces,\n\t\t)) {\n\t\t\tif (!iface) continue;\n\n\t\t\tfor (const ip of iface) {\n\t\t\t\tif (ip.family !== \"IPv6\") {\n\t\t\t\t\tIPs4.push({\n\t\t\t\t\t\tname: `[${ip.family}] ${ip.address} - ${eth}`,\n\t\t\t\t\t\taddress: ip.address,\n\t\t\t\t\t\tfamily: \"ipv4\",\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tIPs6.push({\n\t\t\t\t\t\tname: `[${ip.family}] ${ip.address} - ${eth}`,\n\t\t\t\t\t\taddress: ip.address,\n\t\t\t\t\t\tfamily: \"ipv6\",\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn { IPs4, IPs6 };\n}\n\nexport class AdminConnection extends Connection<\n\tAdminListenEvents,\n\tAdminEmitEvents\n> {\n\tconstructor(props: ConnectionProps) {\n\t\tsuper(props);\n\t}\n\n\t// We overload the request method here because the admin connection's methods all have `requireAdmin: true`\n\tprotected request<T>(options: RequestOptions<T>): Promise<T> {\n\t\treturn super.request<T>({ requireAdmin: true, ...options });\n\t}\n\n\t/**\n\t * Get the stored certificates.\n\t * @param update Force update.\n\t */\n\tgetCertificates(update?: boolean): Promise<Certificate[]> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"cert\",\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: async (resolve) => {\n\t\t\t\tconst obj = await this.getObject(\"system.certificates\");\n\t\t\t\tif (obj?.native?.certificates) {\n\t\t\t\t\tresolve(\n\t\t\t\t\t\tObject.entries<string>(obj.native.certificates)\n\t\t\t\t\t\t\t.map(([name, cert]) => parseCertificate(name, cert))\n\t\t\t\t\t\t\t.filter((cert): cert is Certificate => !!cert),\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tresolve([]);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the logs from a host (only for admin connection).\n\t * @param host\n\t * @param linesNumber\n\t */\n\tgetLogs(host: string, linesNumber: number = 200): Promise<string[]> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"getLogs\",\n\t\t\t\t\tlinesNumber || 200,\n\t\t\t\t\t(lines: any) => {\n\t\t\t\t\t\tresolve(lines);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the log files (only for admin connection).\n\t */\n\tgetLogsFiles(host: string): Promise<LogFile[]> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"readLogs\", host, (err, files) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(files!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Delete the logs from a host (only for admin connection).\n\t */\n\tdelLogs(host: string): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"delLogs\",\n\t\t\t\t\tnull,\n\t\t\t\t\t(err) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Delete a file of an adapter.\n\t * @param adapter The adapter name.\n\t * @param fileName The file name.\n\t */\n\tdeleteFile(adapter: string, fileName: string): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"deleteFile\", adapter, fileName, (err) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Delete a folder of an adapter.\n\t * @param adapter The adapter name.\n\t * @param folderName The folder name.\n\t */\n\tdeleteFolder(adapter: string, folderName: string): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"deleteFolder\",\n\t\t\t\t\tadapter,\n\t\t\t\t\tfolderName,\n\t\t\t\t\t(err) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the list of all hosts.\n\t * @param update Force update.\n\t */\n\tgetHosts(update?: boolean): Promise<ioBroker.HostObject[]> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"hosts\",\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getObjectView\",\n\t\t\t\t\t\"system\",\n\t\t\t\t\t\"host\",\n\t\t\t\t\t{ startkey: \"system.host.\", endkey: \"system.host.\\u9999\" },\n\t\t\t\t\t(err, doc) => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(\n\t\t\t\t\t\t\t\tgetObjectViewResultToArray<ioBroker.HostObject>(\n\t\t\t\t\t\t\t\t\tdoc,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the list of all users.\n\t * @param update Force update.\n\t */\n\tgetUsers(update?: boolean): Promise<ioBroker.UserObject[]> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"users\",\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getObjectView\",\n\t\t\t\t\t\"system\",\n\t\t\t\t\t\"user\",\n\t\t\t\t\t{ startkey: \"system.user.\", endkey: \"system.user.\\u9999\" },\n\t\t\t\t\t(err, doc) => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(\n\t\t\t\t\t\t\t\tgetObjectViewResultToArray<ioBroker.UserObject>(\n\t\t\t\t\t\t\t\t\tdoc,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Rename a group.\n\t * @param id The id.\n\t * @param newId The new id.\n\t * @param newName The new name.\n\t */\n\trenameGroup(\n\t\tid: string,\n\t\tnewId: string,\n\t\tnewName: ioBroker.StringOrTranslated,\n\t): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: async (resolve) => {\n\t\t\t\tconst groups = await this.getGroups(true);\n\t\t\t\t// renaming a group happens by re-creating the object under a different ID\n\t\t\t\tconst subGroups = groups.filter((g) =>\n\t\t\t\t\tg._id.startsWith(`${id}.`),\n\t\t\t\t);\n\t\t\t\t// First do this for all sub groups\n\t\t\t\tfor (const group of subGroups) {\n\t\t\t\t\tconst oldGroupId = group._id;\n\t\t\t\t\tconst newGroupId = newId + group._id.substring(id.length);\n\t\t\t\t\tgroup._id = newGroupId;\n\n\t\t\t\t\t// Create new object, then delete the old one if it worked\n\t\t\t\t\tawait this.setObject(newGroupId, group);\n\t\t\t\t\tawait this.delObject(oldGroupId);\n\t\t\t\t}\n\t\t\t\t// Then for the parent group\n\t\t\t\tconst parentGroup = groups.find((g) => g._id === id);\n\t\t\t\tif (parentGroup) {\n\t\t\t\t\tconst oldGroupId = parentGroup._id;\n\t\t\t\t\tparentGroup._id = newId;\n\t\t\t\t\tif (newName !== undefined) {\n\t\t\t\t\t\t(parentGroup.common as any) ??= {};\n\t\t\t\t\t\tparentGroup.common.name = newName as any;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Create new object, then delete the old one if it worked\n\t\t\t\t\tawait this.setObject(newId, parentGroup);\n\t\t\t\t\tawait this.delObject(oldGroupId);\n\t\t\t\t}\n\n\t\t\t\tresolve();\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the host information.\n\t * @param host\n\t * @param update Force update.\n\t * @param timeoutMs optional read timeout.\n\t */\n\tgetHostInfo(\n\t\thost: string,\n\t\tupdate?: boolean,\n\t\ttimeoutMs?: number,\n\t): Promise<any> {\n\t\thost = normalizeHostId(host);\n\t\treturn this.request({\n\t\t\tcacheKey: `hostInfo_${host}`,\n\t\t\tforceUpdate: update,\n\t\t\tcommandTimeout: timeoutMs,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"getHostInfo\",\n\t\t\t\t\tnull,\n\t\t\t\t\t(data) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tif (data === ERRORS.PERMISSION_ERROR) {\n\t\t\t\t\t\t\treject('May not read \"getHostInfo\"');\n\t\t\t\t\t\t} else if (!data) {\n\t\t\t\t\t\t\treject('Cannot read \"getHostInfo\"');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the host information (short version).\n\t * @param host\n\t * @param update Force update.\n\t * @param timeoutMs optional read timeout.\n\t */\n\tgetHostInfoShort(\n\t\thost: string,\n\t\tupdate?: boolean,\n\t\ttimeoutMs?: number,\n\t): Promise<any> {\n\t\thost = normalizeHostId(host);\n\t\treturn this.request({\n\t\t\tcacheKey: `hostInfoShort_${host}`,\n\t\t\tforceUpdate: update,\n\t\t\tcommandTimeout: timeoutMs,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"getHostInfoShort\",\n\t\t\t\t\tnull,\n\t\t\t\t\t(data) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tif (data === ERRORS.PERMISSION_ERROR) {\n\t\t\t\t\t\t\treject('May not read \"getHostInfoShort\"');\n\t\t\t\t\t\t} else if (!data) {\n\t\t\t\t\t\t\treject('Cannot read \"getHostInfoShort\"');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the repository.\n\t * @param host\n\t * @param args\n\t * @param update Force update.\n\t * @param timeoutMs timeout in ms.\n\t */\n\tgetRepository(\n\t\thost: string,\n\t\targs: any,\n\t\tupdate?: boolean,\n\t\ttimeoutMs?: number,\n\t): Promise<any> {\n\t\treturn this.request({\n\t\t\tcacheKey: `repository_${host}`,\n\t\t\tforceUpdate: update,\n\t\t\tcommandTimeout: timeoutMs,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"getRepository\",\n\t\t\t\t\targs,\n\t\t\t\t\t(data) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tif (data === ERRORS.PERMISSION_ERROR) {\n\t\t\t\t\t\t\treject('May not read \"getRepository\"');\n\t\t\t\t\t\t} else if (!data) {\n\t\t\t\t\t\t\treject('Cannot read \"getRepository\"');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the installed.\n\t * @param host\n\t * @param update Force update.\n\t * @param cmdTimeout timeout in ms\n\t */\n\tgetInstalled(\n\t\thost: string,\n\t\tupdate?: boolean,\n\t\tcmdTimeout?: number,\n\t): Promise<any> {\n\t\thost = normalizeHostId(host);\n\n\t\treturn this.request({\n\t\t\tcacheKey: `installed_${host}`,\n\t\t\tforceUpdate: update,\n\t\t\tcommandTimeout: cmdTimeout,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"getInstalled\",\n\t\t\t\t\tnull,\n\t\t\t\t\t(data) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tif (data === ERRORS.PERMISSION_ERROR) {\n\t\t\t\t\t\t\treject('May not read \"getInstalled\"');\n\t\t\t\t\t\t} else if (!data) {\n\t\t\t\t\t\t\treject('Cannot read \"getInstalled\"');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Execute a command on a host.\n\t * @param host The host name.\n\t * @param cmd The command.\n\t * @param cmdId The command ID.\n\t * @param cmdTimeout Timeout of command in ms\n\t */\n\tcmdExec(\n\t\thost: string,\n\t\tcmd: string,\n\t\tcmdId: string,\n\t\tcmdTimeout?: number,\n\t): Promise<void> {\n\t\treturn this.request({\n\t\t\tcommandTimeout: cmdTimeout,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\thost = normalizeHostId(host);\n\n\t\t\t\tthis._socket.emit(\"cmdExec\", host, cmdId, cmd, (err) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read the base settings of a given host.\n\t * @param host\n\t */\n\treadBaseSettings(host: string): Promise<any> {\n\t\t// Make sure we deal with a hostname, not an object ID\n\t\thost = objectIdToHostname(host);\n\n\t\treturn this.request({\n\t\t\trequireFeatures: [\"CONTROLLER_READWRITE_BASE_SETTINGS\"],\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"readBaseSettings\",\n\t\t\t\t\tnull,\n\t\t\t\t\t(data) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\n\t\t\t\t\t\tif (data === ERRORS.PERMISSION_ERROR) {\n\t\t\t\t\t\t\treject('May not read \"BaseSettings\"');\n\t\t\t\t\t\t} else if (!data) {\n\t\t\t\t\t\t\treject('Cannot read \"BaseSettings\"');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Write the base settings of a given host.\n\t * @param host\n\t * @param config\n\t */\n\twriteBaseSettings(host: string, config: any): Promise<any> {\n\t\t// Make sure we deal with a hostname, not an object ID\n\t\thost = objectIdToHostname(host);\n\n\t\treturn this.request({\n\t\t\trequireFeatures: [\"CONTROLLER_READWRITE_BASE_SETTINGS\"],\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"writeBaseSettings\",\n\t\t\t\t\tconfig,\n\t\t\t\t\t(data) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\n\t\t\t\t\t\tif (data === ERRORS.PERMISSION_ERROR) {\n\t\t\t\t\t\t\treject('May not write \"BaseSettings\"');\n\t\t\t\t\t\t} else if (!data) {\n\t\t\t\t\t\t\treject('Cannot write \"BaseSettings\"');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Send command to restart the iobroker on host\n\t * @param host\n\t */\n\trestartController(host: string): Promise<true> {\n\t\t// Make sure we deal with a hostname, not an object ID\n\t\thost = objectIdToHostname(host);\n\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"restartController\",\n\t\t\t\t\tnull,\n\t\t\t\t\t(error) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tif (error) reject(error);\n\t\t\t\t\t\tresolve(true);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read statistics information from host\n\t * @param host\n\t * @param typeOfDiag one of none, normal, no-city, extended\n\t */\n\tgetDiagData(host: string, typeOfDiag: string): Promise<any> {\n\t\t// Make sure we deal with a hostname, not an object ID\n\t\thost = objectIdToHostname(host);\n\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"getDiagData\",\n\t\t\t\t\ttypeOfDiag,\n\t\t\t\t\t(result) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Change the password of the given user.\n\t * @param user\n\t * @param password\n\t */\n\tchangePassword(user: string, password: string): Promise<void> {\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"changePassword\", user, password, (err) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the IP addresses of the given host.\n\t * @param host\n\t * @param update Force update.\n\t */\n\tgetIpAddresses(host: string, update?: boolean): Promise<string[]> {\n\t\thost = normalizeHostId(host);\n\t\treturn this.request({\n\t\t\tcacheKey: `IPs_${host}`,\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: async (resolve) => {\n\t\t\t\tconst obj = await this.getObject(host);\n\t\t\t\tresolve(obj?.common.address ?? []);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the IP addresses with interface names of the given host or find host by IP.\n\t * @param ipOrHostName\n\t * @param update Force update.\n\t */\n\tgetHostByIp(ipOrHostName: string, update?: boolean): Promise<IPAddress[]> {\n\t\t// Make sure we deal with a hostname, not an object ID\n\t\tipOrHostName = objectIdToHostname(ipOrHostName);\n\n\t\treturn this.request({\n\t\t\tcacheKey: `rIPs_${ipOrHostName}`,\n\t\t\tforceUpdate: update,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getHostByIp\", ipOrHostName, (ip, host) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\n\t\t\t\t\tconst { IPs4, IPs6 } = parseIPAddresses(host);\n\t\t\t\t\tresolve([...IPs4, ...IPs6]);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Encrypt a text\n\t * @param plaintext\n\t */\n\tencrypt(plaintext: string): Promise<string> {\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"encrypt\", plaintext, (err, ciphertext) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(ciphertext!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Decrypt a text\n\t * @param ciphertext\n\t */\n\tdecrypt(ciphertext: string): Promise<string> {\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"decrypt\", ciphertext, (err, plaintext) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(plaintext!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Change access rights for file\n\t * @param adapter adapter name\n\t * @param filename file name with full path. it could be like vis.0/*\n\t * @param options like {mode: 0x644}\n\t */\n\tchmodFile(\n\t\tadapter: string | null,\n\t\tpath: string,\n\t\toptions?: { mode: number | string },\n\t): Promise<ioBroker.ChownFileResult[]> {\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"chmodFile\",\n\t\t\t\t\tadapter,\n\t\t\t\t\tpath,\n\t\t\t\t\toptions,\n\t\t\t\t\t(err, processed) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve(processed!);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Change owner or/and owner group for file\n\t * @param adapter adapter name\n\t * @param filename file name with full path. it could be like vis.0/*\n\t * @param options like {owner: 'newOwner', ownerGroup: 'newGroup'}\n\t */\n\tchownFile(\n\t\tadapter: string,\n\t\tfilename: string,\n\t\toptions?: { owner: string; ownerGroup: string },\n\t): Promise<ioBroker.ChownFileResult[]> {\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"chownFile\",\n\t\t\t\t\tadapter,\n\t\t\t\t\tfilename,\n\t\t\t\t\toptions,\n\t\t\t\t\t(err, processed) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve(processed!);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the alarm notifications from a host (only for admin connection).\n\t * @param host\n\t * @param category - optional\n\t */\n\tgetNotifications(host: string, category: string): Promise<any> {\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"getNotifications\",\n\t\t\t\t\t{ category },\n\t\t\t\t\t(notifications) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tresolve(notifications);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Clear the alarm notifications on a host (only for admin connection).\n\t * @param host\n\t * @param category - optional\n\t */\n\tclearNotifications(host: string, category: string): Promise<any> {\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendToHost\",\n\t\t\t\t\thost,\n\t\t\t\t\t\"clearNotifications\",\n\t\t\t\t\t{ category },\n\t\t\t\t\t(notifications) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tresolve(notifications);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read if only easy mode is allowed  (only for admin connection).\n\t */\n\tgetIsEasyModeStrict(): Promise<boolean> {\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getIsEasyModeStrict\", (err, isStrict) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(!!isStrict);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read easy mode configuration (only for admin connection).\n\t */\n\tgetEasyMode(): Promise<any> {\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getEasyMode\", (err, config) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(config);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read adapter ratings\n\t */\n\tgetRatings(update?: boolean): Promise<any> {\n\t\treturn this.request({\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getRatings\", !!update, (err, ratings) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(ratings);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\tgetCurrentSession(cmdTimeout?: number): any {\n\t\tconst controller = new AbortController();\n\n\t\treturn this.request({\n\t\t\tcommandTimeout: cmdTimeout || 5000,\n\t\t\tonTimeout: () => {\n\t\t\t\tcontroller.abort();\n\t\t\t},\n\t\t\texecutor: async (resolve, reject, timeout) => {\n\t\t\t\ttry {\n\t\t\t\t\tconst res = await fetch(\"./session\", {\n\t\t\t\t\t\tsignal: controller.signal,\n\t\t\t\t\t});\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tresolve(res.json());\n\t\t\t\t} catch (e) {\n\t\t\t\t\treject(`getCurrentSession: ${e}`);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read current web, socketio or admin namespace, like admin.0\n\t */\n\tgetCurrentInstance(): Promise<string> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"currentInstance\",\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getCurrentInstance\", (err, namespace) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(namespace!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get all adapter instances.\n\t * @param update Force update.\n\t */\n\t/**\n\t * Get all instances of the given adapter.\n\t * @param adapter The name of the adapter.\n\t * @param update Force update.\n\t */\n\tgetAdapterInstances(\n\t\tadapter?: string,\n\t\tupdate?: boolean,\n\t): Promise<ioBroker.InstanceObject[]> {\n\t\tif (typeof adapter === \"boolean\") {\n\t\t\tupdate = adapter;\n\t\t\tadapter = \"\";\n\t\t}\n\t\tadapter = adapter ?? \"\";\n\n\t\treturn this.request({\n\t\t\tcacheKey: `instances_${adapter}`,\n\t\t\tforceUpdate: update,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getAdapterInstances\",\n\t\t\t\t\tadapter,\n\t\t\t\t\t(err, instances) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve(instances!);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get all adapters.\n\t * @param update Force update.\n\t */\n\t/**\n\t * Get adapters with the given name.\n\t * @param adapter The name of the adapter.\n\t * @param update Force update.\n\t */\n\tgetAdapters(\n\t\tadapter?: string,\n\t\tupdate?: boolean,\n\t): Promise<ioBroker.AdapterObject[]> {\n\t\tif (typeof adapter === \"boolean\") {\n\t\t\tupdate = adapter;\n\t\t\tadapter = \"\";\n\t\t}\n\t\tadapter = adapter ?? \"\";\n\n\t\treturn this.request({\n\t\t\tcacheKey: `adapter_${adapter}`,\n\t\t\tforceUpdate: update,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getAdapters\", adapter, (err, adapters) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(adapters!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t// returns very optimized information for adapters to minimize connection load\n\tgetCompactAdapters(\n\t\tupdate?: boolean,\n\t): Promise<Record<string, CompactAdapterInfo>> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"compactAdapters\",\n\t\t\tforceUpdate: update,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getCompactAdapters\", (err, adapters) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(adapters!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t// reset cached promise, so next time the information will be requested anew\n\tgetAdaptersResetCache(adapter?: string): void {\n\t\tadapter = adapter ?? \"\";\n\t\tthis.resetCache(`adapter_${adapter}`);\n\t\tthis.resetCache(`compactAdapters`);\n\t}\n\n\t// returns very optimized information for adapters to minimize connection load\n\tgetCompactInstances(\n\t\tupdate?: boolean,\n\t): Promise<Record<string, CompactInstanceInfo>> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"compactInstances\",\n\t\t\tforceUpdate: update,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getCompactInstances\", (err, instances) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(instances!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t// reset cached promise, so next time the information will be requested anew\n\tgetAdapterInstancesResetCache(adapter?: string): void {\n\t\tadapter = adapter ?? \"\";\n\t\tthis.resetCache(`instances_${adapter}`);\n\t\tthis.resetCache(`compactInstances`);\n\t}\n\n\t// returns very optimized information for adapters to minimize connection load\n\t// reads only version of installed adapter\n\tgetCompactInstalled(\n\t\thost: string,\n\t\tupdate?: boolean,\n\t\tcmdTimeout?: number,\n\t): Promise<CompactInstalledInfo> {\n\t\thost = normalizeHostId(host);\n\n\t\treturn this.request({\n\t\t\tcacheKey: `installedCompact_${host}`,\n\t\t\tforceUpdate: update,\n\t\t\tcommandTimeout: cmdTimeout,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getCompactInstalled\", host, (data) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\n\t\t\t\t\tif (data === ERRORS.PERMISSION_ERROR) {\n\t\t\t\t\t\treject('May not read \"getCompactInstalled\"');\n\t\t\t\t\t} else if (!data) {\n\t\t\t\t\t\treject('Cannot read \"getCompactInstalled\"');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t// reset cached promise, so next time the information will be requested anew\n\tgetInstalledResetCache(host: string): void {\n\t\tif (!host) {\n\t\t\tthis.resetCache(`installedCompact_`, true);\n\t\t\tthis.resetCache(`installed_`, true);\n\t\t} else {\n\t\t\tthis.resetCache(`installedCompact_${host}`);\n\t\t\tthis.resetCache(`installed_${host}`);\n\t\t}\n\t}\n\n\t/**\n\t * Get the repository in compact form (only version and icon).\n\t * @param host\n\t * @param update Force update.\n\t * @param timeoutMs timeout in ms.\n\t */\n\tgetCompactRepository(\n\t\thost: string,\n\t\tupdate?: boolean,\n\t\ttimeoutMs?: number,\n\t): Promise<CompactRepository> {\n\t\thost = normalizeHostId(host);\n\n\t\treturn this.request({\n\t\t\tcacheKey: `repositoryCompact_${host}`,\n\t\t\tforceUpdate: update,\n\t\t\tcommandTimeout: timeoutMs,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getCompactRepository\", host, (data) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\n\t\t\t\t\tif (data === ERRORS.PERMISSION_ERROR) {\n\t\t\t\t\t\treject('May not read \"getCompactRepository\"');\n\t\t\t\t\t} else if (!data) {\n\t\t\t\t\t\treject('Cannot read \"getCompactRepository\"');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t// reset cached promise, so next time the information will be requested anew\n\tgetRepositoryResetCache(host: string): void {\n\t\tif (!host) {\n\t\t\tthis.resetCache(`repositoryCompact_`, true);\n\t\t\tthis.resetCache(`repository_`, true);\n\t\t} else {\n\t\t\tthis.resetCache(`repositoryCompact_${host}`);\n\t\t\tthis.resetCache(`repository_${host}`);\n\t\t}\n\t}\n\n\t/**\n\t * Get the list of all hosts in compact form (only _id, common.name, common.icon, common.color, native.hardware.networkInterfaces)\n\t * @param update Force update.\n\t */\n\tgetCompactHosts(update?: boolean): Promise<CompactHost[]> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"hostsCompact\",\n\t\t\tforceUpdate: update,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\"getCompactHosts\", (err, systemConfig) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(systemConfig!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get `system.repository` without big JSON\n\t */\n\tgetCompactSystemRepositories(\n\t\tupdate?: boolean,\n\t): Promise<CompactSystemRepository> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"repositoriesCompact\",\n\t\t\tforceUpdate: update,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getCompactSystemRepositories\",\n\t\t\t\t\t(err, systemRepositories) => {\n\t\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\t\ttimeout.clearTimeout();\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve(systemRepositories!);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n}\n","import type { ConnectionProps } from \"./ConnectionProps.js\";\nimport { createDeferredPromise } from \"./DeferredPromise.js\";\nimport type {\n\tEmitEventHandler,\n\tListenEventHandler,\n\tSocketClient,\n} from \"./SocketClient.js\";\nimport {\n\tgetObjectViewResultToArray,\n\tnormalizeHostId,\n\tpattern2RegEx,\n\twait,\n} from \"./tools.js\";\n\n/** Possible progress states. */\nexport enum PROGRESS {\n\t/** The socket is connecting. */\n\tCONNECTING = 0,\n\t/** The socket is successfully connected. */\n\tCONNECTED = 1,\n\t/** All objects are loaded. */\n\tOBJECTS_LOADED = 2,\n\t/** The socket is ready for use. */\n\tREADY = 3,\n}\n\nexport enum ERRORS {\n\tPERMISSION_ERROR = \"permissionError\",\n\tNOT_CONNECTED = \"notConnectedError\",\n\tTIMEOUT = \"timeout\",\n\tNOT_ADMIN = \"Allowed only in admin\",\n\tNOT_SUPPORTED = \"Not supported\",\n}\n\n/** @deprecated Use {@link ERRORS.PERMISSION_ERROR} instead */\nexport const PERMISSION_ERROR = ERRORS.PERMISSION_ERROR;\n/** @deprecated Use {@link ERRORS.NOT_CONNECTED} instead */\nexport const NOT_CONNECTED = ERRORS.NOT_CONNECTED;\n\n/**\n * @internal\n * Options to use for the backend request wrapper\n */\nexport interface RequestOptions<T> {\n\t/** The key that is used to cache the results for later requests of the same kind */\n\tcacheKey?: string;\n\t/** Used to bypass the cache */\n\tforceUpdate?: boolean;\n\t/** Can be used to identify the request method in error messages */\n\trequestName?: string;\n\t/**\n\t * The timeout in milliseconds after which the call will reject with a timeout error.\n\t * If no timeout is given, the default is used. Set this to `false` to explicitly disable the timeout.\n\t */\n\tcommandTimeout?: number | false;\n\t/** Will be called when the timeout elapses */\n\tonTimeout?: () => void;\n\t/** Whether the call should only be allowed in the admin adapter */\n\trequireAdmin?: boolean;\n\t/** Require certain features to be supported for this call */\n\trequireFeatures?: string[];\n\t/** The function that does the actual work */\n\texecutor: (\n\t\tresolve: (value: T | PromiseLike<T> | Promise<T>) => void,\n\t\treject: (reason?: any) => void,\n\t\t/** Can be used to check in the executor whether the request has timed out and/or stop it from timing out */\n\t\ttimeout: Readonly<{ elapsed: boolean; clearTimeout: () => void }>,\n\t) => void | Promise<void>;\n}\n\nexport type SystemConfig = NonNullable<\n\tioBroker.ObjectIdToObjectType<\"system.config\">\n>;\nexport type BinaryStateChangeHandler = (\n\tid: string,\n\tbase64: string | null,\n) => void;\n\nexport type FileChangeHandler = (\n\tid: string,\n\tfileName: string,\n\tsize: number | null, // null if deleted\n) => void;\n\nexport interface OldObject {\n\t_id: string;\n\ttype: string;\n}\n\nexport type ObjectChangeHandler = (\n\tid: string,\n\tobj: ioBroker.Object | null | undefined,\n\toldObj?: OldObject,\n) => void | Promise<void>;\n\nconst ADAPTERS = [\"material\", \"echarts\", \"vis\"];\n\nexport class Connection<\n\tCustomListenEvents extends Record<\n\t\tkeyof CustomListenEvents,\n\t\tListenEventHandler\n\t> = Record<string, never>,\n\tCustomEmitEvents extends Record<\n\t\tkeyof CustomEmitEvents,\n\t\tEmitEventHandler\n\t> = Record<string, never>,\n> {\n\tconstructor(props: Partial<ConnectionProps>) {\n\t\tthis.props = this.applyDefaultProps(props);\n\n\t\tthis.waitForSocketLib()\n\t\t\t.then(() => this.startSocket())\n\t\t\t.catch((e) => {\n\t\t\t\talert(`Socket connection could not be initialized: ${e}`);\n\t\t\t});\n\t}\n\n\tprivate applyDefaultProps(\n\t\tprops: Partial<ConnectionProps>,\n\t): ConnectionProps {\n\t\treturn {\n\t\t\t...props,\n\t\t\t// Define default props that always need to be set\n\t\t\tprotocol: props.protocol || window.location.protocol,\n\t\t\thost: props.host || window.location.hostname,\n\t\t\tport:\n\t\t\t\tprops.port ||\n\t\t\t\t(window.location.port === \"3000\" ? 8081 : window.location.port),\n\t\t\tioTimeout: Math.max(props.ioTimeout || 20000, 20000),\n\t\t\tcmdTimeout: Math.max(props.cmdTimeout || 5000, 5000),\n\t\t\tadmin5only: props.admin5only || false,\n\t\t\tautoSubscribes: props.autoSubscribes ?? [],\n\t\t\tautoSubscribeLog: props.autoSubscribeLog ?? false,\n\t\t\tdoNotLoadACL: props.doNotLoadACL ?? true,\n\t\t\tdoNotLoadAllObjects: props.doNotLoadAllObjects ?? true,\n\t\t};\n\t}\n\n\tprivate readonly props: ConnectionProps;\n\n\tprivate ignoreState: string = \"\";\n\tprivate connected: boolean = false;\n\tprivate subscribed: boolean = false;\n\tprivate firstConnect: boolean = true;\n\tpublic waitForRestart: boolean = false;\n\tpublic loaded: boolean = false;\n\tprivate simStates: Record<string, ioBroker.State> = {};\n\n\tprivate readonly statesSubscribes: Record<\n\t\tstring,\n\t\t{\n\t\t\treg: RegExp;\n\t\t\tcbs: (ioBroker.StateChangeHandler | BinaryStateChangeHandler)[];\n\t\t}\n\t> = {};\n\tprivate readonly filesSubscribes: Record<\n\t\tstring,\n\t\t{\n\t\t\tregId: RegExp;\n\t\t\tregFilePattern: RegExp;\n\t\t\tcbs: FileChangeHandler[];\n\t\t}\n\t> = {};\n\tprivate readonly objectsSubscribes: Record<\n\t\tstring,\n\t\t{ reg: RegExp; cbs: ObjectChangeHandler[] }\n\t> = {};\n\tprivate objects: Record<string, ioBroker.Object> = {};\n\tprivate states: Record<string, ioBroker.State> = {};\n\n\tpublic acl: any = null;\n\tpublic isSecure: boolean = false;\n\n\tprivate readonly onConnectionHandlers: ((connected: boolean) => void)[] =\n\t\t[];\n\tprivate readonly onLogHandlers: ((message: string) => void)[] = [];\n\n\tprivate onCmdStdoutHandler?: (id: string, text: string) => void;\n\tprivate onCmdStderrHandler?: (id: string, text: string) => void;\n\tprivate onCmdExitHandler?: (id: string, exitCode: number) => void;\n\tprivate onError(error: any): void {\n\t\t(this.props.onError ?? console.error)(error);\n\t}\n\n\t/** The socket instance */\n\tprotected _socket!: SocketClient<CustomListenEvents, CustomEmitEvents>;\n\n\tprivate _waitForSocketPromise?: Promise<void>;\n\tprivate readonly _waitForFirstConnectionPromise = createDeferredPromise();\n\n\t/** Cache for server requests */\n\tprivate readonly _promises: Record<string, Promise<any>> = {};\n\n\tprotected _authTimer: any;\n\n\tprotected _systemConfig?: SystemConfig;\n\t/** The \"system.config\" object */\n\tpublic get systemConfig(): Readonly<SystemConfig> | undefined {\n\t\treturn this._systemConfig;\n\t}\n\n\tprivate _systemLang: ioBroker.Languages = \"en\";\n\tpublic get systemLang(): ioBroker.Languages {\n\t\treturn this._systemLang;\n\t}\n\n\t/**\n\t * Checks if this connection is running in a web adapter and not in an admin.\n\t * @returns {boolean} True if running in a web adapter or in a socketio adapter.\n\t */\n\tstatic isWeb(): boolean {\n\t\treturn window.socketUrl !== undefined;\n\t}\n\n\tprivate waitForSocketLib(): Promise<void> {\n\t\t// Only wait once\n\t\tif (this._waitForSocketPromise) return this._waitForSocketPromise;\n\n\t\tthis._waitForSocketPromise = new Promise(async (resolve, reject) => {\n\t\t\t// If socket io is not yet loaded, we need to wait for it\n\t\t\tif (typeof window.io === \"undefined\") {\n\t\t\t\t// If the registerSocketOnLoad function is defined in index.html,\n\t\t\t\t// we can use it to know when the socket library was loaded\n\t\t\t\tif (typeof window.registerSocketOnLoad === \"function\") {\n\t\t\t\t\twindow.registerSocketOnLoad(() => resolve());\n\t\t\t\t} else {\n\t\t\t\t\t// otherwise we need to poll\n\t\t\t\t\tfor (let i = 1; i <= 30; i++) {\n\t\t\t\t\t\tif (window.io) return resolve();\n\t\t\t\t\t\tawait wait(100);\n\t\t\t\t\t}\n\n\t\t\t\t\treject(new Error(\"Socket library could not be loaded!\"));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolve();\n\t\t\t}\n\t\t});\n\t\treturn this._waitForSocketPromise;\n\t}\n\n\t/**\n\t * Starts the socket.io connection.\n\t */\n\tasync startSocket(): Promise<void> {\n\t\tif (this._socket) return;\n\n\t\tlet host = this.props.host;\n\t\tlet port = this.props.port;\n\t\tlet protocol = this.props.protocol.replace(\":\", \"\");\n\t\tlet path = window.location.pathname;\n\n\t\tif (\n\t\t\twindow.location.hostname === \"iobroker.net\" ||\n\t\t\twindow.location.hostname === \"iobroker.pro\"\n\t\t) {\n\t\t\tpath = \"\";\n\t\t} else {\n\t\t\t// if web adapter, socket io could be on other port or even host\n\t\t\tif (window.socketUrl) {\n\t\t\t\tconst parsed = new URL(window.socketUrl);\n\t\t\t\thost = parsed.hostname;\n\t\t\t\tport = parsed.port;\n\t\t\t\tprotocol = parsed.protocol.replace(\":\", \"\");\n\t\t\t}\n\t\t\t// get current path\n\t\t\tconst pos = path.lastIndexOf(\"/\");\n\t\t\tif (pos !== -1) {\n\t\t\t\tpath = path.substring(0, pos + 1);\n\t\t\t}\n\n\t\t\tif (Connection.isWeb()) {\n\t\t\t\t// remove one level, like echarts, vis, .... We have here: '/echarts/'\n\t\t\t\tconst parts = path.split(\"/\");\n\t\t\t\tif (parts.length > 2) {\n\t\t\t\t\tparts.pop();\n\t\t\t\t\tparts.pop();\n\t\t\t\t\t// material can have paths like this '/material/1.3.0/', so remove one more level\n\t\t\t\t\tif (ADAPTERS.includes(parts[parts.length - 1])) {\n\t\t\t\t\t\tparts.pop();\n\t\t\t\t\t}\n\t\t\t\t\tpath = parts.join(\"/\");\n\t\t\t\t\tif (!path.endsWith(\"/\")) {\n\t\t\t\t\t\tpath += \"/\";\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst url = port\n\t\t\t? `${protocol}://${host}:${port}${path}`\n\t\t\t: `${protocol}://${host}${path}`;\n\n\t\tthis._socket = window.io.connect(url, {\n\t\t\tpath: path.endsWith(\"/\") ? `${path}socket.io` : `${path}/socket.io`,\n\t\t\tquery: \"ws=true\",\n\t\t\tname: this.props.name,\n\t\t\ttimeout: this.props.ioTimeout,\n\t\t\tuuid: this.props.uuid,\n\t\t\ttoken: this.props.token,\n\t\t});\n\n\t\tthis._socket.on(\"connect\", (noTimeout) => {\n\t\t\t// If the user is not admin it takes some time to install the handlers, because all rights must be checked\n\t\t\tif (noTimeout !== true) {\n\t\t\t\tthis.connected = true;\n\t\t\t\tsetTimeout(\n\t\t\t\t\t() =>\n\t\t\t\t\t\tthis.getVersion()\n\t\t\t\t\t\t\t.then((info) => {\n\t\t\t\t\t\t\t\tconst [major, minor, patch] =\n\t\t\t\t\t\t\t\t\tinfo.version.split(\".\");\n\t\t\t\t\t\t\t\tconst v =\n\t\t\t\t\t\t\t\t\tparseInt(major, 10) * 10000 +\n\t\t\t\t\t\t\t\t\tparseInt(minor, 10) * 100 +\n\t\t\t\t\t\t\t\t\tparseInt(patch, 10);\n\t\t\t\t\t\t\t\tif (v < 40102) {\n\t\t\t\t\t\t\t\t\tthis._authTimer = null;\n\t\t\t\t\t\t\t\t\t// possible this is old version of admin\n\t\t\t\t\t\t\t\t\tthis.onPreConnect(false, false);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\t\t\t\t\t\"authenticate\",\n\t\t\t\t\t\t\t\t\t\t(isOk, isSecure) =>\n\t\t\t\t\t\t\t\t\t\t\tthis.onPreConnect(isOk, isSecure),\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch((e) =>\n\t\t\t\t\t\t\t\tthis.onError({\n\t\t\t\t\t\t\t\t\tmessage: e.toString(),\n\t\t\t\t\t\t\t\t\toperation: \"getVersion\",\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t500,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\t// iobroker websocket waits, till all handlers are installed\n\t\t\t\tthis._socket.emit(\"authenticate\", (isOk, isSecure) => {\n\t\t\t\t\tthis.onPreConnect(isOk, isSecure);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tthis._socket.on(\"reconnect\", () => {\n\t\t\tthis.props.onProgress?.(PROGRESS.READY);\n\t\t\tthis.connected = true;\n\n\t\t\tif (this.waitForRestart) {\n\t\t\t\twindow.location.reload();\n\t\t\t} else {\n\t\t\t\tthis._subscribe(true);\n\t\t\t\tthis.onConnectionHandlers.forEach((cb) => cb(true));\n\t\t\t}\n\t\t});\n\n\t\tthis._socket.on(\"disconnect\", () => {\n\t\t\tthis.connected = false;\n\t\t\tthis.subscribed = false;\n\t\t\tthis.props.onProgress?.(PROGRESS.CONNECTING);\n\t\t\tthis.onConnectionHandlers.forEach((cb) => cb(false));\n\t\t});\n\n\t\tthis._socket.on(\"reauthenticate\", () => this.authenticate());\n\n\t\tthis._socket.on(\"log\", (message) => {\n\t\t\tthis.props.onLog?.(message);\n\t\t\tthis.onLogHandlers.forEach((cb) => cb(message));\n\t\t});\n\n\t\tthis._socket.on(\"error\", (err: any) => {\n\t\t\tlet _err: string;\n\n\t\t\tif (err == undefined) {\n\t\t\t\t_err = \"\";\n\t\t\t} else if (typeof err.toString === \"function\") {\n\t\t\t\t_err = err.toString();\n\t\t\t} else {\n\t\t\t\t_err = JSON.stringify(err);\n\t\t\t\tconsole.error(`Received strange error: ${_err}`);\n\t\t\t}\n\n\t\t\tif (_err.includes(\"User not authorized\")) {\n\t\t\t\tthis.authenticate();\n\t\t\t} else if (_err.includes(\"websocket error\")) {\n\t\t\t\tconsole.error(`Socket Error => reload: ${err}`);\n\t\t\t\twindow.location.reload();\n\t\t\t} else {\n\t\t\t\tconsole.error(`Socket Error: ${err}`);\n\t\t\t}\n\t\t});\n\n\t\tthis._socket.on(\"connect_error\", (err: any) =>\n\t\t\tconsole.error(`Connect error: ${err}`),\n\t\t);\n\n\t\tthis._socket.on(\"permissionError\", (err) =>\n\t\t\tthis.onError({\n\t\t\t\tmessage: \"no permission\",\n\t\t\t\toperation: err.operation,\n\t\t\t\ttype: err.type,\n\t\t\t\tid: err.id || \"\",\n\t\t\t}),\n\t\t);\n\n\t\tthis._socket.on(\"objectChange\", (id, obj) => {\n\t\t\tsetTimeout(() => this.objectChange(id, obj), 0);\n\t\t});\n\n\t\tthis._socket.on(\"stateChange\", (id, state) => {\n\t\t\tsetTimeout(() => this.stateChange(id, state), 0);\n\t\t});\n\n\t\tthis._socket.on(\"fileChange\", (id, fileName, size) => {\n\t\t\tsetTimeout(() => this.fileChange(id, fileName, size), 0);\n\t\t});\n\n\t\tthis._socket.on(\"cmdStdout\", (id, text) => {\n\t\t\tthis.onCmdStdoutHandler?.(id, text);\n\t\t});\n\n\t\tthis._socket.on(\"cmdStderr\", (id, text) => {\n\t\t\tthis.onCmdStderrHandler?.(id, text);\n\t\t});\n\n\t\tthis._socket.on(\"cmdExit\", (id, exitCode) => {\n\t\t\tthis.onCmdExitHandler?.(id, exitCode);\n\t\t});\n\t}\n\n\t/**\n\t * Called internally.\n\t */\n\tprivate onPreConnect(isOk: boolean, isSecure: boolean) {\n\t\tif (this._authTimer) {\n\t\t\tclearTimeout(this._authTimer);\n\t\t\tthis._authTimer = null;\n\t\t}\n\n\t\tthis.connected = true;\n\t\tthis.isSecure = isSecure;\n\n\t\tif (this.waitForRestart) {\n\t\t\twindow.location.reload();\n\t\t} else {\n\t\t\tif (this.firstConnect) {\n\t\t\t\tthis.loadData();\n\t\t\t} else {\n\t\t\t\tthis.props.onProgress?.(PROGRESS.READY);\n\t\t\t}\n\n\t\t\tthis._subscribe(true);\n\t\t\tthis.onConnectionHandlers.forEach((cb) => cb(true));\n\t\t}\n\n\t\tthis._waitForFirstConnectionPromise.resolve();\n\t}\n\n\t/**\n\t * Checks if the socket is connected.\n\t * @returns {boolean} true if connected.\n\t */\n\tisConnected(): boolean {\n\t\treturn this.connected;\n\t}\n\n\t/**\n\t * Returns a promise which is resolved when the socket is connected.\n\t */\n\twaitForFirstConnection(): Promise<void> {\n\t\treturn this._waitForFirstConnectionPromise;\n\t}\n\n\t/**\n\t * Called internally.\n\t */\n\tprivate async getUserPermissions(): Promise<any> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"getUserPermissions\", (err, acl) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(acl!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/** Loads the important data and retries a couple of times if it takes too long */\n\tprivate async loadData(): Promise<void> {\n\t\tif (this.loaded) return;\n\t\tconst maxAttempts = 10;\n\t\tfor (let i = 1; i <= maxAttempts; i++) {\n\t\t\tthis.doLoadData();\n\t\t\tif (this.loaded) return;\n\t\t\tawait wait(1000);\n\t\t}\n\t}\n\n\t/**\n\t * Called after the socket is connected. Loads the necessary data.\n\t */\n\tprivate async doLoadData() {\n\t\tif (this.loaded) return;\n\n\t\t// Load ACL if not disabled\n\t\tif (!this.props.doNotLoadACL) {\n\t\t\ttry {\n\t\t\t\tthis.acl = await this.getUserPermissions();\n\t\t\t} catch (e) {\n\t\t\t\tthis.onError(`Cannot read user permissions: ${e}`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Load system config if not disabled\n\t\ttry {\n\t\t\tif (\n\t\t\t\tthis.props.admin5only &&\n\t\t\t\t!Connection.isWeb() &&\n\t\t\t\t(!window.vendorPrefix ||\n\t\t\t\t\twindow.vendorPrefix === \"@@vendorPrefix@@\")\n\t\t\t) {\n\t\t\t\tthis._systemConfig = await this.getCompactSystemConfig();\n\t\t\t} else {\n\t\t\t\tthis._systemConfig = await this.getSystemConfig();\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tthis.onError(`Cannot read system config: ${e}`);\n\t\t\treturn;\n\t\t}\n\n\t\t// Detect the system language\n\t\tthis._systemLang = this._systemConfig.common?.language;\n\t\tif (!this._systemLang) {\n\t\t\tthis._systemLang = (window.navigator.userLanguage ||\n\t\t\t\twindow.navigator.language) as any;\n\t\t\t// Browsers may report languages like \"de-DE\", \"en-US\", etc.\n\t\t\t// ioBroker expects \"de\", \"en\", ...\n\t\t\tif (/^(en|de|ru|pt|nl|fr|it|es|pl|uk)-?/.test(this._systemLang)) {\n\t\t\t\tthis._systemLang = this._systemLang.substr(0, 2) as any;\n\t\t\t} else if (\n\t\t\t\t!/^(en|de|ru|pt|nl|fr|it|es|pl|uk|zh-cn)$/.test(this._systemLang)\n\t\t\t) {\n\t\t\t\tthis._systemLang = \"en\";\n\t\t\t}\n\t\t\tthis._systemConfig.common.language = this._systemLang;\n\t\t}\n\t\tthis.props.onLanguage?.(this.systemLang);\n\n\t\t// We are now connected\n\t\tthis.loaded = true;\n\t\tthis.props.onProgress?.(PROGRESS.CONNECTED);\n\t\tthis.firstConnect = false;\n\n\t\t// Load all objects if desired\n\t\tif (!this.props.doNotLoadAllObjects) {\n\t\t\tthis.objects = await this.getObjects();\n\t\t} else if (this.props.admin5only) {\n\t\t\tthis.objects = {};\n\t\t} else {\n\t\t\tthis.objects = { \"system.config\": this._systemConfig };\n\t\t}\n\n\t\tthis.props.onProgress?.(PROGRESS.READY);\n\t\tthis.props.onReady?.(this.objects);\n\t}\n\n\t/**\n\t * Called internally.\n\t */\n\tprivate authenticate() {\n\t\tif (window.location.search.includes(\"&href=\")) {\n\t\t\twindow.location.href = `${window.location.protocol}//${window.location.host}${window.location.pathname}${window.location.search}${window.location.hash}`;\n\t\t} else {\n\t\t\twindow.location.href = `${window.location.protocol}//${window.location.host}${window.location.pathname}?login&href=${window.location.search}${window.location.hash}`;\n\t\t}\n\t}\n\n\t/**\n\t * Subscribe to the changes of the given state.\n\t * @param id The ioBroker state ID.\n\t * @param binary Set to true if the given state is binary and requires Base64 decoding.\n\t * @param cb The callback.\n\t */\n\tsubscribeState(\n\t\tid: string,\n\t\tbinary: true,\n\t\tcb: BinaryStateChangeHandler,\n\t): Promise<void>;\n\n\tsubscribeState(\n\t\tid: string,\n\t\tbinary: false,\n\t\tcb: ioBroker.StateChangeHandler,\n\t): Promise<void>;\n\n\tsubscribeState(id: string, cb: ioBroker.StateChangeHandler): Promise<void>;\n\n\tasync subscribeState(\n\t\t...args:\n\t\t\t| [id: string, binary: true, cb: BinaryStateChangeHandler]\n\t\t\t| [id: string, binary: false, cb: ioBroker.StateChangeHandler]\n\t\t\t| [id: string, cb: ioBroker.StateChangeHandler]\n\t): Promise<void> {\n\t\tlet id: string;\n\t\tlet binary: boolean;\n\t\tlet cb: ioBroker.StateChangeHandler | BinaryStateChangeHandler;\n\t\tif (args.length === 3) {\n\t\t\t[id, binary, cb] = args;\n\t\t} else {\n\t\t\t[id, cb] = args;\n\t\t\tbinary = false;\n\t\t}\n\n\t\tif (typeof cb !== \"function\") {\n\t\t\tthrow new Error(\"The state change handler must be a function!\");\n\t\t}\n\n\t\tif (!this.statesSubscribes[id]) {\n\t\t\tthis.statesSubscribes[id] = {\n\t\t\t\treg: new RegExp(pattern2RegEx(id)),\n\t\t\t\tcbs: [cb],\n\t\t\t};\n\t\t\tif (this.connected && id !== this.ignoreState) {\n\t\t\t\tthis._socket.emit(\"subscribe\", id);\n\t\t\t}\n\t\t} else {\n\t\t\t!this.statesSubscribes[id].cbs.includes(cb) &&\n\t\t\t\tthis.statesSubscribes[id].cbs.push(cb);\n\t\t}\n\n\t\tif (this.connected) {\n\t\t\t// Try to get the current value(s) of the state(s) and call the change handlers\n\t\t\tif (binary) {\n\t\t\t\tlet base64: string | undefined;\n\t\t\t\ttry {\n\t\t\t\t\tbase64 = await this.getBinaryState(id);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t`Cannot getBinaryState \"${id}\": ${JSON.stringify(e)}`,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (base64 != undefined) {\n\t\t\t\t\t(cb as BinaryStateChangeHandler)(id, base64);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet states: Record<string, ioBroker.State> | undefined;\n\t\t\t\ttry {\n\t\t\t\t\tstates = await this.getForeignStates(id);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t`Cannot getForeignStates \"${id}\": ${JSON.stringify(e)}`,\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (states) {\n\t\t\t\t\tfor (const [id, state] of Object.entries(states)) {\n\t\t\t\t\t\t(cb as ioBroker.StateChangeHandler)(id, state);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Unsubscribes the given callback from changes of the given state.\n\t * @param id The ioBroker state ID.\n\t * @param cb The callback.\n\t */\n\tunsubscribeState(id: string, cb?: ioBroker.StateChangeHandler): void {\n\t\tif (this.statesSubscribes[id]) {\n\t\t\tconst sub = this.statesSubscribes[id];\n\t\t\tif (cb) {\n\t\t\t\tconst pos = sub.cbs.indexOf(cb);\n\t\t\t\tpos !== -1 && sub.cbs.splice(pos, 1);\n\t\t\t} else {\n\t\t\t\tsub.cbs = [];\n\t\t\t}\n\n\t\t\tif (!sub.cbs || !sub.cbs.length) {\n\t\t\t\tdelete this.statesSubscribes[id];\n\t\t\t\tif (this.connected && id !== this.ignoreState) {\n\t\t\t\t\tthis._socket.emit(\"unsubscribe\", id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Subscribe to changes of the given object.\n\t * @param id The ioBroker object ID.\n\t * @param cb The callback.\n\t */\n\tsubscribeObject(id: string, cb: ObjectChangeHandler): Promise<void> {\n\t\tif (!this.objectsSubscribes[id]) {\n\t\t\tthis.objectsSubscribes[id] = {\n\t\t\t\treg: new RegExp(pattern2RegEx(id)),\n\t\t\t\tcbs: [cb],\n\t\t\t};\n\t\t\tthis.connected && this._socket.emit(\"subscribeObjects\", id);\n\t\t} else {\n\t\t\t!this.objectsSubscribes[id].cbs.includes(cb) &&\n\t\t\t\tthis.objectsSubscribes[id].cbs.push(cb);\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Unsubscribes all callbacks from changes of the given object.\n\t * @param id The ioBroker object ID.\n\t */\n\t/**\n\t * Unsubscribes the given callback from changes of the given object.\n\t * @param id The ioBroker object ID.\n\t * @param cb The callback.\n\t */\n\tunsubscribeObject(id: string, cb: ObjectChangeHandler): Promise<void> {\n\t\tif (this.objectsSubscribes[id]) {\n\t\t\tconst sub = this.objectsSubscribes[id];\n\t\t\tif (cb) {\n\t\t\t\tconst pos = sub.cbs.indexOf(cb);\n\t\t\t\tpos !== -1 && sub.cbs.splice(pos, 1);\n\t\t\t} else {\n\t\t\t\tsub.cbs = [];\n\t\t\t}\n\n\t\t\tif (this.connected && (!sub.cbs || !sub.cbs.length)) {\n\t\t\t\tdelete this.objectsSubscribes[id];\n\t\t\t\tthis.connected && this._socket.emit(\"unsubscribeObjects\", id);\n\t\t\t}\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Called internally.\n\t * @param id\n\t * @param obj\n\t */\n\tprivate objectChange(id: string, obj: ioBroker.Object | null | undefined) {\n\t\t// update main.objects cache\n\n\t\t// Remember the id and type of th old object\n\t\tlet oldObj: OldObject | undefined;\n\t\tif (this.objects[id]) {\n\t\t\toldObj = { _id: id, type: this.objects[id].type };\n\t\t}\n\n\t\tlet changed = false;\n\t\tif (obj) {\n\t\t\t// The object was added, updated or changed\n\n\t\t\t// Copy the _rev property (whatever that is)\n\t\t\tif ((obj as any)._rev && this.objects[id]) {\n\t\t\t\t(this.objects[id] as any)._rev = (obj as any)._rev;\n\t\t\t}\n\n\t\t\t// Detect if there was a change\n\t\t\tif (\n\t\t\t\t!this.objects[id] ||\n\t\t\t\tJSON.stringify(this.objects[id]) !== JSON.stringify(obj)\n\t\t\t) {\n\t\t\t\tthis.objects[id] = obj;\n\t\t\t\tchanged = true;\n\t\t\t}\n\t\t} else if (this.objects[id]) {\n\t\t\t// The object was deleted\n\t\t\tdelete this.objects[id];\n\t\t\tchanged = true;\n\t\t}\n\n\t\t// Notify all subscribed listeners\n\t\tfor (const [_id, sub] of Object.entries(this.objectsSubscribes)) {\n\t\t\tif (_id === id || sub.reg.test(id)) {\n\t\t\t\tsub.cbs.forEach((cb) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tcb(id, obj, oldObj);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\t`Error by callback of objectChange: ${e}`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Notify the default listener on change\n\t\tif (changed) this.props.onObjectChange?.(id, obj);\n\t}\n\n\t/**\n\t * Called internally.\n\t * @param id\n\t * @param state\n\t */\n\tprivate stateChange(id: string, state: ioBroker.State | null | undefined) {\n\t\tfor (const sub of Object.values(this.statesSubscribes)) {\n\t\t\tif (sub.reg.test(id)) {\n\t\t\t\tfor (const cb of sub.cbs) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// TODO: This might not be correct - check what happens if state is a binary state\n\t\t\t\t\t\tcb(id, (state ?? null) as any);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\t`Error by callback of stateChanged: ${e}`,\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Called internally.\n\t * @param id\n\t * @param fileName\n\t * @param size\n\t */\n\tprivate fileChange(id: string, fileName: string, size: number | null) {\n\t\tfor (const sub of Object.values(this.filesSubscribes)) {\n\t\t\tif (sub.regId.test(id) && sub.regFilePattern.test(fileName)) {\n\t\t\t\tfor (const cb of sub.cbs) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tcb(id, fileName, size);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconsole.error(`Error by callback of fileChange: ${e}`);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Subscribe to changes of the files.\n\t * @param id The ioBroker state ID for meat object. Could be a pattern\n\t * @param filePattern Pattern or file name, like 'main/*' or 'main/visViews.json`\n\t * @param cb The callback.\n\t */\n\tasync subscribeFiles(\n\t\tid: string,\n\t\tfilePattern: string,\n\t\tcb: FileChangeHandler,\n\t): Promise<void> {\n\t\tif (typeof cb !== \"function\") {\n\t\t\tthrow new Error(\"The state change handler must be a function!\");\n\t\t}\n\t\tconst key = `${id}$%$${filePattern}`;\n\n\t\tif (!this.filesSubscribes[key]) {\n\t\t\tthis.filesSubscribes[key] = {\n\t\t\t\tregId: new RegExp(pattern2RegEx(id)),\n\t\t\t\tregFilePattern: new RegExp(pattern2RegEx(filePattern)),\n\t\t\t\tcbs: [cb],\n\t\t\t};\n\t\t\tthis.connected &&\n\t\t\t\tthis._socket.emit(\"subscribeFiles\", id, filePattern);\n\t\t} else {\n\t\t\t!this.filesSubscribes[key].cbs.includes(cb) &&\n\t\t\t\tthis.filesSubscribes[key].cbs.push(cb);\n\t\t}\n\t}\n\n\t/**\n\t * Unsubscribes the given callback from changes of files.\n\t * @param id The ioBroker state ID.\n\t * @param filePattern Pattern or file name, like 'main/*' or 'main/visViews.json`\n\t * @param cb The callback.\n\t */\n\tunsubscribeFiles(\n\t\tid: string,\n\t\tfilePattern: string,\n\t\tcb?: FileChangeHandler,\n\t): void {\n\t\tconst key = `${id}$%$${filePattern}`;\n\t\tif (this.filesSubscribes[key]) {\n\t\t\tconst sub = this.filesSubscribes[key];\n\t\t\tif (cb) {\n\t\t\t\tconst pos = sub.cbs.indexOf(cb);\n\t\t\t\tpos !== -1 && sub.cbs.splice(pos, 1);\n\t\t\t} else {\n\t\t\t\tsub.cbs = [];\n\t\t\t}\n\n\t\t\tif (!sub.cbs || !sub.cbs.length) {\n\t\t\t\tdelete this.filesSubscribes[key];\n\t\t\t\tthis.connected &&\n\t\t\t\t\tthis._socket.emit(\"unsubscribeFiles\", id, filePattern);\n\t\t\t}\n\t\t}\n\t}\n\n\t/** Requests data from the server or reads it from the cache */\n\tprotected async request<T>({\n\t\tcacheKey,\n\t\tforceUpdate,\n\t\tcommandTimeout,\n\t\tonTimeout,\n\t\trequireAdmin,\n\t\trequireFeatures,\n\t\t// requestName,\n\t\texecutor,\n\t}: RequestOptions<T>): Promise<T> {\n\t\t// TODO: mention requestName in errors\n\n\t\t// If the command requires the admin adapter, enforce it\n\t\tif (requireAdmin && Connection.isWeb()) {\n\t\t\treturn Promise.reject(ERRORS.NOT_ADMIN);\n\t\t}\n\n\t\t// Return the cached value if allowed\n\t\tif (cacheKey && !forceUpdate && cacheKey in this._promises) {\n\t\t\treturn this._promises[cacheKey];\n\t\t}\n\n\t\t// Require the socket to be connected\n\t\tif (!this.connected) {\n\t\t\treturn Promise.reject(ERRORS.NOT_CONNECTED);\n\t\t}\n\n\t\t// Check if all required features are supported\n\t\tif (requireFeatures?.length) {\n\t\t\tfor (const feature of requireFeatures) {\n\t\t\t\tif (!(await this.checkFeatureSupported(feature))) {\n\t\t\t\t\tthrow ERRORS.NOT_SUPPORTED;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst promise = new Promise<T>(async (resolve, reject) => {\n\t\t\tconst timeoutControl = {\n\t\t\t\telapsed: false,\n\t\t\t\tclearTimeout: () => {\n\t\t\t\t\t// no-op unless there is a timeout\n\t\t\t\t},\n\t\t\t};\n\t\t\tlet timeout: NodeJS.Timeout | undefined;\n\t\t\tif (commandTimeout !== false) {\n\t\t\t\ttimeout = setTimeout(() => {\n\t\t\t\t\ttimeoutControl.elapsed = true;\n\t\t\t\t\t// Let the caller know that the timeout elapsed\n\t\t\t\t\tonTimeout?.();\n\t\t\t\t\treject(ERRORS.TIMEOUT);\n\t\t\t\t}, commandTimeout ?? this.props.cmdTimeout);\n\t\t\t\ttimeoutControl.clearTimeout = () => {\n\t\t\t\t\tclearTimeout(timeout!);\n\t\t\t\t};\n\t\t\t}\n\t\t\t// Call the actual function - awaiting it allows us to catch sync and async errors\n\t\t\t// no matter if the executor is async or not\n\t\t\ttry {\n\t\t\t\tawait executor(resolve, reject, timeoutControl);\n\t\t\t} catch (e) {\n\t\t\t\treject(e);\n\t\t\t}\n\t\t});\n\t\tif (cacheKey) {\n\t\t\tthis._promises[cacheKey] = promise;\n\t\t}\n\t\treturn promise;\n\t}\n\n\t/**\n\t * Deletes cached promise.\n\t * So next time the information will be requested anew\n\t */\n\tresetCache(key: string, isAll?: boolean): void {\n\t\tif (isAll) {\n\t\t\tObject.keys(this._promises)\n\t\t\t\t.filter((k) => k.startsWith(key))\n\t\t\t\t.forEach((k) => {\n\t\t\t\t\tdelete this._promises[k];\n\t\t\t\t});\n\t\t} else {\n\t\t\tdelete this._promises[key];\n\t\t}\n\t}\n\n\t/**\n\t * Gets all states.\n\t * @param pattern Pattern of states or array of IDs\n\t */\n\tgetStates(\n\t\tpattern?: string | string[],\n\t): Promise<Record<string, ioBroker.State>> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"getStates\", pattern, (err, res) => {\n\t\t\t\t\tthis.states = res ?? {};\n\n\t\t\t\t\t// if (!disableProgressUpdate) {\n\t\t\t\t\t// \tthis.props.onProgress?.(PROGRESS.STATES_LOADED);\n\t\t\t\t\t// }\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(this.states);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Gets the given state.\n\t * @param id The state ID.\n\t */\n\tgetState(id: string): Promise<ioBroker.State | null | undefined> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tif (id && id === this.ignoreState) {\n\t\t\t\t\tresolve(this.simStates[id] || { val: null, ack: true });\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._socket.emit(\"getState\", id, (err, state) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(state);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Gets the given binary state Base64 encoded.\n\t * @deprecated since js-controller 5.0. Use files instead.\n\t * @param id The state ID.\n\t */\n\tgetBinaryState(id: string): Promise<string | undefined> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"getBinaryState\", id, (err, state) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(state);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Sets the given binary state.\n\t * @deprecated since js-controller 5.0. Use files instead.\n\t * @param id The state ID.\n\t * @param base64 The Base64 encoded binary data.\n\t */\n\tsetBinaryState(id: string, base64: string): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"setBinaryState\", id, base64, (err) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Sets the given state value.\n\t * @param id The state ID.\n\t * @param val The state value.\n\t * @param ack Acknowledge flag.\n\t */\n\tsetState(\n\t\tid: string,\n\t\tval: ioBroker.State | ioBroker.StateValue | ioBroker.SettableState,\n\t\tack?: boolean,\n\t): Promise<void> {\n\t\tif (typeof ack === \"boolean\") {\n\t\t\tval = { val: val as ioBroker.StateValue, ack };\n\t\t}\n\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\t// extra handling for \"nothing_selected\" state for vis\n\t\t\t\tif (id && id === this.ignoreState) {\n\t\t\t\t\tlet state: ioBroker.State;\n\n\t\t\t\t\tif (typeof ack === \"boolean\") {\n\t\t\t\t\t\tstate = val as ioBroker.State;\n\t\t\t\t\t} else if (\n\t\t\t\t\t\ttypeof val === \"object\" &&\n\t\t\t\t\t\t(val as ioBroker.State).val !== undefined\n\t\t\t\t\t) {\n\t\t\t\t\t\tstate = val as ioBroker.State;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstate = {\n\t\t\t\t\t\t\tval: val as ioBroker.StateValue,\n\t\t\t\t\t\t\tack: false,\n\t\t\t\t\t\t\tts: Date.now(),\n\t\t\t\t\t\t\tlc: Date.now(),\n\t\t\t\t\t\t\tfrom: \"system.adapter.vis.0\",\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.simStates[id] = state;\n\n\t\t\t\t\t// inform subscribers about changes\n\t\t\t\t\tif (this.statesSubscribes[id]) {\n\t\t\t\t\t\tfor (const cb of this.statesSubscribes[id].cbs) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tcb(id, state as any);\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\t\t\t`Error by callback of stateChanged: ${e}`,\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._socket.emit(\"setState\", id, val, (err) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Gets all objects.\n\t * @param update Callback that is executed when all objects are retrieved.\n\t */\n\t/**\n\t * Gets all objects.\n\t * @param update Set to true to retrieve all objects from the server (instead of using the local cache).\n\t * @param disableProgressUpdate don't call onProgress() when done\n\t */\n\tgetObjects(\n\t\tupdate?: boolean,\n\t\tdisableProgressUpdate?: boolean,\n\t): Promise<Record<string, ioBroker.Object>> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tif (!update && this.objects) {\n\t\t\t\t\tresolve(this.objects);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\tConnection.isWeb() ? \"getObjects\" : \"getAllObjects\",\n\t\t\t\t\t(err, res) => {\n\t\t\t\t\t\tif (!disableProgressUpdate)\n\t\t\t\t\t\t\tthis.props.onProgress?.(PROGRESS.OBJECTS_LOADED);\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tthis.objects = res ?? {};\n\t\t\t\t\t\tresolve(this.objects);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Called internally.\n\t * @param isEnable\n\t */\n\tprivate _subscribe(isEnable: boolean) {\n\t\tif (isEnable && !this.subscribed) {\n\t\t\tthis.subscribed = true;\n\t\t\tif (this.props.autoSubscribes) {\n\t\t\t\tthis.props.autoSubscribes.forEach((id) =>\n\t\t\t\t\tthis._socket.emit(\"subscribeObjects\", id),\n\t\t\t\t);\n\t\t\t}\n\t\t\t// re subscribe objects\n\t\t\tObject.keys(this.objectsSubscribes).forEach((id) =>\n\t\t\t\tthis._socket.emit(\"subscribeObjects\", id),\n\t\t\t);\n\t\t\t// re-subscribe logs\n\t\t\tthis.props.autoSubscribeLog &&\n\t\t\t\tthis._socket.emit(\"requireLog\", true);\n\t\t\t// re subscribe states\n\t\t\tObject.keys(this.statesSubscribes).forEach((id) =>\n\t\t\t\tthis._socket.emit(\"subscribe\", id),\n\t\t\t);\n\t\t\t// re-subscribe files\n\t\t\tObject.keys(this.filesSubscribes).forEach((key) => {\n\t\t\t\tconst [id, filePattern] = key.split(\"$%$\");\n\t\t\t\tthis._socket.emit(\"subscribeFiles\", id, filePattern);\n\t\t\t});\n\t\t} else if (!isEnable && this.subscribed) {\n\t\t\tthis.subscribed = false;\n\t\t\t// un-subscribe objects\n\t\t\tif (this.props.autoSubscribes) {\n\t\t\t\tthis.props.autoSubscribes.forEach((id) =>\n\t\t\t\t\tthis._socket.emit(\"unsubscribeObjects\", id),\n\t\t\t\t);\n\t\t\t}\n\t\t\tObject.keys(this.objectsSubscribes).forEach((id) =>\n\t\t\t\tthis._socket.emit(\"unsubscribeObjects\", id),\n\t\t\t);\n\t\t\t// un-subscribe logs\n\t\t\tthis.props.autoSubscribeLog &&\n\t\t\t\tthis._socket.emit(\"requireLog\", false);\n\n\t\t\t// un-subscribe states\n\t\t\tObject.keys(this.statesSubscribes).forEach((id) =>\n\t\t\t\tthis._socket.emit(\"unsubscribe\", id),\n\t\t\t);\n\t\t\t// re-subscribe files\n\t\t\tObject.keys(this.filesSubscribes).forEach((key) => {\n\t\t\t\tconst [id, filePattern] = key.split(\"$%$\");\n\t\t\t\tthis._socket.emit(\"unsubscribeFiles\", id, filePattern);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Requests log updates.\n\t * @param isEnabled Set to true to get logs.\n\t */\n\trequireLog(isEnabled: boolean): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"requireLog\", isEnabled, (err) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Deletes the given object.\n\t * @param id The object ID.\n\t * @param maintenance Force deletion of non conform IDs.\n\t */\n\tdelObject(id: string, maintenance: boolean = false): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"delObject\", id, { maintenance }, (err) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Deletes the given object and all its children.\n\t * @param id The object ID.\n\t * @param maintenance Force deletion of non conform IDs.\n\t */\n\tdelObjects(id: string, maintenance: boolean): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"delObjects\", id, { maintenance }, (err) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Sets the object.\n\t * @param id The object ID.\n\t * @param obj The object.\n\t */\n\tsetObject(id: string, obj: ioBroker.SettableObject): Promise<void> {\n\t\tif (!obj) {\n\t\t\treturn Promise.reject(\"Null object is not allowed\");\n\t\t}\n\n\t\tobj = JSON.parse(JSON.stringify(obj));\n\t\tdelete obj.from;\n\t\tdelete obj.user;\n\t\tdelete obj.ts;\n\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"setObject\", id, obj, (err) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Gets the object with the given id from the server.\n\t * @param id The object ID.\n\t * @returns {ioBroker.GetObjectPromise} The object.\n\t */\n\tgetObject<T extends string>(id: T): ioBroker.GetObjectPromise<T> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tif (id && id === this.ignoreState) {\n\t\t\t\t\tresolve({\n\t\t\t\t\t\t_id: this.ignoreState,\n\t\t\t\t\t\ttype: \"state\",\n\t\t\t\t\t\tcommon: {\n\t\t\t\t\t\t\tname: \"ignored state\",\n\t\t\t\t\t\t\ttype: \"mixed\",\n\t\t\t\t\t\t},\n\t\t\t\t\t} as any);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis._socket.emit(\"getObject\", id, (err, obj) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(obj as any);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Sends a message to a specific instance or all instances of some specific adapter.\n\t * @param instance The instance to send this message to.\n\t * @param command Command name of the target instance.\n\t * @param data The message data to send.\n\t */\n\tsendTo<T = any>(instance: string, command: string, data?: any): Promise<T> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"sendTo\",\n\t\t\t\t\tinstance,\n\t\t\t\t\tcommand,\n\t\t\t\t\tdata,\n\t\t\t\t\t(result: any) => {\n\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Extend an object and create it if it might not exist.\n\t * @param id The id.\n\t * @param obj The object.\n\t */\n\textendObject(id: string, obj: ioBroker.PartialObject): Promise<void> {\n\t\tif (!obj) {\n\t\t\treturn Promise.reject(\"Null object is not allowed\");\n\t\t}\n\n\t\tobj = JSON.parse(JSON.stringify(obj));\n\t\tdelete obj.from;\n\t\tdelete obj.user;\n\t\tdelete obj.ts;\n\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"extendObject\", id, obj, (err) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Register a handler for log messages.\n\t * @param handler The handler.\n\t */\n\tregisterLogHandler(handler: (message: string) => void): void {\n\t\tif (!this.onLogHandlers.includes(handler)) {\n\t\t\tthis.onLogHandlers.push(handler);\n\t\t}\n\t}\n\n\t/**\n\t * Unregister a handler for log messages.\n\t * @param handler The handler.\n\t */\n\tunregisterLogHandler(handler: (message: string) => void): void {\n\t\tconst pos = this.onLogHandlers.indexOf(handler);\n\t\tpos !== -1 && this.onLogHandlers.splice(pos, 1);\n\t}\n\n\t/**\n\t * Register a handler for the connection state.\n\t * @param handler The handler.\n\t */\n\tregisterConnectionHandler(handler: (connected: boolean) => void): void {\n\t\tif (!this.onConnectionHandlers.includes(handler)) {\n\t\t\tthis.onConnectionHandlers.push(handler);\n\t\t}\n\t}\n\n\t/**\n\t * Unregister a handler for the connection state.\n\t * @param handler The handler.\n\t */\n\tunregisterConnectionHandler(handler: (connected: boolean) => void): void {\n\t\tconst pos = this.onConnectionHandlers.indexOf(handler);\n\t\tpos !== -1 && this.onConnectionHandlers.splice(pos, 1);\n\t}\n\n\t/**\n\t * Set the handler for standard output of a command.\n\t * @param handler The handler.\n\t */\n\tregisterCmdStdoutHandler(\n\t\thandler: (id: string, text: string) => void,\n\t): void {\n\t\tthis.onCmdStdoutHandler = handler;\n\t}\n\n\t/**\n\t * Unset the handler for standard output of a command.\n\t */\n\tunregisterCmdStdoutHandler(): void {\n\t\tthis.onCmdStdoutHandler = undefined;\n\t}\n\n\t/**\n\t * Set the handler for standard error of a command.\n\t * @param handler The handler.\n\t */\n\tregisterCmdStderrHandler(\n\t\thandler: (id: string, text: string) => void,\n\t): void {\n\t\tthis.onCmdStderrHandler = handler;\n\t}\n\n\t/**\n\t * Unset the handler for standard error of a command.\n\t */\n\tunregisterCmdStderrHandler(): void {\n\t\tthis.onCmdStderrHandler = undefined;\n\t}\n\n\t/**\n\t * Set the handler for exit of a command.\n\t * @param handler The handler.\n\t */\n\tregisterCmdExitHandler(\n\t\thandler: (id: string, exitCode: number) => void,\n\t): void {\n\t\tthis.onCmdExitHandler = handler;\n\t}\n\n\t/**\n\t * Unset the handler for exit of a command.\n\t */\n\tunregisterCmdExitHandler(): void {\n\t\tthis.onCmdExitHandler = undefined;\n\t}\n\n\t/**\n\t * Get all enums with the given name.\n\t * @param _enum The name of the enum, like `rooms` or `functions`\n\t * @param update Force update.\n\t */\n\tgetEnums(\n\t\t_enum?: string,\n\t\tupdate?: boolean,\n\t): Promise<Record<string, ioBroker.EnumObject>> {\n\t\treturn this.request({\n\t\t\tcacheKey: `enums_${_enum || \"all\"}`,\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getObjectView\",\n\t\t\t\t\t\"system\",\n\t\t\t\t\t\"enum\",\n\t\t\t\t\t{\n\t\t\t\t\t\tstartkey: `enum.${_enum || \"\"}`,\n\t\t\t\t\t\tendkey: _enum ? `enum.${_enum}.\\u9999` : `enum.\\u9999`,\n\t\t\t\t\t},\n\t\t\t\t\t(err, res) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tconst _res: Record<string, ioBroker.EnumObject> = {};\n\t\t\t\t\t\tif (res) {\n\t\t\t\t\t\t\tfor (let i = 0; i < res.rows.length; i++) {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t_enum &&\n\t\t\t\t\t\t\t\t\tres.rows[i].id === `enum.${_enum}`\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t_res[res.rows[i].id] = res.rows[i]\n\t\t\t\t\t\t\t\t\t.value as ioBroker.EnumObject;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(_res);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * @deprecated since version 1.1.15, cause parameter order does not match backend\n\t * Query a predefined object view.\n\t * @param start The start ID.\n\t * @param end The end ID.\n\t * @param type The type of object.\n\t * @param {string} [design=system] design - 'system' or other designs like `custom`, but it must exist object `_design/custom`. Too 99,9% use `system` (Exception for example 'charts').\n\t */\n\tgetObjectView<T extends ioBroker.ObjectType>(\n\t\tstart: string,\n\t\tend: string,\n\t\ttype: T,\n\t) {\n\t\treturn this.getObjectViewCustom(\"system\", type, start, end);\n\t}\n\n\t/**\n\t * Query a predefined object view.\n\t * @param type The type of object.\n\t * @param start The start ID.\n\t * @param [end] The end ID.\n\t */\n\tgetObjectViewSystem<T extends ioBroker.ObjectType>(\n\t\ttype: T,\n\t\tstart: string,\n\t\tend?: string,\n\t) {\n\t\treturn this.getObjectViewCustom(\"system\", type, start, end);\n\t}\n\n\t/**\n\t * Query a predefined object view.\n\t * @param design design - 'system' or other designs like `custom`.\n\t * @param type The type of object.\n\t * @param start The start ID.\n\t * @param [end] The end ID.\n\t */\n\tgetObjectViewCustom<T extends ioBroker.ObjectType>(\n\t\tdesign: string,\n\t\ttype: T,\n\t\tstart: string,\n\t\tend?: string,\n\t): Promise<Record<string, ioBroker.AnyObject & { type: T }>> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tstart = start || \"\";\n\t\t\t\tend = end || \"\\u9999\";\n\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getObjectView\",\n\t\t\t\t\tdesign,\n\t\t\t\t\ttype,\n\t\t\t\t\t{ startkey: start, endkey: end },\n\t\t\t\t\t(err, res) => {\n\t\t\t\t\t\tif (err) reject(err);\n\n\t\t\t\t\t\tconst _res: Record<\n\t\t\t\t\t\t\tstring,\n\t\t\t\t\t\t\tioBroker.AnyObject & { type: T }\n\t\t\t\t\t\t> = {};\n\t\t\t\t\t\tif (res && res.rows) {\n\t\t\t\t\t\t\tfor (let i = 0; i < res.rows.length; i++) {\n\t\t\t\t\t\t\t\t_res[res.rows[i].id] = res.rows[i].value as any;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(_res);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read the meta items.\n\t */\n\treadMetaItems(): Promise<ioBroker.Object[]> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getObjectView\",\n\t\t\t\t\t\"system\",\n\t\t\t\t\t\"meta\",\n\t\t\t\t\t{ startkey: \"\", endkey: \"\\u9999\" },\n\t\t\t\t\t(err, objs) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve(\n\t\t\t\t\t\t\tobjs!.rows\n\t\t\t\t\t\t\t\t?.map((obj) => obj.value)\n\t\t\t\t\t\t\t\t.filter((val): val is ioBroker.Object => !!val),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read the directory of an adapter.\n\t * @param adapterName The adapter name.\n\t * @param path The directory name.\n\t */\n\treadDir(\n\t\tadapterName: string | null,\n\t\tpath: string,\n\t): Promise<ioBroker.ReadDirResult[]> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"readDir\",\n\t\t\t\t\tadapterName,\n\t\t\t\t\tpath,\n\t\t\t\t\t(err, files) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve(files!);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read a file of an adapter.\n\t * @param {string} adapterName The adapter name.\n\t * @param {string} fileName The file name.\n\t * @param {boolean} base64 If it must be a base64 format\n\t * @returns {Promise<string>}\n\t */\n\treadFile(\n\t\tadapterName: string | null,\n\t\tfileName: string,\n\t\tbase64?: boolean,\n\t): Promise<{ file: string; mimeType: string }> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\tbase64 ? \"readFile64\" : \"readFile\",\n\t\t\t\t\tadapterName,\n\t\t\t\t\tfileName,\n\t\t\t\t\t(err, data, type) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve({ file: data as string, mimeType: type! });\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Write a file of an adapter.\n\t * @param adapter The adapter name.\n\t * @param fileName The file name.\n\t * @param data The data (if it's a Buffer, it will be converted to Base64).\n\t */\n\twriteFile64(\n\t\tadapter: string,\n\t\tfileName: string,\n\t\tdata: Buffer | string,\n\t): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tif (typeof data === \"string\") {\n\t\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\t\"writeFile\",\n\t\t\t\t\t\tadapter,\n\t\t\t\t\t\tfileName,\n\t\t\t\t\t\tdata,\n\t\t\t\t\t\t(err) => {\n\t\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tconst base64 = btoa(\n\t\t\t\t\t\tnew Uint8Array(data).reduce(\n\t\t\t\t\t\t\t(data, byte) => data + String.fromCharCode(byte),\n\t\t\t\t\t\t\t\"\",\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\n\t\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\t\"writeFile64\",\n\t\t\t\t\t\tadapter,\n\t\t\t\t\t\tfileName,\n\t\t\t\t\t\tbase64,\n\t\t\t\t\t\t(err) => {\n\t\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Delete a file of an adapter.\n\t * @param adapter The adapter name.\n\t * @param fileName The file name.\n\t */\n\tdeleteFile(adapter: string, fileName: string): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"deleteFile\", adapter, fileName, (err) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Delete a folder of an adapter.\n\t * @param adapter The adapter name.\n\t * @param folderName The folder name.\n\t */\n\tdeleteFolder(adapter: string, folderName: string): Promise<void> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"deleteFolder\",\n\t\t\t\t\tadapter,\n\t\t\t\t\tfolderName,\n\t\t\t\t\t(err) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Execute a command on a host.\n\t * @param host The host name.\n\t * @param cmd The command.\n\t * @param cmdId The command ID.\n\t * @param cmdTimeout Timeout of command in ms\n\t */\n\tcmdExec(\n\t\thost: string,\n\t\tcmd: string,\n\t\tcmdId: string,\n\t\tcmdTimeout?: number,\n\t): Promise<void> {\n\t\treturn this.request({\n\t\t\tcommandTimeout: cmdTimeout,\n\t\t\texecutor: (resolve, reject, timeout) => {\n\t\t\t\thost = normalizeHostId(host);\n\n\t\t\t\tthis._socket.emit(\"cmdExec\", host, cmdId, cmd, (err) => {\n\t\t\t\t\tif (timeout.elapsed) return;\n\t\t\t\t\ttimeout.clearTimeout();\n\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Gets the system configuration.\n\t * @param update Force update.\n\t */\n\tgetSystemConfig(update?: boolean): Promise<SystemConfig> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"systemConfig\",\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: async (resolve) => {\n\t\t\t\tlet systemConfig = await this.getObject(\"system.config\");\n\t\t\t\t(systemConfig as any) ??= {};\n\t\t\t\t(systemConfig as any).common ??= {};\n\t\t\t\t(systemConfig as any).native ??= {};\n\n\t\t\t\tresolve(systemConfig!);\n\t\t\t},\n\t\t});\n\t}\n\n\t// returns very optimized information for adapters to minimize connection load\n\tgetCompactSystemConfig(update?: boolean): Promise<SystemConfig> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"systemConfigCommon\",\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\trequireAdmin: true,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getCompactSystemConfig\",\n\t\t\t\t\t(err, systemConfig) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\t(systemConfig as any) ??= {};\n\t\t\t\t\t\t(systemConfig as any).common ??= {};\n\t\t\t\t\t\t(systemConfig as any).native ??= {};\n\t\t\t\t\t\tresolve(systemConfig!);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read all states (which might not belong to this adapter) which match the given pattern.\n\t * @param pattern\n\t */\n\tgetForeignStates(\n\t\tpattern?: string | null | undefined,\n\t): ioBroker.GetStatesPromise {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getForeignStates\",\n\t\t\t\t\tpattern || \"*\",\n\t\t\t\t\t(err, states) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve(states ?? {});\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get foreign objects by pattern, by specific type and resolve their enums.\n\t * @param pattern\n\t * @param type\n\t */\n\tgetForeignObjects<T extends ioBroker.ObjectType>(\n\t\tpattern: string | null | undefined,\n\t\ttype: T,\n\t): Promise<Record<string, ioBroker.AnyObject & { type: T }>> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getForeignObjects\",\n\t\t\t\t\tpattern || \"*\",\n\t\t\t\t\ttype,\n\t\t\t\t\t(err, objects) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve(objects as any);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Sets the system configuration.\n\t * @param obj\n\t */\n\tsetSystemConfig(\n\t\tobj: ioBroker.SettableObjectWorker<ioBroker.OtherObject>,\n\t): Promise<void> {\n\t\treturn this.setObject(\"system.config\", obj);\n\t}\n\n\t/**\n\t * Get the raw socket.io socket.\n\t */\n\tgetRawSocket(): any {\n\t\treturn this._socket;\n\t}\n\n\t/**\n\t * Get the history of a given state.\n\t * @param id\n\t * @param options\n\t */\n\tgetHistory(\n\t\tid: string,\n\t\toptions: ioBroker.GetHistoryOptions,\n\t): Promise<ioBroker.GetHistoryResult> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"getHistory\", id, options, (err, values) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(values!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the history of a given state.\n\t * @param id\n\t * @param options\n\t */\n\tgetHistoryEx(\n\t\tid: string,\n\t\toptions: ioBroker.GetHistoryOptions,\n\t): Promise<{\n\t\tvalues: ioBroker.GetHistoryResult;\n\t\tsessionId: string;\n\t\tstepIgnore: number;\n\t}> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getHistory\",\n\t\t\t\t\tid,\n\t\t\t\t\toptions,\n\t\t\t\t\t(err, values, stepIgnore, sessionId) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve({\n\t\t\t\t\t\t\tvalues: values!,\n\t\t\t\t\t\t\tsessionId: sessionId!,\n\t\t\t\t\t\t\t// TODO: WTF is up with the ignore thing?\n\t\t\t\t\t\t\tstepIgnore: stepIgnore!,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the IP addresses of the given host.\n\t * @param host\n\t * @param update Force update.\n\t */\n\tgetIpAddresses(host: string, update?: boolean): Promise<string[]> {\n\t\thost = normalizeHostId(host);\n\t\treturn this.request({\n\t\t\tcacheKey: `IPs_${host}`,\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: async (resolve) => {\n\t\t\t\tconst obj = await this.getObject(host);\n\t\t\t\tresolve(obj?.common.address ?? []);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Gets the version.\n\t */\n\tgetVersion(\n\t\tupdate?: boolean,\n\t): Promise<{ version: string; serverName: string }> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"version\",\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"getVersion\", (err, version, serverName) => {\n\t\t\t\t\t// Old socket.io had no error parameter\n\t\t\t\t\tif (\n\t\t\t\t\t\terr &&\n\t\t\t\t\t\t!version &&\n\t\t\t\t\t\ttypeof err === \"string\" &&\n\t\t\t\t\t\terr.match(/\\d+\\.\\d+\\.\\d+/)\n\t\t\t\t\t) {\n\t\t\t\t\t\tresolve({ version: err, serverName: \"socketio\" });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve({ version: version!, serverName: serverName! });\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Gets the web server name.\n\t */\n\tgetWebServerName(): Promise<string> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"webName\",\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"getAdapterName\", (err, name) => {\n\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\tresolve(name!);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Check if the file exists\n\t * @param adapter adapter name\n\t * @param filename file name with full path. it could be like vis.0/*\n\t */\n\tfileExists(adapter: string, filename: string): Promise<boolean> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"fileExists\",\n\t\t\t\t\tadapter,\n\t\t\t\t\tfilename,\n\t\t\t\t\t(err, exists) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve(!!exists);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Read current user\n\t */\n\tgetCurrentUser(): Promise<string> {\n\t\treturn this.request({\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve) => {\n\t\t\t\tthis._socket.emit(\"authEnabled\", (_isSecure, user) => {\n\t\t\t\t\tresolve(user);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get uuid\n\t */\n\tgetUuid(): Promise<ioBroker.Object[]> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"uuid\",\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: async (resolve) => {\n\t\t\t\tconst obj = await this.getObject(\"system.meta.uuid\");\n\t\t\t\tresolve(obj?.native?.uuid);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Checks if a given feature is supported.\n\t * @param feature The feature to check.\n\t * @param update Force update.\n\t */\n\tcheckFeatureSupported(feature: string, update?: boolean): Promise<any> {\n\t\treturn this.request({\n\t\t\tcacheKey: `supportedFeatures_${feature}`,\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"checkFeatureSupported\",\n\t\t\t\t\tfeature,\n\t\t\t\t\t(err, features) => {\n\t\t\t\t\t\tif (err) reject(err);\n\t\t\t\t\t\tresolve(features);\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get all adapter instances.\n\t * @param update Force update.\n\t */\n\t/**\n\t * Get all instances of the given adapter.\n\t * @param adapter The name of the adapter.\n\t * @param update Force update.\n\t */\n\tgetAdapterInstances(\n\t\tadapter?: string | boolean,\n\t\tupdate?: boolean,\n\t): Promise<ioBroker.InstanceObject[]> {\n\t\tif (typeof adapter === \"boolean\") {\n\t\t\tupdate = adapter;\n\t\t\tadapter = \"\";\n\t\t}\n\t\tadapter = adapter || \"\";\n\n\t\treturn this.request({\n\t\t\tcacheKey: `instances_${adapter}`,\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: async (resolve) => {\n\t\t\t\tconst startKey = adapter\n\t\t\t\t\t? `system.adapter.${adapter}.`\n\t\t\t\t\t: \"system.adapter.\";\n\t\t\t\tconst endKey = `${startKey}\\u9999`;\n\n\t\t\t\tconst instances = await this.getObjectViewSystem(\n\t\t\t\t\t\"instance\",\n\t\t\t\t\tstartKey,\n\t\t\t\t\tendKey,\n\t\t\t\t);\n\t\t\t\tconst instanceObjects = Object.values(instances);\n\t\t\t\tif (adapter) {\n\t\t\t\t\tresolve(\n\t\t\t\t\t\tinstanceObjects.filter(\n\t\t\t\t\t\t\t(o) => o.common.name === adapter,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(instanceObjects);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get adapters with the given name.\n\t * @param adapter The name of the adapter.\n\t * @param update Force update.\n\t */\n\tgetAdapters(\n\t\tadapter?: string,\n\t\tupdate?: boolean,\n\t): Promise<ioBroker.AdapterObject[]> {\n\t\tif (typeof adapter === \"boolean\") {\n\t\t\tupdate = adapter;\n\t\t\tadapter = \"\";\n\t\t}\n\t\tadapter = adapter || \"\";\n\n\t\treturn this.request({\n\t\t\tcacheKey: `adapter_${adapter}`,\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: async (resolve) => {\n\t\t\t\tconst adapters = await this.getObjectViewSystem(\n\t\t\t\t\t\"adapter\",\n\t\t\t\t\t`system.adapter.${adapter || \"\"}`,\n\t\t\t\t\t`system.adapter.${adapter || \"\\u9999\"}`,\n\t\t\t\t);\n\t\t\t\tconst adapterObjects = Object.values(adapters);\n\t\t\t\tif (adapter) {\n\t\t\t\t\tresolve(\n\t\t\t\t\t\tadapterObjects.filter((o) => o.common.name === adapter),\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(adapterObjects);\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Get the list of all groups.\n\t * @param update Force update.\n\t */\n\tgetGroups(update?: boolean): Promise<ioBroker.GroupObject[]> {\n\t\treturn this.request({\n\t\t\tcacheKey: \"groups\",\n\t\t\tforceUpdate: update,\n\t\t\t// TODO: check if this should time out\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\n\t\t\t\t\t\"getObjectView\",\n\t\t\t\t\t\"system\",\n\t\t\t\t\t\"group\",\n\t\t\t\t\t{\n\t\t\t\t\t\tstartkey: \"system.group.\",\n\t\t\t\t\t\tendkey: \"system.group.\\u9999\",\n\t\t\t\t\t},\n\t\t\t\t\t(err, doc) => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\treject(err);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresolve(\n\t\t\t\t\t\t\t\tgetObjectViewResultToArray<ioBroker.GroupObject>(\n\t\t\t\t\t\t\t\t\tdoc,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Logout current user\n\t * @returns {Promise<null>}\n\t */\n\tlogout(): Promise<string | null> {\n\t\treturn this.request({\n\t\t\tcommandTimeout: false,\n\t\t\texecutor: (resolve, reject) => {\n\t\t\t\tthis._socket.emit(\"logout\", (err) => {\n\t\t\t\t\terr ? reject(err) : resolve(null);\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Send log to ioBroker log\n\t * @param {string} [text] Log text\n\t * @param {string} [level] `info`, `debug`, `warn`, `error` or `silly`\n\t * @returns {Promise<null>}\n\t */\n\tlog(text: string, level?: string): Promise<null> {\n\t\treturn text\n\t\t\t? this.request({\n\t\t\t\t\tcommandTimeout: false,\n\t\t\t\t\texecutor: (resolve) => {\n\t\t\t\t\t\tthis._socket.emit(\"log\", text, level);\n\t\t\t\t\t\treturn resolve(null);\n\t\t\t\t\t},\n\t\t\t  })\n\t\t\t: Promise.resolve(null);\n\t}\n\n\t/**\n\t * This is special method for vis.\n\t * It is used to not send to server the changes about \"nothing_selected\" state\n\t * @param id The state that has to be ignored by communication\n\t */\n\tsetStateToIgnore(id: string): void {\n\t\tthis.ignoreState = id;\n\t}\n}\n","export {};\n//# sourceMappingURL=ConnectionProps.js.map","export interface DeferredPromise<T> extends Promise<T> {\n\tresolve(value: T | PromiseLike<T>): void;\n\treject(reason?: any): void;\n}\n\nexport function createDeferredPromise<T = void>(): DeferredPromise<T> {\n\tlet res: (value: T | PromiseLike<T>) => void;\n\tlet rej: (reason?: any) => void;\n\n\tconst promise = new Promise<T>((resolve, reject) => {\n\t\tres = resolve;\n\t\trej = reject;\n\t}) as DeferredPromise<T>;\n\n\tpromise.resolve = res!;\n\tpromise.reject = rej!;\n\n\treturn promise;\n}\n","export * from \"./AdminConnection.js\";\nexport * from \"./Connection.js\";\nexport * from \"./ConnectionProps.js\";\nexport type { EmitEventHandler, ListenEventHandler } from \"./SocketClient.js\";\n","export function getObjectViewResultToArray<T extends ioBroker.Object>(\n\tdoc:\n\t\t| {\n\t\t\t\trows: ioBroker.GetObjectViewItem<T>[];\n\t\t  }\n\t\t| undefined,\n): T[] {\n\treturn (\n\t\tdoc?.rows.map((item) => item.value).filter((val): val is T => !!val) ??\n\t\t[]\n\t);\n}\n\n/** Makes sure that a host id starts with \"system.host.\" */\nexport function normalizeHostId(host: string): string {\n\tif (!host.startsWith(\"system.host.\")) {\n\t\thost = `system.host.${host}`;\n\t}\n\treturn host;\n}\n\nexport function objectIdToHostname(id: string): string {\n\tif (id.startsWith(\"system.host.\")) {\n\t\tid = id.substr(\"system.host.\".length);\n\t}\n\treturn id;\n}\n\n/**\n * Creates a promise that waits for the specified time and then resolves\n */\nexport function wait(ms: number): Promise<void> {\n\treturn new Promise<void>((resolve) => {\n\t\tsetTimeout(resolve, ms);\n\t});\n}\n\n/** Converts ioB pattern into regex */\nexport function pattern2RegEx(pattern: string): string {\n\tpattern = (pattern || \"\").toString();\n\n\tconst startsWithWildcard = pattern[0] === \"*\";\n\tconst endsWithWildcard = pattern[pattern.length - 1] === \"*\";\n\n\tpattern = pattern\n\t\t.replace(/[-/\\\\^$+?.()|[\\]{}]/g, \"\\\\$&\")\n\t\t.replace(/\\*/g, \".*\");\n\n\treturn (\n\t\t(startsWithWildcard ? \"\" : \"^\") +\n\t\tpattern +\n\t\t(endsWithWildcard ? \"\" : \"$\")\n\t);\n}\n"],"sourceRoot":""}