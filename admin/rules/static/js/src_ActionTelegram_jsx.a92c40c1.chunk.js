"use strict";(self.webpackChunkiobroker_telegram_rules=self.webpackChunkiobroker_telegram_rules||[]).push([["src_ActionTelegram_jsx"],{58166:(u,l,n)=>{n.r(l),n.d(l,{default:()=>o});class i{}const d=i;var c=n(75606);const s=window.GenericBlock||d;class r extends s{constructor(e){super(e,r.getStaticData()),this.cachePromises={}}static compile(e,t){let a=(e.text||"").replace(/"/g,'\\"');return a?`// Telegram ${a||""}
		const subActionVar${e._id} = "${(a||"").replace(/"/g,'\\"')}"${s.getReplacesInText(t)};
		_sendToFrontEnd(${e._id}, {text: subActionVar${e._id}});
		sendTo("${e.instance}", "send", ${e.user&&e.user!=="_"?`{user: "${(e.user||"").replace(/"/g,'\\"')}", text: subActionVar${e._id}}`:`subActionVar${e._id}`});`:`// no text defined
_sendToFrontEnd(${e._id}, {text: 'No text defined'});`}renderDebug(e){return`${c.I18n.t("Sent:")} ${e.data.text}`}onValueChanged(e,t){t==="instance"&&this._setUsers(e)}_setUsers(e){if(e=e||this.state.settings.instance||"telegram.0",this.cachePromises[e]=this.cachePromises[e]||this.props.socket.getState(`${e}.communicate.users`),!this.state.settings._id)return this.setState({inputs:[{nameRender:"renderSelect",adapter:"telegram",frontText:"Instance:",defaultValue:"telegram.0",attr:"instance"},{nameRender:"renderSelect",attr:"user",options:[{title:"telegram.0",value:"telegram.0"}],defaultValue:"",frontText:"User:"},{nameRender:"renderModalInput",attr:"text",defaultValue:"Hallo",nameBlock:"",frontText:"Text:"}]},()=>super.onTagChange());this.cachePromises[e].then(t=>{try{t=t!=null&&t.val?JSON.parse(t.val):null,t=t&&Object.keys(t).map(a=>({title:t[a].userName||t[a].firstName,value:a})),t=t||[],t.unshift({title:"all",value:""})}catch(a){t=[{title:"all",value:""}]}this.setState({inputs:[{nameRender:"renderInstance",adapter:"telegram",frontText:"Instance:",defaultValue:"telegram.0",attr:"instance"},{nameRender:"renderSelect",attr:"user",options:t,defaultValue:"_",frontText:"User:"},{nameRender:"renderModalInput",attr:"text",defaultValue:"Hallo",nameBlock:"",frontText:"Text:"}]},()=>super.onTagChange())})}onTagChange(e){this._setUsers()}static getStaticData(){return{acceptedBy:"actions",name:"Telegram",id:"ActionTelegram",adapter:"telegram",title:"Sends message via telegram",helpDialog:"You can use %s in the text to display current trigger value or %id to display the triggered object ID"}}getData(){return r.getStaticData()}}const o=r}}]);

//# sourceMappingURL=src_ActionTelegram_jsx.a92c40c1.chunk.js.map